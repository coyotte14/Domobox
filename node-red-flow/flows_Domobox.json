[{"id":"8bfe8608.a30018","type":"tab","label":"Backup-Flow","disabled":false,"info":""},{"id":"1b2a31e6.3fb326","type":"tab","label":"Géolocalisation"},{"id":"4acfe546.fec69c","type":"tab","label":"Météo"},{"id":"fa457347.ecb0c","type":"tab","label":"Meteo2"},{"id":"1e9c47f3.1e412","type":"tab","label":"Tests"},{"id":"7d43a2e7.8d0b94","type":"tab","label":"Garage"},{"id":"f85d9fd7.e9798","type":"tab","label":"Salon"},{"id":"2f03aa46.79fcbe","type":"tab","label":"Véranda"},{"id":"d55b1279.073868","type":"tab","label":"Status_Sonde","disabled":false},{"id":"a79eecc2.d7d75","type":"tab","label":"DNS updater Chuck","disabled":false,"info":""},{"id":"be787133.503b4","type":"tab","label":"Musique"},{"id":"3b02cdcb.5a6722","type":"tab","label":"RFX433-T°-TH13 + DHT","disabled":false,"info":""},{"id":"b3a949db.c3ae18","type":"tab","label":"VMC"},{"id":"13503b77.86f9b5","type":"tab","label":"npm"},{"id":"8fda587a.42f658","type":"tab","label":"Volets"},{"id":"af7c18b0.5a85a","type":"tab","label":"Volets UI"},{"id":"1e31eceb.bd3853","type":"tab","label":"Status-Domobox","disabled":false,"info":""},{"id":"8b0b1bf7.7d00b","type":"ui_tab","z":"4acfe546.fec69c","name":"Météo","icon":"dashboard","order":3},{"id":"6ac57513.7413ac","type":"ui_tab","z":"f85d9fd7.e9798","name":"Salon","icon":"dashboard","order":2},{"id":"bab2d4e6.61f6d","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"Helvetica Neue","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"Helvetica Neue"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","dateFormat":"DD/MM/YYYY","sizes":{"sx":52,"sy":52,"gx":6,"gy":6,"cx":8,"cy":8,"px":0,"py":0}}},{"id":"d578210b.b94fe","type":"ui_group","z":"2f03aa46.79fcbe","name":"Veranda","tab":"c08132a0.979a28","disp":true,"width":"6"},{"id":"97b5768b.b778f","type":"ui_group","z":"7d43a2e7.8d0b94","name":"Porte de garage","tab":"e04ba4b5.79ecc","disp":true,"width":"4"},{"id":"4abcf619.428558","type":"ui_group","z":"4acfe546.fec69c","name":"Météo","tab":"8b0b1bf7.7d00b","disp":true,"width":"6"},{"id":"fa4c31cc.42d5d8","type":"ui_group","z":"f85d9fd7.e9798","name":"Salon","tab":"6ac57513.7413ac","order":1,"disp":true,"width":"6"},{"id":"c08132a0.979a28","type":"ui_tab","z":"","name":"Véranda","icon":"dashboard","order":7},{"id":"e04ba4b5.79ecc","type":"ui_tab","z":"","name":"Sous sol","icon":"dashboard","order":6},{"id":"11537580.66b92b","type":"ui_tab","z":"1e9c47f3.1e412","name":"Musique","icon":"dashboard","order":8},{"id":"b5d37b01.3e6e18","type":"ui_group","z":"","name":"Billard","tab":"11537580.66b92b","order":2,"disp":true,"width":"6"},{"id":"640b930b.e32f44","type":"squeezebox-server","z":"be787133.503b4","host":"http://192.168.1.55","port":"9000","name":"Logitech Media Server"},{"id":"2e262064.d5d03","type":"ui_group","z":"","name":"Véranda","tab":"11537580.66b92b","order":1,"disp":true,"width":"6"},{"id":"41ebe73c.f40b28","type":"forecastio-credentials","z":"4acfe546.fec69c","key_identifier":"coyotte14"},{"id":"5872d74c.6da318","type":"ui_tab","z":"","name":"Home","icon":"dashboard","order":1},{"id":"b7857374.8e887","type":"ui_group","z":"","name":"Home","tab":"5872d74c.6da318","order":null,"disp":true,"width":"5"},{"id":"25338ec8.545a42","type":"rfxtrx-port","z":"3b02cdcb.5a6722","port":"/dev/ttyUSB0"},{"id":"5bd306b9.0318b8","type":"ui_tab","z":"","name":"VMC","icon":"dashboard","order":9},{"id":"ddb91611.590b08","type":"ui_group","z":"","name":"VMC","tab":"5bd306b9.0318b8","disp":true,"width":"6"},{"id":"de407325.9d7fa","type":"ui_tab","z":"","name":"Volets","icon":"dashboard","order":10},{"id":"f9259a3c.bfe4c8","type":"ui_group","z":"","name":"Volets cuisine","tab":"de407325.9d7fa","order":2,"disp":true,"width":"6"},{"id":"8610111b.4a2c18","type":"ui_group","z":"","name":"Volets Véranda","tab":"de407325.9d7fa","order":4,"disp":true,"width":"6"},{"id":"6f9109ca.fe882","type":"ui_group","z":"","name":"Volets chambre parents","tab":"de407325.9d7fa","order":6,"disp":true,"width":"6"},{"id":"784a0014.4f7bc","type":"ui_group","z":"","name":"Volets salle de bain","tab":"de407325.9d7fa","order":9,"disp":true,"width":"6"},{"id":"ed7c6733.090e","type":"ui_group","z":"","name":"Volets chambre Sarah","tab":"de407325.9d7fa","order":7,"disp":true,"width":"6"},{"id":"8a0cb6e5.d3a96","type":"ui_group","z":"","name":"Volets chambre Anaïs","tab":"de407325.9d7fa","order":8,"disp":true,"width":"6"},{"id":"f7b9bc37.821d08","type":"ui_group","z":"","name":"Commande générale","tab":"de407325.9d7fa","order":1,"disp":true,"width":"6"},{"id":"e65ab964.6849a8","type":"ui_tab","z":"","name":"Météo de la semaine","icon":"dashboard","order":4},{"id":"d2b19f67.825c","type":"ui_group","z":"","name":"Météo de la semaine","tab":"e65ab964.6849a8","disp":true,"width":"6"},{"id":"912de5b9.a94dc8","type":"mqtt-broker","z":"","broker":"domobox","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"willTopic":"","willQos":"0","willPayload":"","birthTopic":"","birthQos":"2","birthRetain":"true","birthPayload":""},{"id":"e9c1858b.1bc4c","type":"google-api-config","z":""},{"id":"58dfcdf2.321c14","type":"rfxtrx-port","port":"/dev/ttyUSB0"},{"id":"fe9def47.191638","type":"ui_group","z":"","name":"Volets salon","tab":"de407325.9d7fa","order":3,"disp":true,"width":"6"},{"id":"d674d62a.75d3a8","type":"ui_group","z":"","name":"Volets bureau","tab":"de407325.9d7fa","order":5,"disp":true,"width":"6"},{"id":"ab14b9c2.70719","type":"pushbullet-config","z":"","name":"PushBullet"},{"id":"ba2e12e5.38583","type":"mqtt in","z":"1b2a31e6.3fb326","name":"","topic":"owntracks/HP/HP/#","qos":"2","broker":"912de5b9.a94dc8","x":125.5,"y":87.5,"wires":[["18a4c764.ee8729","25fa3c98.e471c4"]]},{"id":"3d883d97.86157a","type":"geofence","z":"1b2a31e6.3fb326","name":"Geofence Home","mode":"circle","inside":"both","rad":27.038727652962418,"points":[],"centre":{"latitude":49.211517336554856,"longitude":-0.40698766708374023},"x":123,"y":662,"wires":[["6ec44a18.b6d64c","a415e96d.73f45"]]},{"id":"18a4c764.ee8729","type":"function","z":"1b2a31e6.3fb326","name":"Lat-Long","func":"var loc=JSON.parse(msg.payload);\n\nif ( loc._type == \"location\" ) {\n    msg.location = {\n      lon: 0,\n      lat: 50\n    };\n\n    msg.location.lon=loc.lon;\n    msg.location.lat=loc.lat;\n    \n    return msg;\n}","outputs":1,"noerr":0,"x":110,"y":561,"wires":[["3d883d97.86157a","e2c4ec34.8ef9b8","c18f6e12.9e4d6","98e4a6ea.da546","2e0c730e.164304","7c92a8c.c03ded8"]]},{"id":"e2c4ec34.8ef9b8","type":"google geocoding","z":"1b2a31e6.3fb326","name":"","geocodeBy":"coordinates","address":"","lat":"","lon":"","googleAPI":"e9c1858b.1bc4c","bounds":"","language":"","region":"","components":"","x":550,"y":220,"wires":[["1547f591.91b9f2"]]},{"id":"1547f591.91b9f2","type":"debug","z":"1b2a31e6.3fb326","name":"","active":false,"console":"false","complete":"false","x":771,"y":220,"wires":[]},{"id":"6ec44a18.b6d64c","type":"debug","z":"1b2a31e6.3fb326","name":"","active":false,"console":"false","complete":"false","x":321,"y":618,"wires":[]},{"id":"93c2e96a.257a6","type":"ui_text","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","order":5,"width":"","height":"","name":"Humidité","label":"Humidité","format":"{{msg.payload}}","layout":"","x":553.5,"y":650.2999877929688,"wires":[]},{"id":"2fc3ddf2.a62d82","type":"mqtt in","z":"2f03aa46.79fcbe","name":"Humidité RFX","topic":"/T-Veranda/RFX/Humidity","qos":"2","broker":"912de5b9.a94dc8","x":135.5,"y":663.02001953125,"wires":[["93c2e96a.257a6","cc29c5f9.9bd9","970aeb40.3a54a","c12c4ce3.f90148"]]},{"id":"e61a34c5.47a178","type":"mqtt in","z":"2f03aa46.79fcbe","name":"Temperature RFX","topic":"/T-Veranda/RFX/Temperature","qos":"2","broker":"912de5b9.a94dc8","x":140,"y":164,"wires":[["acdd353d.c759d","6095bb56.a6e3a4","bb0f6360.99c21","6025198c.ab25e","c9b260f9.d27128","c0cc16b7.6d8e7"]]},{"id":"acdd353d.c759d","type":"ui_text","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","order":2,"width":"","height":"","name":"Température","label":"Température","format":"{{msg.payload}}","layout":"","x":558,"y":167.99998474121094,"wires":[]},{"id":"6095bb56.a6e3a4","type":"function","z":"2f03aa46.79fcbe","name":"Date","func":"MaDate = new Date();\ndayString = MaDate.toString();\ntimeString = dayString.substring( 16 , 21 );\nmsg.payload = timeString;\n\n//msg.h = timeString;\n\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":342,"y":105,"wires":[["10a43c5e.11489c"]]},{"id":"10a43c5e.11489c","type":"ui_text","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","order":1,"width":"","height":"","name":"Mise à jour","label":"Mise à jour","format":"{{msg.payload}}","layout":"","x":565,"y":88.99998474121094,"wires":[]},{"id":"bb0f6360.99c21","type":"ui_chart","z":"2f03aa46.79fcbe","name":"Chart-Température","group":"d578210b.b94fe","order":14,"width":"","height":"","label":"Température","chartType":"line","legend":"true","xformat":"HH","interpolate":"linear","nodata":"Température","ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":"","x":578.5,"y":229.29998779296875,"wires":[[],[]]},{"id":"faa261e3.d813e","type":"ui_text","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","order":3,"width":"","height":"","name":"T° Max","label":"Température max","format":"{{msg.payload}}","layout":"","x":548,"y":317,"wires":[]},{"id":"aecb8f95.0111b","type":"ui_text","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","order":4,"width":"","height":"","name":"T° Min","label":"Température min","format":"{{msg.payload}}","layout":"","x":535,"y":385,"wires":[]},{"id":"837e1dab.4f816","type":"openweathermap in","z":"4acfe546.fec69c","name":"","lon":"","lat":"","city":"Saint-Contest","country":"FR","x":125.5,"y":202.33999633789062,"wires":[["ea7a9bf.bca73e8","77037df8.859ec4","235f5064.8e3a3","781fd6b3.83be98","cabf46dd.37c14","c6fabf67.276768","d29eebab.973418","c51a1006.a421d8","75de72d2.2046f4","273d3b2c.81c474","dbc8149b.ec5fa","73d7bffa.40b508","608dab41.39118c","df2aeaa3.5a3ef8"]]},{"id":"ea7a9bf.bca73e8","type":"debug","z":"4acfe546.fec69c","name":"","active":false,"console":"false","complete":"false","x":402.5,"y":96.03999328613281,"wires":[]},{"id":"77037df8.859ec4","type":"function","z":"4acfe546.fec69c","name":"T-ext","func":"msg.payload = msg.payload.tempc;\n    node.status({text:msg.payload});\n//return {payload:msg.payload.tempc};\nreturn msg;","outputs":1,"noerr":0,"x":377.5,"y":212.05999755859375,"wires":[["865e7c66.a7b128"]]},{"id":"865e7c66.a7b128","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":2,"width":"","height":"","name":"Température extérieure","label":"Température extérieure","format":"{{msg.payload}}","layout":"","x":607.5,"y":211.29998779296875,"wires":[]},{"id":"235f5064.8e3a3","type":"function","z":"4acfe546.fec69c","name":"T-max","func":"kelvin=msg.payload.maxtemp;\ntemperature = parseFloat(kelvin) - 273,15;\ntemperature=temperature.toPrecision(3)\nmsg.payload=temperature;\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":378,"y":265,"wires":[["b1c92dd7.c7b3a8"]]},{"id":"b1c92dd7.c7b3a8","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":4,"width":"","height":"","name":"Température max","label":"Température max","format":"{{msg.payload}}","layout":"","x":583,"y":265.239990234375,"wires":[]},{"id":"781fd6b3.83be98","type":"function","z":"4acfe546.fec69c","name":"T-min","func":"\nkelvin=msg.payload.mintemp;\n\n// ° F = 9/5(° K - 273) + 32\n// ° C = 9/5(° K - 273)\n//temperature = (parseFloat(kelvin) - 273,15);\n//temperature = 9*(parseFloat(kelvin) - 273)/5;\n//temperature = 9*parseFloat(kelvin - 273)/5;\ntemperature = parseFloat(kelvin - 273);\n//temperature = parseInt(kelvin);\ntemperature=temperature.toPrecision(3);\nmsg.payload=temperature;\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":322,"wires":[["ebe4dfe0.d49928"]]},{"id":"ebe4dfe0.d49928","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":3,"width":"","height":"","name":"Température min","label":"Température min","format":"{{msg.payload}}","layout":"","x":579,"y":321.239990234375,"wires":[]},{"id":"3d788532.dd4d1a","type":"comment","z":"7d43a2e7.8d0b94","name":"Porte garage 2","info":"","x":101,"y":468,"wires":[]},{"id":"6025198c.ab25e","type":"smooth","z":"2f03aa46.79fcbe","name":"","action":"min","count":"800","round":false,"x":338.5,"y":341.45001220703125,"wires":[["aecb8f95.0111b"]]},{"id":"c9b260f9.d27128","type":"smooth","z":"2f03aa46.79fcbe","name":"","action":"max","count":"800","round":false,"x":343.5,"y":275.4499816894531,"wires":[["faa261e3.d813e","2e949bf.fe92464"]]},{"id":"10fa5f1e.6770f1","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":1,"width":"","height":"","name":"Mise à jour","label":"Mise à jour","format":"{{msg.payload}}","layout":"","x":570,"y":158,"wires":[]},{"id":"cabf46dd.37c14","type":"function","z":"4acfe546.fec69c","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":379,"y":157.00001525878906,"wires":[["10fa5f1e.6770f1","fbf572c0.a58b88"]]},{"id":"c6fabf67.276768","type":"function","z":"4acfe546.fec69c","name":"Force-Vent","func":"vent = msg.payload.windspeed;\nforcevent = (parseFloat(vent) * 3.6);\nforcevent=forcevent.toPrecision(2);\nmsg.payload = forcevent + \"km/h\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":392,"y":390,"wires":[["6fe87ca4.f1d3cc"]]},{"id":"6fe87ca4.f1d3cc","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":5,"width":"","height":"","name":"Force du vent","label":"Force du vent","format":"{{msg.payload}}","layout":"","x":569,"y":389.239990234375,"wires":[]},{"id":"d29eebab.973418","type":"function","z":"4acfe546.fec69c","name":"Lever-soleil","func":"var sec = msg.payload.sunrise;\nvar date = new Date(sec * 1000);\nMaDate = date.toLocaleTimeString();\ndateString = MaDate.toString();\ntimeString = MaDate.substring( 0 , 5 );\nmsg.payload = timeString\n    node.status({text:msg.payload});\n\nreturn msg;\n","outputs":1,"noerr":0,"x":388,"y":454,"wires":[[]]},{"id":"a62ba96c.5ead38","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":6,"width":"","height":"","name":"Lever du soleil","label":"Lever du soleil","format":"{{msg.payload}}","layout":"","x":566,"y":454.239990234375,"wires":[]},{"id":"ed3b635c.5ed6d8","type":"ui_text","z":"f85d9fd7.e9798","group":"fa4c31cc.42d5d8","order":6,"width":"","height":"","name":"Humidité","label":"Humidité","format":"{{msg.payload}}","layout":"row-spread","x":540,"y":602.2598876953125,"wires":[]},{"id":"6cd922a9.89edfc","type":"mqtt in","z":"f85d9fd7.e9798","name":"Humidité RFX","topic":"/T-Salon/RFX/Humidity","qos":"2","broker":"912de5b9.a94dc8","x":115,"y":605.9799194335938,"wires":[["ed3b635c.5ed6d8","b99293a5.a90098","47cf1a2a.6e70ac"]]},{"id":"adee7122.8a5ab","type":"mqtt in","z":"f85d9fd7.e9798","name":"Temperature RFX","topic":"/T-Salon/RFX/Temperature","qos":"2","broker":"912de5b9.a94dc8","x":124.5,"y":163.95999145507812,"wires":[["e954ffcf.5d6e7","ddc56a39.4f24b","f34338f7.6fee58","6382d2fe.f84f5c","48779a9b.bcf524","a6324b96.5eaef"]]},{"id":"e954ffcf.5d6e7","type":"ui_text","z":"f85d9fd7.e9798","group":"fa4c31cc.42d5d8","order":2,"width":"","height":"","name":"Température","label":"Température","format":"{{msg.payload}}","layout":"row-spread","x":542.5,"y":167.95997619628906,"wires":[]},{"id":"d0905f2e.9589b8","type":"debug","z":"f85d9fd7.e9798","name":"","active":false,"console":"false","complete":"false","x":543,"y":42,"wires":[]},{"id":"ddc56a39.4f24b","type":"function","z":"f85d9fd7.e9798","name":"Date","func":"MaDate = new Date();\ndayString = MaDate.toString();\ntimeString = dayString.substring( 16 , 21 );\nmsg.payload = timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":326.5,"y":104.95999145507812,"wires":[["b45e7ddf.e7d7c","d0905f2e.9589b8"]]},{"id":"b45e7ddf.e7d7c","type":"ui_text","z":"f85d9fd7.e9798","group":"fa4c31cc.42d5d8","order":1,"width":"","height":"","name":"Mise à jour","label":"Mise à jour","format":"{{msg.payload}}","layout":"row-spread","x":543.5,"y":104.95997619628906,"wires":[]},{"id":"b99293a5.a90098","type":"ui_chart","z":"f85d9fd7.e9798","name":"Chart-Humidité","group":"fa4c31cc.42d5d8","order":8,"width":"","height":"","label":"","interpolate":"linear","nodata":"No Data","ymin":"","ymax":"","removeOlder":1,"removeOlderUnit":"86400","x":557.5,"y":653.9598999023438,"wires":[[],[]]},{"id":"f34338f7.6fee58","type":"ui_chart","z":"f85d9fd7.e9798","name":"Chart-Température","group":"fa4c31cc.42d5d8","order":7,"width":"","height":"","label":"","interpolate":"linear","nodata":"No Data","ymin":"","ymax":"","removeOlder":1,"removeOlderUnit":"86400","x":563,"y":229.25997924804688,"wires":[[],[]]},{"id":"4918cbd2.73cfb4","type":"ui_text","z":"f85d9fd7.e9798","group":"fa4c31cc.42d5d8","order":3,"width":"","height":"","name":"T° Max","label":"Température max","format":"{{msg.payload}}","layout":"row-spread","x":533.5,"y":275.9599914550781,"wires":[]},{"id":"d27a4d8f.a35f5","type":"ui_text","z":"f85d9fd7.e9798","group":"fa4c31cc.42d5d8","order":4,"width":"","height":"","name":"T° Min","label":"Température min","format":"{{msg.payload}}","layout":"row-spread","x":525.5,"y":348.9599609375,"wires":[]},{"id":"6382d2fe.f84f5c","type":"smooth","z":"f85d9fd7.e9798","name":"","action":"min","count":"800","round":false,"x":331,"y":349.4100341796875,"wires":[["d27a4d8f.a35f5"]]},{"id":"48779a9b.bcf524","type":"smooth","z":"f85d9fd7.e9798","name":"","action":"max","count":"800","round":false,"x":328,"y":275.40997314453125,"wires":[["4918cbd2.73cfb4"]]},{"id":"6998edf8.9cba5c","type":"mqtt in","z":"f85d9fd7.e9798","name":"Fenetre","topic":"/DHT-Salon/Door_1/Door/#","qos":"2","broker":"912de5b9.a94dc8","x":107.5,"y":819.1499328613281,"wires":[["f61065a5.938c7","b0ba803a.25da1"]]},{"id":"f61065a5.938c7","type":"function","z":"f85d9fd7.e9798","name":"Ouvert-Fermé","func":"if (msg.payload == 1) {\n    msg.payload=\"ouverte\";\n    } \nelse {\n    msg.payload=\"fermée\";\n    }\nreturn msg;","outputs":1,"noerr":0,"x":332.5,"y":821.4499206542969,"wires":[["8aa95d4c.c05ab","14d1bf95.8d6a"]]},{"id":"8aa95d4c.c05ab","type":"ui_text","z":"f85d9fd7.e9798","group":"fa4c31cc.42d5d8","order":5,"width":"","height":"","name":"Fenêtre","label":"Fenêtre","format":"{{msg.payload}}","layout":"row-spread","x":548.5,"y":822.2499694824219,"wires":[]},{"id":"b0ba803a.25da1","type":"debug","z":"f85d9fd7.e9798","name":"","active":true,"console":"false","complete":"false","x":336.5,"y":934.2999572753906,"wires":[]},{"id":"9ffc9a65.2ca828","type":"ui_toast","z":"f85d9fd7.e9798","name":"","x":718.5,"y":875.2499694824219,"wires":[]},{"id":"14d1bf95.8d6a","type":"function","z":"f85d9fd7.e9798","name":"MSG ouvert/fermé","func":"msg.payload = \"Fenètre salon \" + msg.payload;\nreturn msg;","outputs":1,"noerr":0,"x":502.5,"y":876.4499816894531,"wires":[["9ffc9a65.2ca828"]]},{"id":"254d8118.f7ba46","type":"comment","z":"d55b1279.073868","name":"Status sonde sur topic /+/status","info":"","x":136.5,"y":154,"wires":[]},{"id":"59cbd118.d37878","type":"mqtt in","z":"d55b1279.073868","name":"Status /+/status","topic":"/+/status","qos":"0","broker":"912de5b9.a94dc8","x":93,"y":206,"wires":[["ba625e5c.308598","44ba46cb.4c8d6"]]},{"id":"ba625e5c.308598","type":"debug","z":"d55b1279.073868","name":"","active":true,"console":"false","complete":"false","x":283,"y":206,"wires":[]},{"id":"e7de1eee.a6ee3","type":"adv ping","z":"d55b1279.073868","name":"ping sonde","host":"","x":483.5,"y":314,"wires":[["5a997b5e.bae574","62f7a8f7.52bdf8"]]},{"id":"5a997b5e.bae574","type":"debug","z":"d55b1279.073868","name":"","active":true,"console":"false","complete":"payload","x":476,"y":394,"wires":[]},{"id":"ed92033f.e0117","type":"function","z":"d55b1279.073868","name":"hostname sonde","func":"var dataStr = msg.payload;\n\n//if individual node selected - the destination id should be last part of topic\n\n//split msg by /\nvar tokens = msg.topic.split(\"/\");\n\ncontext.sysname = tokens[1];\nmsg.host = context.sysname;\n    node.status({text:msg.host});\n    \nreturn msg;","outputs":1,"noerr":0,"x":300.5,"y":315,"wires":[["e7de1eee.a6ee3"]]},{"id":"62f7a8f7.52bdf8","type":"switch","z":"d55b1279.073868","name":"","property":"payload","propertyType":"msg","rules":[{"t":"false"},{"t":"else"}],"checkall":"true","outputs":2,"x":652,"y":313,"wires":[["e8d6dc6b.e500b8"],["40360836.0916a8"]]},{"id":"156e3153.18fd07","type":"comment","z":"d55b1279.073868","name":"ping KO","info":"","x":653,"y":269,"wires":[]},{"id":"36a7b934.ac710e","type":"comment","z":"d55b1279.073868","name":"Anti-Spam","info":"","x":906,"y":152,"wires":[]},{"id":"e8d6dc6b.e500b8","type":"delay","z":"d55b1279.073868","name":"","pauseType":"rate","timeout":"1","timeoutUnits":"hours","rate":"5","nbRateUnits":"","rateUnits":"hour","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":828,"y":274,"wires":[["4854dc17.3f1dd4"]]},{"id":"4854dc17.3f1dd4","type":"delay","z":"d55b1279.073868","name":"","pauseType":"rate","timeout":"4","timeoutUnits":"seconds","rate":"10","rateUnits":"day","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1003,"y":274,"wires":[["9ab9c2f7.65f57"]]},{"id":"9ab9c2f7.65f57","type":"template","z":"d55b1279.073868","name":"Ping message","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Serveur {{topic}} indisponible ! ","x":1193,"y":274,"wires":[["d097e1d3.5d9c2","5d2b52b5.94314c"]]},{"id":"fc80fa1c.b5c658","type":"comment","z":"d55b1279.073868","name":"Construction du message","info":"","x":1212,"y":151,"wires":[]},{"id":"d7d659ba.3b3e5","type":"comment","z":"d55b1279.073868","name":"Transmission","info":"","x":1419,"y":150,"wires":[]},{"id":"d097e1d3.5d9c2","type":"e-mail","z":"d55b1279.073868","server":"smtp.gmail.com","port":"465","secure":true,"name":"coyotte14@gmail.com","dname":"Email Alert","x":1418,"y":275,"wires":[]},{"id":"df49ed89.2e1ab8","type":"comment","z":"d55b1279.073868","name":"Hostname Sonde","info":"","x":286,"y":268,"wires":[]},{"id":"f787f3ee.94277","type":"comment","z":"d55b1279.073868","name":"ping Hostname Sonde","info":"","x":497,"y":154,"wires":[]},{"id":"5e7b8cf4.f3be3c","type":"comment","z":"d55b1279.073868","name":"ping OK","info":"","x":656,"y":368,"wires":[]},{"id":"40360836.0916a8","type":"delay","z":"d55b1279.073868","name":"","pauseType":"rate","timeout":"1","timeoutUnits":"hours","rate":"5","rateUnits":"hour","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":820,"y":361,"wires":[["66460d2d.f27ad4"]]},{"id":"66460d2d.f27ad4","type":"delay","z":"d55b1279.073868","name":"","pauseType":"rate","timeout":"4","timeoutUnits":"seconds","rate":"10","rateUnits":"day","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1001,"y":361,"wires":[["4c1e8953.1e9ef"]]},{"id":"4c1e8953.1e9ef","type":"template","z":"d55b1279.073868","name":"Ping message","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Serveur {{topic}} connexion MQTT indisponible ! ","x":1193,"y":361,"wires":[["d097e1d3.5d9c2","5d2b52b5.94314c"]]},{"id":"5d2b52b5.94314c","type":"debug","z":"d55b1279.073868","name":"","active":true,"console":"false","complete":"false","x":1419,"y":349,"wires":[]},{"id":"bc646bca.ab5de8","type":"comment","z":"d55b1279.073868","name":"Test MQTT indisponible :  Last Will testament : message \"Connection Lost\" sur topic /+/status quand connexion MQTT perdue","info":"mosquitto_pub -t /T-Veranda/status -m \"7\"\nmosquitto_pub -t /T-Salon/status -m \"hs\"\nmosquitto_pub -t /P-Garage1/status -m \"ok\"","x":425,"y":26,"wires":[]},{"id":"fbf572c0.a58b88","type":"debug","z":"4acfe546.fec69c","name":"","active":false,"console":"false","complete":"false","x":684.5,"y":72,"wires":[]},{"id":"61d0a1c0.fac33","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":9,"width":"","height":"","name":"Qualité de l'air","label":"Qualité de l'air","format":"{{msg.payload}}","layout":"","x":880,"y":763.239990234375,"wires":[]},{"id":"c51a1006.a421d8","type":"file in","z":"4acfe546.fec69c","name":"sortie.xml","filename":"/var/www/html/qair/qair.txt","format":"utf8","sendError":true,"x":281.5,"y":752,"wires":[["81f34b0e.9d2788","b9c228e4.42343","e06377ca.165398"]]},{"id":"81f34b0e.9d2788","type":"debug","z":"4acfe546.fec69c","name":"","active":false,"console":"false","complete":"filename","x":436,"y":820,"wires":[]},{"id":"b9c228e4.42343","type":"switch","z":"4acfe546.fec69c","name":"Select air quality","property":"payload","rules":[{"t":"btwn","v":0,"v2":4},{"t":"btwn","v":5,"v2":7},{"t":"btwn","v":8,"v2":10}],"checkall":"true","outputs":3,"x":480,"y":751,"wires":[["862da2f1.ddabe8"],["a9b85256.2d854"],["9eaf48dc.c7ab28"]]},{"id":"a9b85256.2d854","type":"function","z":"4acfe546.fec69c","name":"Add warning","func":"msg.payload =  msg.payload + \"(Air pollué)\"\nreturn msg;","outputs":1,"noerr":0,"x":675.77783203125,"y":763.111083984375,"wires":[["61d0a1c0.fac33"]]},{"id":"9eaf48dc.c7ab28","type":"function","z":"4acfe546.fec69c","name":"Add danger","func":"msg.payload = msg.payload + \"(Air très pollué)\"\nreturn msg;","outputs":1,"noerr":0,"x":673,"y":803.111083984375,"wires":[["61d0a1c0.fac33"]]},{"id":"862da2f1.ddabe8","type":"function","z":"4acfe546.fec69c","name":"Add ok","func":"msg.payload = msg.payload + \" (Air correct)\"\nreturn msg;","outputs":1,"noerr":0,"x":670.5555419921875,"y":724.7777099609375,"wires":[["61d0a1c0.fac33"]]},{"id":"75de72d2.2046f4","type":"function","z":"4acfe546.fec69c","name":"Couché-soleil","func":"var sec = msg.payload.sunset;\nvar date = new Date(sec * 1000);\n\nMaDate = date.toLocaleTimeString();\ndateString = MaDate.toString();\ntimeString = MaDate.substring( 0 , 5 );\nmsg.payload = timeString\n    node.status({text:msg.payload});\n\nreturn msg;","outputs":1,"noerr":0,"x":393,"y":560,"wires":[[]]},{"id":"a65824d2.6a8a38","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":7,"width":"","height":"","name":"Coucher du soleil","label":"Coucher du soleil","format":"{{msg.payload}}","layout":"","x":589,"y":569,"wires":[]},{"id":"96d4a959.8a1e28","type":"mqtt in","z":"7d43a2e7.8d0b94","name":"P-Garage2 relay","topic":"/P-Garage2/gpio/12","qos":"0","broker":"912de5b9.a94dc8","x":364.5,"y":609,"wires":[["962cadac.581838","5a19e1d7.10d03"]]},{"id":"962cadac.581838","type":"debug","z":"7d43a2e7.8d0b94","name":"","active":true,"console":"false","complete":"false","x":596.5,"y":603,"wires":[]},{"id":"64567f8c.635a","type":"ui_button","z":"7d43a2e7.8d0b94","name":"Porte garage","group":"97b5768b.b778f","order":1,"width":"4","height":"1","label":"Fermer / Ouvrir","color":"","bgcolor":"","icon":"","payload":"1","payloadType":"str","topic":"/P-garage2/gpio/12","x":340,"y":899,"wires":[["c57fe080.145fe"]]},{"id":"c57fe080.145fe","type":"mqtt out","z":"7d43a2e7.8d0b94","name":"","topic":"/P-Garage2/gpio/12","qos":"0","retain":"","broker":"912de5b9.a94dc8","x":596.5,"y":900,"wires":[]},{"id":"28a28c46.255c2c","type":"mqtt in","z":"7d43a2e7.8d0b94","name":"Door contact","topic":"/P-Garage2/Door_1/Door","qos":"2","broker":"912de5b9.a94dc8","x":354,"y":682,"wires":[["962cadac.581838","a47ece2d.7fcab8"]]},{"id":"a47ece2d.7fcab8","type":"function","z":"7d43a2e7.8d0b94","name":"Ouvert-Fermé","func":"if (msg.payload == 1) {\n    msg.payload=\"ouvert\";\n    } \nelse {\n    msg.payload=\"fermé\";\n    }\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":550.5,"y":684.06005859375,"wires":[["9d485647.2267a8"]]},{"id":"9d485647.2267a8","type":"ui_text","z":"7d43a2e7.8d0b94","group":"97b5768b.b778f","order":3,"width":"4","height":"1","name":"","label":"Grande porte","format":"{{msg.payload}}","layout":"","x":752,"y":684,"wires":[]},{"id":"eeea6afa.bdb47","type":"comment","z":"7d43a2e7.8d0b94","name":"gpio12 : relay","info":"","x":83,"y":605,"wires":[]},{"id":"33a16523.36d602","type":"comment","z":"7d43a2e7.8d0b94","name":"gpio1 : Grande porte switch","info":"","x":131,"y":684,"wires":[]},{"id":"c794b82a.ea66e","type":"squeezebox-out","z":"be787133.503b4","squeezebox_server":"640b930b.e32f44","player_name":"Veranda","command":"","x":486,"y":96,"wires":[["6f0f309c.8431"]]},{"id":"6f0f309c.8431","type":"debug","z":"be787133.503b4","name":"","active":false,"console":"false","complete":"false","x":656,"y":98,"wires":[]},{"id":"cfd90fa3.9ad9b8","type":"ui_switch","z":"be787133.503b4","name":"","label":"Play-Pause","group":"2e262064.d5d03","order":0,"width":0,"height":0,"topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":135,"y":95,"wires":[["abadedcf.080248"]]},{"id":"b1d83262.b8175","type":"ui_slider","z":"be787133.503b4","name":"","label":"Volume","group":"2e262064.d5d03","order":0,"width":0,"height":0,"topic":"","min":0,"max":10,"x":126,"y":152,"wires":[["2fa60114.8e72e6"]]},{"id":"abadedcf.080248","type":"function","z":"be787133.503b4","name":"Play/Pause","func":"if (msg.payload === true) {\n    msg.payload=\"play\";\n    } \nelse {\n    msg.payload=\"stop\";\n    }\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":318,"y":96,"wires":[["c794b82a.ea66e"]]},{"id":"2fa60114.8e72e6","type":"function","z":"be787133.503b4","name":"Volume","func":"volume = msg.payload *10\nmsg.payload = [\"mixer\",\"volume\",volume]\n\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":305,"y":152,"wires":[["c794b82a.ea66e"]]},{"id":"5d23609a.dd0d38","type":"function","z":"be787133.503b4","name":"Status","func":"msg.payload = [\"status\"]\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":300,"y":215,"wires":[["c794b82a.ea66e"]]},{"id":"a397290f.de36f","type":"comment","z":"be787133.503b4","name":"Squeezbox Véranda","info":"","x":95,"y":41,"wires":[]},{"id":"92c07926.eea3c8","type":"squeezebox-out","z":"be787133.503b4","squeezebox_server":"640b930b.e32f44","player_name":"Billard","command":"","x":476,"y":348,"wires":[["57125af2.52f394"]]},{"id":"57125af2.52f394","type":"debug","z":"be787133.503b4","name":"","active":false,"console":"false","complete":"false","x":656,"y":350,"wires":[]},{"id":"3083170e.c824f","type":"ui_switch","z":"be787133.503b4","name":"","label":"Play-Pause","group":"b5d37b01.3e6e18","order":0,"width":0,"height":0,"topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":135,"y":347,"wires":[["cb2bf0ca.a90c"]]},{"id":"80510e19.834c88","type":"ui_slider","z":"be787133.503b4","name":"","label":"Volume","group":"b5d37b01.3e6e18","order":0,"width":0,"height":0,"topic":"","min":0,"max":10,"x":126,"y":404,"wires":[["1a1f8242.0edade"]]},{"id":"cb2bf0ca.a90c","type":"function","z":"be787133.503b4","name":"Play/Pause","func":"if (msg.payload === true) {\n    msg.payload=\"play\";\n    } \nelse {\n    msg.payload=\"stop\";\n    }\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":318,"y":348,"wires":[["92c07926.eea3c8"]]},{"id":"1a1f8242.0edade","type":"function","z":"be787133.503b4","name":"Volume","func":"volume = msg.payload *10\nmsg.payload = [\"mixer\",\"volume\",volume]\n\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":305,"y":404,"wires":[["92c07926.eea3c8"]]},{"id":"d77a8fd5.ab0268","type":"comment","z":"be787133.503b4","name":"Squeezbox Billard","info":"","x":95,"y":293,"wires":[]},{"id":"61bc213b.9926c8","type":"mqtt out","z":"7d43a2e7.8d0b94","name":"","topic":"/P-Garage2/gpio/13","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":740,"y":966,"wires":[]},{"id":"5fa37811.7fc7f","type":"ui_switch","z":"7d43a2e7.8d0b94","name":"","label":"Led de test","group":"97b5768b.b778f","order":4,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":342,"y":966,"wires":[["232535c0.9651ea"]]},{"id":"232535c0.9651ea","type":"function","z":"7d43a2e7.8d0b94","name":"On/Off","func":"if (msg.payload === true) {\n    msg.payload=\"0\";\n    } \nelse {\n    msg.payload=\"1\";\n    }\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":542,"y":966,"wires":[["61bc213b.9926c8"]]},{"id":"cc29c5f9.9bd9","type":"debug","z":"2f03aa46.79fcbe","name":"","active":false,"console":"false","complete":"false","x":299,"y":748,"wires":[]},{"id":"479817c6.298648","type":"http request","z":"1e9c47f3.1e412","name":"","method":"POST","ret":"obj","url":"http://192.168.1.31:9200/my_sonde/sonde/_search","tls":"","x":485,"y":159,"wires":[["fbb08987.61112"]]},{"id":"702e583c.32a1a","type":"http in","z":"1e9c47f3.1e412","name":"","url":"/el/sensedata","method":"get","swaggerDoc":"","x":148,"y":109.5,"wires":[["43c5e753.1dcb28","8e3527ad.662f28"]]},{"id":"43c5e753.1dcb28","type":"function","z":"1e9c47f3.1e412","name":"Read Criteria","func":"var fromdate = msg.req && msg.req.query.fromdate;\nvar todate = msg.req && msg.req.query.todate;\nfromdate = fromdate || 'now-1d/d';\ntodate = todate || 'now/d';\n\nmsg.payload = {\n    \"query\": {\n        \"range\" : {\n            \"timestamp\" : {\n                \"gte\" : fromdate,\n                \"lte\" :  todate,\n                \"format\": \"yyyy-MM-dd\",\n                \"time_zone\": \"+09:00\"\n            }\n        }\n    },\n    \"size\": 1000,\n    \"sort\": [\n        {\"timestamp\" : {\"order\" : \"asc\"}}\n    ]\n};\nreturn msg;","outputs":1,"noerr":0,"x":348,"y":106,"wires":[["479817c6.298648"]]},{"id":"f20b4294.cb3c","type":"debug","z":"1e9c47f3.1e412","name":"","active":true,"console":"false","complete":"false","x":780,"y":177.5,"wires":[]},{"id":"f953348f.8f111","type":"inject","z":"1e9c47f3.1e412","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":173,"y":152,"wires":[["43c5e753.1dcb28"]]},{"id":"ac151b74.738538","type":"json","z":"1e9c47f3.1e412","name":"","x":753,"y":112.5,"wires":[["1a24958a.dc983a"]]},{"id":"fbb08987.61112","type":"function","z":"1e9c47f3.1e412","name":"","func":"var drgx = /^([0-9]{4})-([0-9]{2})-([0-9]{2})[\\s|T]([0-9]{2}):([0-9]{2}):([0-9]{2}).[0-9]*(Z?)/;\nvar eresult = msg.payload.hits.hits;\nvar result = [];\nfor(var i=0; i<eresult.length; i++){\n    result.push(eresult[i]._source)\n    var args = drgx.exec(result[i].timestamp);\n    if(args[7] === 'Z') {\n        //result[i].timestamp = Date.UTC(args[1], args[2] - 1, args[3], args[4], args[5], args[6]);\n    } else {\n        //result[i].timestamp = new Date(args[1], args[2] - 1, args[3], args[4], args[5], args[6]).getTime();\n    }\n}\nmsg.payload = result;\nreturn msg;","outputs":1,"noerr":0,"x":619,"y":114,"wires":[["f20b4294.cb3c","ac151b74.738538"]]},{"id":"8e3527ad.662f28","type":"debug","z":"1e9c47f3.1e412","name":"","active":true,"console":"false","complete":"req.query","x":342,"y":199.5,"wires":[]},{"id":"d30f9932.207cf","type":"comment","z":"1e9c47f3.1e412","name":"Search with ElasticSearch","info":"","x":164,"y":70,"wires":[]},{"id":"1a24958a.dc983a","type":"switch","z":"1e9c47f3.1e412","name":"","property":"res","rules":[{"t":"nnull"}],"checkall":"false","outputs":1,"x":871,"y":114.5,"wires":[["9edb04b6.bda6f"]]},{"id":"9edb04b6.bda6f","type":"http response","z":"1e9c47f3.1e412","name":"","x":993,"y":114.5,"wires":[]},{"id":"7ff1e010.2b5ec","type":"http request","z":"1e9c47f3.1e412","name":"Save Data","method":"POST","ret":"obj","url":"http://192.168.1.31:9200/my_sonde/sonde/{{{msg.id}}}","tls":"","x":773,"y":434,"wires":[["9758bb35.988bb"]]},{"id":"88e0eff3.22dbd","type":"tail","z":"1e9c47f3.1e412","name":"Monitor CSV","filetype":"text","split":true,"filename":"/home/poirier/senselog.csv","x":133,"y":435,"wires":[["6b10516e.8d2828"]]},{"id":"f066e92a.53fbb","type":"comment","z":"1e9c47f3.1e412","name":"Add Sense Data to ElasticSearch","info":"","x":190,"y":396,"wires":[]},{"id":"6b10516e.8d2828","type":"csv","z":"1e9c47f3.1e412","name":"Sense Data Log","sep":",","hdrin":false,"hdrout":false,"multi":"one","ret":"\\n","temp":"source, humidity, temperature, date","x":319,"y":434.5,"wires":[["9225dd07.424be","cea93b9a.c9ec28"]]},{"id":"cea93b9a.c9ec28","type":"json","z":"1e9c47f3.1e412","name":"","x":584,"y":437.5,"wires":[["7ff1e010.2b5ec","9b0ecdf5.ddf5f8"]]},{"id":"9225dd07.424be","type":"debug","z":"1e9c47f3.1e412","name":"","active":true,"console":"false","complete":"false","x":421,"y":576.5,"wires":[]},{"id":"9758bb35.988bb","type":"debug","z":"1e9c47f3.1e412","name":"","active":true,"console":"false","complete":"false","x":805,"y":538.5,"wires":[]},{"id":"9b0ecdf5.ddf5f8","type":"debug","z":"1e9c47f3.1e412","name":"","active":true,"console":"false","complete":"false","x":701,"y":593,"wires":[]},{"id":"aa20933a.b8c678","type":"function","z":"1e9c47f3.1e412","name":"","func":"id = \"{root : [\" + msg.payload; + \"]\"\nmsg.payload=id\nmsg.id = msg.payload.timestamp;\n\nreturn msg;","outputs":1,"noerr":0,"x":494,"y":341,"wires":[["cea93b9a.c9ec28","14d1cad5.98e98d"]]},{"id":"14d1cad5.98e98d","type":"debug","z":"1e9c47f3.1e412","name":"","active":true,"console":"false","complete":"false","x":666,"y":349,"wires":[]},{"id":"c803a781.ed8ec8","type":"http request","z":"2f03aa46.79fcbe","name":"Save Data","method":"POST","ret":"obj","url":"http://graylog:9200/my_sonde/sonde/{{{msg.payload}}}","tls":"","x":904,"y":492,"wires":[["dc101019.2bb36"]]},{"id":"dc101019.2bb36","type":"debug","z":"2f03aa46.79fcbe","name":"","active":true,"console":"false","complete":"false","x":1071,"y":491.5,"wires":[]},{"id":"526f14de.1295dc","type":"function","z":"2f03aa46.79fcbe","name":"Index ES write","func":"d=new Date();\nmadate=d.toJSON()\nmyTemp = context.global.myTemperature;\nmsg.payload = \"{\\\"date\\\":\\\"\" + madate + \"\\\", \\\"source\\\":\\\"T-Veranda\\\", \\\"My-Temperature\\\":\" + myTemp +  \",\\\"My-Humidity\\\":\" + msg.payload + \"}\";\n\nreturn msg;","outputs":1,"noerr":0,"x":577,"y":492,"wires":[["8200d12f.4269e8","61f62dbe.1dadd4"]]},{"id":"8200d12f.4269e8","type":"debug","z":"2f03aa46.79fcbe","name":"","active":true,"console":"false","complete":"false","x":769,"y":539,"wires":[]},{"id":"c0cc16b7.6d8e7","type":"function","z":"2f03aa46.79fcbe","name":"Global var temperature","func":"context.global.myTemperature=msg.payload;\nmsg.payload = context.global.myTemperature;\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":747,"y":129,"wires":[[]]},{"id":"a6a545be.0b2898","type":"comment","z":"2f03aa46.79fcbe","name":"Véranda : température UI","info":"","x":115,"y":30,"wires":[]},{"id":"4276c366.edebec","type":"comment","z":"2f03aa46.79fcbe","name":"Véranda : humidité UI","info":"","x":115,"y":590,"wires":[]},{"id":"3d67c71f.d55468","type":"comment","z":"2f03aa46.79fcbe","name":"Véranda : ES write","info":"","x":131,"y":448,"wires":[]},{"id":"d16f7730.a1f518","type":"http request","z":"f85d9fd7.e9798","name":"Save Data","method":"POST","ret":"obj","url":"http://graylog:9200/my_sonde/sonde/{{{msg.payload}}}","tls":"","x":834,"y":452,"wires":[["64bc1a44.f4ceec"]]},{"id":"64bc1a44.f4ceec","type":"debug","z":"f85d9fd7.e9798","name":"","active":true,"console":"false","complete":"false","x":1007,"y":450.5,"wires":[]},{"id":"3b2ecad1.92b3e6","type":"function","z":"f85d9fd7.e9798","name":"Index ES write","func":"d=new Date();\nmadate=d.toJSON()\nmyTemp = context.global.myTemperaturesSalon;\nmsg.payload = \"{\\\"date\\\":\\\"\" + madate + \"\\\", \\\"source\\\":\\\"T-Salon\\\", \\\"My-Temperature\\\":\" + myTemp +  \",\\\"My-Humidity\\\":\" + msg.payload + \"}\";\n\nreturn msg;","outputs":1,"noerr":0,"x":507,"y":452,"wires":[["39984beb.da981c","8f98d99f.13bb78"]]},{"id":"39984beb.da981c","type":"debug","z":"f85d9fd7.e9798","name":"","active":true,"console":"false","complete":"false","x":699,"y":499,"wires":[]},{"id":"a6324b96.5eaef","type":"function","z":"f85d9fd7.e9798","name":"Global var temperature","func":"context.global.myTemperaturesSalon=msg.payload;\nmsg.payload = context.global.myTemperaturesSalon;\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":743,"y":135,"wires":[[]]},{"id":"482c0fb1.2bf97","type":"comment","z":"f85d9fd7.e9798","name":"Salon: humidité UI","info":"","x":95,"y":565.9999694824219,"wires":[]},{"id":"55f28d3c.d05c6c","type":"comment","z":"f85d9fd7.e9798","name":"Salon : ES write","info":"","x":88,"y":454,"wires":[]},{"id":"76557034.c5eda","type":"comment","z":"f85d9fd7.e9798","name":"Salon: température UI","info":"","x":108,"y":24,"wires":[]},{"id":"8cb0a49e.2eb7e","type":"comment","z":"f85d9fd7.e9798","name":"Salon: fenêtre UI","info":"","x":87,"y":785,"wires":[]},{"id":"ef63b7b7.bae9e","type":"function","z":"4acfe546.fec69c","name":"context.global.TempExt","func":"context.global.TempExt = msg.payload.tempc;\nmsg.payload = context.global.TempExt;\nreturn msg;","outputs":1,"noerr":0,"x":671.0000610351562,"y":1438,"wires":[["fea8185b.3e9518"]]},{"id":"31c669e5.c02c26","type":"function","z":"4acfe546.fec69c","name":"context.global.humid","func":"context.global.humid = parseFloat(msg.payload.humidity);\nmsg.payload = context.global.humid;\nreturn msg;","outputs":1,"noerr":0,"x":637.7778549194336,"y":1471.7778706550598,"wires":[["dbe96ede.cbd07"]]},{"id":"fea8185b.3e9518","type":"debug","z":"4acfe546.fec69c","name":"temp","active":true,"console":"false","complete":"payload","x":863.5556869506836,"y":1438.2222065925598,"wires":[]},{"id":"dbe96ede.cbd07","type":"debug","z":"4acfe546.fec69c","name":"humid","active":true,"console":"false","complete":"payload","x":858.8889770507812,"y":1471.22216796875,"wires":[]},{"id":"6ee1e1a.de2cfa","type":"inject","z":"4acfe546.fec69c","name":"","topic":"","payload":"","payloadType":"date","repeat":"600","crontab":"","once":false,"x":146.11116790771484,"y":1341.0000386238098,"wires":[["ba014019.0d056"]]},{"id":"ba014019.0d056","type":"wunderground","z":"4acfe546.fec69c","name":"","lon":"-0.400256","lat":"49.213999","city":"","country":"","x":402.2223129272461,"y":1338.6667256355286,"wires":[["ef63b7b7.bae9e","31c669e5.c02c26","221406fc.fe2e0a"]]},{"id":"221406fc.fe2e0a","type":"debug","z":"4acfe546.fec69c","name":"","active":true,"console":"false","complete":"false","x":654,"y":1334,"wires":[]},{"id":"f2a8d592.fd87","type":"comment","z":"4acfe546.fec69c","name":"Rain Forecaster","info":"","x":114,"y":1498,"wires":[]},{"id":"4aedaef4.cad398","type":"forecastio in","z":"4acfe546.fec69c","forecastio":"41ebe73c.f40b28","name":"","key":"","lon":"-0.400256","lat":"49.213999","date":"","time":"","units":"auto","x":115,"y":1599,"wires":[["9046c2a8.d5f72","adab22f0.09708","ecb4f870.bfb74"]]},{"id":"9046c2a8.d5f72","type":"debug","z":"4acfe546.fec69c","name":"","active":true,"complete":"false","x":248,"y":1662,"wires":[]},{"id":"adab22f0.09708","type":"function","z":"4acfe546.fec69c","name":"Temp Max demain","func":"maxt=msg.payload.maxtemp;\ntemperature=maxt.toPrecision(2)\nmsg.payload=temperature;\n    node.status({text:msg.payload});\n\nreturn msg;","outputs":1,"noerr":0,"x":608,"y":1602,"wires":[["3205a9b5.5a04b6","1072129b.4ac875"]]},{"id":"3205a9b5.5a04b6","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":13,"width":"","height":"","name":"Temp max demain","label":"Température max demain","format":"{{msg.payload}}","layout":"","x":827,"y":1603,"wires":[]},{"id":"ecb4f870.bfb74","type":"function","z":"4acfe546.fec69c","name":"Temp Min demain","func":"mint=msg.payload.mintemp;\ntemperature=mint.toPrecision(2)\nmsg.payload=temperature;\n    node.status({text:msg.payload});\n\nreturn msg;","outputs":1,"noerr":0,"x":607,"y":1654,"wires":[["c26e1b80.39c7"]]},{"id":"c26e1b80.39c7","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":12,"width":"","height":"","name":"Temp min demain","label":"Température min demain","format":"{{msg.payload}}","layout":"","x":821,"y":1653,"wires":[]},{"id":"1072129b.4ac875","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":11,"width":0,"height":0,"name":"","label":"_________ Prévisions météo _________","format":"","layout":"row-spread","x":900,"y":1549,"wires":[]},{"id":"8bd62b82.bfab3","type":"debug","z":"4acfe546.fec69c","name":"","active":true,"complete":"false","x":697,"y":1141,"wires":[]},{"id":"273d3b2c.81c474","type":"http request","z":"4acfe546.fec69c","name":"HTTP vigilance","method":"GET","ret":"txt","url":"http://domobox:81/vigilance/14/all","tls":"","x":215,"y":1085,"wires":[["fe6a9e3.62844e"]]},{"id":"5e9f901c.0396e8","type":"function","z":"4acfe546.fec69c","name":"Vigilance","func":"msg.payload = msg.payload.vigilancerisk;\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":546,"y":1087,"wires":[["8bd62b82.bfab3","685dcd97.d5e1e4"]]},{"id":"685dcd97.d5e1e4","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":10,"width":"","height":"","name":"Vigilance météo","label":"Vigilance météo","format":"{{msg.payload}}","layout":"","x":856,"y":1088,"wires":[]},{"id":"fe6a9e3.62844e","type":"json","z":"4acfe546.fec69c","name":"","x":387,"y":1086,"wires":[["5e9f901c.0396e8"]]},{"id":"dbc8149b.ec5fa","type":"http request","z":"4acfe546.fec69c","name":"HTTP sunset","method":"GET","ret":"txt","url":"http://domobox:81/sun/saint-contest/sunset/now","tls":"","x":377,"y":610,"wires":[["a65824d2.6a8a38"]]},{"id":"df2aeaa3.5a3ef8","type":"http request","z":"4acfe546.fec69c","name":"HTTP sunrise","method":"GET","ret":"txt","url":"http://domobox:81/sun/saint-contest/sunrise/now","tls":"","x":394,"y":508,"wires":[["a62ba96c.5ead38"]]},{"id":"73d7bffa.40b508","type":"http request","z":"4acfe546.fec69c","name":"HTTP dayduration","method":"GET","ret":"txt","url":"http://domobox:81/sun/saint-contest/dayduration/now","tls":"","x":398,"y":659,"wires":[["d5d9bdb8.35c148"]]},{"id":"d5d9bdb8.35c148","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":8,"width":"","height":"","name":"Duréee de la journée","label":"Duréee de la journée","format":"{{msg.payload}}","layout":"","x":605,"y":659,"wires":[]},{"id":"608dab41.39118c","type":"http request","z":"4acfe546.fec69c","name":"HTTP précipitation","method":"GET","ret":"txt","url":"http://www.meteofrance.com/mf3-rpc-portlet/rest/pluie/145660","tls":"","x":216,"y":1190,"wires":[["3f6654b7.cf6ed4","79de6852.4708a"]]},{"id":"a509e293.d7e61","type":"debug","z":"4acfe546.fec69c","name":"","active":true,"console":"false","complete":"false","x":773,"y":1246,"wires":[]},{"id":"2376c915.6d748e","type":"ui_text","z":"4acfe546.fec69c","group":"4abcf619.428558","order":14,"width":"","height":"","name":"Pluie dans l'heure","label":"Pluie dans l'heure","format":"{{msg.payload}}","layout":"","x":860,"y":1194,"wires":[]},{"id":"290df648.fb81f2","type":"function","z":"4acfe546.fec69c","name":"Précipitation","func":"//msg.payload = msg.payload.niveauPluieText;\npluie = msg.payload.niveauPluieText;\n\n//pluie = JSON.stringify(pluie).replace( /\\[/g , '');\npluie = JSON.stringify(pluie).replace( /Pas de précipitations/g , 'Sec');\n//pluie = JSON.stringify(pluie).replace( '^[' , '');\n//pluie = JSON.stringify(pluie).replace( /]$/ , '');\n//pluie = JSON.stringify(pluie).replace( /De/g , '');\nmsg.payload = pluie;\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":598,"y":1191,"wires":[["a509e293.d7e61","2376c915.6d748e"]]},{"id":"79de6852.4708a","type":"json","z":"4acfe546.fec69c","name":"","x":412,"y":1189,"wires":[["290df648.fb81f2"]]},{"id":"3f6654b7.cf6ed4","type":"debug","z":"4acfe546.fec69c","name":"","active":true,"console":"false","complete":"false","x":358,"y":1248,"wires":[]},{"id":"2c0ad8b5.697b5","type":"rfx-sensor","z":"3b02cdcb.5a6722","name":"Véranda TH13/0xEA02","port":"25338ec8.545a42","topicSource":"single","topic":"TH13/0xEA02","x":121,"y":288,"wires":[["cbb89aa3.db5048","a5afcc5f.2a3b8","e566c42.db934b8","16533b13.2f186d","5bab549d.3668ac"]]},{"id":"aafa34e2.60d678","type":"rfx-sensor","z":"3b02cdcb.5a6722","name":"Salon TH13/0xDA03","port":"25338ec8.545a42","topicSource":"single","topic":"TH13/0xDA03","x":113,"y":724,"wires":[["e38d30a9.4ddc9","ea9ef32b.08a98","1d6dc48f.c05663","a245ad35.f95f9","747f8381.147224"]]},{"id":"3d8ebb06.455214","type":"rfx-sensor","z":"3b02cdcb.5a6722","name":"Extérieur TH13/0x1E01","port":"25338ec8.545a42","topicSource":"single","topic":"TH13/0x0E01","x":117,"y":1223,"wires":[["43c99708.a758d","22dd9e74.895362","92ccb7a0.acf4d8","c3a8fb20.9a94","117936b0.9f9839"]]},{"id":"43c99708.a758d","type":"function","z":"3b02cdcb.5a6722","name":"T° Ext","func":"msg.payload = msg.payload.temperature.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":303,"y":1147,"wires":[["8ccf1981.d43a6","5196a54c.c1c23c","376afdc1.ee7b12"]]},{"id":"8ccf1981.d43a6","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":1,"width":"0","height":"0","name":"Température extérieure","label":"Température extérieure","format":"{{msg.payload}}°C","layout":"","x":569,"y":1146,"wires":[]},{"id":"cbb89aa3.db5048","type":"function","z":"3b02cdcb.5a6722","name":"T° véranda","func":"msg.payload = msg.payload.temperature.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":328,"y":225,"wires":[["ff05e81b.993e88","84c2d8a1.5c9a08"]]},{"id":"ff05e81b.993e88","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":4,"width":"0","height":"0","name":"Température véranda","label":"Température véranda","format":"{{msg.payload}}°C","layout":"","x":560,"y":257,"wires":[]},{"id":"e38d30a9.4ddc9","type":"function","z":"3b02cdcb.5a6722","name":"T° salon","func":"msg.payload = msg.payload.temperature.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":312,"y":673,"wires":[["e1febb4.ac3ecc8","11590cc.2bdc7f3"]]},{"id":"e1febb4.ac3ecc8","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":7,"width":"0","height":"0","name":"Température salon","label":"Température salon","format":"{{msg.payload}}°C","layout":"","x":550,"y":695,"wires":[]},{"id":"b6783ec7.3bb7b8","type":"debug","z":"1e9c47f3.1e412","name":"","active":true,"console":"false","complete":"false","x":469,"y":700,"wires":[]},{"id":"5b44bcf4.20830c","type":"inject","z":"1e9c47f3.1e412","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":103,"y":699,"wires":[["89abaa80.cb59c"]]},{"id":"89abaa80.cb59c","type":"http request","z":"1e9c47f3.1e412","name":"Request temp ","method":"GET","ret":"obj","url":"http://192.168.1.31:9200/my_sonde/sonde/_search -d '{     \"size\": 0,     \"aggs\": {         \"Temperatures\": {             \"stats\": {                 \"field\": \"My-Temperature\"             }         }     } }'","tls":"","x":289,"y":699,"wires":[["b6783ec7.3bb7b8"]]},{"id":"a3654213.2d68","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"false","x":329,"y":73,"wires":[]},{"id":"db83ef84.64716","type":"comment","z":"3b02cdcb.5a6722","name":"------------------ Debug all TH13 TH9 ------------------ ","info":"Pour trouver l'identifiant des sondes de température","x":206,"y":33,"wires":[]},{"id":"3f7ec91e.c4f0de","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":2,"width":"0","height":"0","name":"Humidité extérieure","label":"Humidité extérieure","format":"{{msg.payload}} %","layout":"","x":548,"y":1309,"wires":[]},{"id":"22dd9e74.895362","type":"function","z":"3b02cdcb.5a6722","name":"H° Ext","func":"msg.payload = msg.payload.humidity.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":293,"y":1302,"wires":[["3f7ec91e.c4f0de","554b19b0.91924","d6b675a9.f4f7d8","2b8ddabf.d8c83e"]]},{"id":"554b19b0.91924","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":3,"width":"0","height":"0","name":"--","label":"","format":"","layout":"","x":508,"y":1345,"wires":[]},{"id":"ea9ef32b.08a98","type":"function","z":"3b02cdcb.5a6722","name":"H° salon","func":"msg.payload = msg.payload.humidity.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":314,"y":791,"wires":[["bf331846.6eb95","db68172b.4fee","589e0ff1.7748f8"]]},{"id":"bf331846.6eb95","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":8,"width":"0","height":"0","name":"Humidité salon","label":"Humidité salon","format":"{{msg.payload}} %","layout":"","x":540,"y":795,"wires":[]},{"id":"3f479c73.32520c","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":5,"width":"0","height":"0","name":"Humidité véranda","label":"Humidité véranda","format":"{{msg.payload}} %","layout":"","x":545,"y":365,"wires":[]},{"id":"db68172b.4fee","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":9,"width":"0","height":"0","name":"--","label":"","format":"","layout":"","x":512,"y":837,"wires":[]},{"id":"eb2aefdc.93e088","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":6,"width":"0","height":"0","name":"--","label":"","format":"","layout":"","x":508,"y":407,"wires":[]},{"id":"a5afcc5f.2a3b8","type":"function","z":"3b02cdcb.5a6722","name":"H° véranda","func":"msg.payload = msg.payload.humidity.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":328,"y":362,"wires":[["3f479c73.32520c","eb2aefdc.93e088","699e21d0.3faa38"]]},{"id":"cbcbee9a.14337","type":"comment","z":"3b02cdcb.5a6722","name":"Extérieur : ES write","info":"Ecriture 1 message toutes les 10mn\nLes sondes envoient 1 message toutes les 30s","x":123,"y":1553,"wires":[]},{"id":"573f1754.ce78b8","type":"function","z":"3b02cdcb.5a6722","name":"T° Ext ES write","func":"d=new Date();\nmadate=d.toJSON()\nmyTemp = context.global.myTemperatureExt;\nmsg.payload = \"{\\\"date\\\":\\\"\" + madate + \"\\\", \\\"source\\\":\\\"T-Extérieur\\\", \\\"My-Temperature\\\":\" + myTemp +  \",\\\"My-Humidity\\\":\" + msg.payload + \"}\";\n\nreturn msg;","outputs":1,"noerr":0,"x":349,"y":1591,"wires":[["809f45ee.9234","7e919362.d0359c"]]},{"id":"7e919362.d0359c","type":"json","z":"3b02cdcb.5a6722","name":"","x":518,"y":1591,"wires":[["51ceb5aa.3faedc"]]},{"id":"809f45ee.9234","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"false","x":541,"y":1638,"wires":[]},{"id":"51ceb5aa.3faedc","type":"http request","z":"3b02cdcb.5a6722","name":"Save Data","method":"POST","ret":"obj","url":"http://graylog:9200/my_sonde/sonde/{{{msg.payload}}}","tls":"","x":676,"y":1591,"wires":[["d6dcef5f.03e3b8"]]},{"id":"d6dcef5f.03e3b8","type":"debug","z":"3b02cdcb.5a6722","name":"","active":true,"console":"false","complete":"false","x":844,"y":1590.5,"wires":[]},{"id":"5196a54c.c1c23c","type":"delay","z":"3b02cdcb.5a6722","name":"","pauseType":"rate","timeout":"1","timeoutUnits":"hours","rate":"1","nbRateUnits":"10","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":539,"y":1187,"wires":[["a6401bf1.0deb5","ed448a85.8faee8"]]},{"id":"a6401bf1.0deb5","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"false","x":830,"y":1228,"wires":[]},{"id":"ed448a85.8faee8","type":"function","z":"3b02cdcb.5a6722","name":"Global var temperatureExt","func":"context.global.myTemperatureExt=msg.payload;\nmsg.payload = context.global.myTemperatureExt;\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":881,"y":1184,"wires":[[]]},{"id":"bdf6f0ac.03f06","type":"mqtt in","z":"b3a949db.c3ae18","name":"Humidité veranda","topic":"/T-Veranda/DHT/Humidity/#","qos":"2","broker":"912de5b9.a94dc8","x":112,"y":207,"wires":[["938a4f66.9f38","6d9c89c9.1396f8","9c5f885c.d69cd8","51c8d8de.5324a8","943f90d4.39cdb"]]},{"id":"eec78af6.b30f48","type":"switch","z":"b3a949db.c3ae18","name":"Select air quality","property":"Qair","propertyType":"global","rules":[{"t":"btwn","v":"0","vt":"num","v2":"4","v2t":"num"},{"t":"btwn","v":"5","vt":"num","v2":"7","v2t":"num"},{"t":"btwn","v":"8","vt":"num","v2":"10","v2t":"num"}],"checkall":"true","outputs":3,"x":1172.5,"y":303,"wires":[["9582f915.4f014"],["ce7fe990.35263","b19684de.5d3118"],["ce7fe990.35263","40dd5bc4.bc7b94"]]},{"id":"9f28de0a.d4108","type":"comment","z":"b3a949db.c3ae18","name":"Air 0-4 : OK runVMC","info":"","x":1203,"y":256,"wires":[]},{"id":"371d3238.a6ed6e","type":"comment","z":"b3a949db.c3ae18","name":"Air 5-10 : Pollué stopVMC","info":"","x":1200,"y":350,"wires":[]},{"id":"938a4f66.9f38","type":"switch","z":"b3a949db.c3ae18","name":"Select humidity","property":"payload","propertyType":"msg","rules":[{"t":"lt","v":"SeuilHumid","vt":"global"},{"t":"gte","v":"SeuilHumid","vt":"global"}],"checkall":"true","outputs":2,"x":321,"y":206,"wires":[["ce7fe990.35263","8d96182.c1f22e8"],["a25ab7bd.0d122","ce86bbc4.0cca9"]]},{"id":"7a66f8dd.14c8f","type":"comment","z":"b3a949db.c3ae18","name":"Humidity < global.SeuilHumid : stopVMC","info":"","x":266,"y":162,"wires":[]},{"id":"114e4820.cd474","type":"comment","z":"b3a949db.c3ae18","name":"Humidity > global.SeuilHumid : runVMC","info":"","x":250,"y":299,"wires":[]},{"id":"7133ca3.731ff34","type":"mqtt out","z":"b3a949db.c3ae18","name":"","topic":"/R-VMC/gpio/12","qos":"0","retain":"","broker":"912de5b9.a94dc8","x":1801,"y":296,"wires":[]},{"id":"6cde0ee.c9b56f","type":"function","z":"b3a949db.c3ae18","name":"stopVMC","func":"msg.payload = \"0\"\nreturn msg;","outputs":1,"noerr":0,"x":1610,"y":201,"wires":[["7133ca3.731ff34","16ca38a6.38c05f"]]},{"id":"cde741d6.441208","type":"function","z":"b3a949db.c3ae18","name":"runVMC","func":"msg.payload = \"1\"\nreturn msg;","outputs":1,"noerr":0,"x":1610,"y":427,"wires":[["7133ca3.731ff34","9859c4c3.13fea"]]},{"id":"315e9636.3cae5a","type":"switch","z":"b3a949db.c3ae18","name":"Select T°Ext","property":"payload","propertyType":"msg","rules":[{"t":"lt","v":"SeuilTemp","vt":"global"},{"t":"gte","v":"SeuilTemp","vt":"global"}],"checkall":"true","outputs":2,"x":702,"y":305,"wires":[["ce7fe990.35263","eb7a87aa.76926","a5db9776.0e8e4"],["8722c627.393098","ca62cd99.af0c38"]]},{"id":"7c683359.36cfd4","type":"comment","z":"b3a949db.c3ae18","name":"T°Ext <global.SeuilTemp : stopVMC","info":"","x":730,"y":233,"wires":[]},{"id":"3ff10981.bfa3be","type":"comment","z":"b3a949db.c3ae18","name":"T°Ext >global.SeuilTemp : runVMC","info":"","x":716,"y":371,"wires":[]},{"id":"16ca38a6.38c05f","type":"debug","z":"b3a949db.c3ae18","name":"","active":true,"console":"false","complete":"false","x":1795,"y":203,"wires":[]},{"id":"9859c4c3.13fea","type":"debug","z":"b3a949db.c3ae18","name":"","active":true,"console":"false","complete":"false","x":1789,"y":426,"wires":[]},{"id":"ce7fe990.35263","type":"delay","z":"b3a949db.c3ae18","name":"1 message/H","pauseType":"rate","timeout":"1","timeoutUnits":"hours","rate":"1","nbRateUnits":"","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1427,"y":200,"wires":[["6cde0ee.c9b56f","7a5a5158.03c6a8"]]},{"id":"9582f915.4f014","type":"delay","z":"b3a949db.c3ae18","name":"1 message/H","pauseType":"rate","timeout":"1","timeoutUnits":"hours","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1425,"y":355,"wires":[["cde741d6.441208","c5b36263.c90a08"]]},{"id":"8e9ce5d7.a5c4d","type":"comment","z":"b3a949db.c3ae18","name":"1 action max par heure","info":"","x":1421,"y":276,"wires":[]},{"id":"4a3f0002.6403f8","type":"ui_text","z":"b3a949db.c3ae18","group":"ddb91611.590b08","order":2,"width":0,"height":0,"name":"Etat VMC","label":"Etat VMC","format":"{{msg.payload}}","layout":"row-spread","x":1872,"y":508,"wires":[]},{"id":"c5b36263.c90a08","type":"function","z":"b3a949db.c3ae18","name":"Etat VMC active","func":"var msg1 =  { payload:\" active\"};\n//var msg2 = { payload:\"Humidité > 60%\"};\nvar msg2 = { payload:\"Humidité = \" + Math.trunc(context.global.Humidity) + \"% > seuil \" + Math.trunc(context.global.SeuilHumid)+ \"%\"};\nreturn [ msg1, msg2 ];","outputs":"2","noerr":0,"x":1636,"y":534,"wires":[["4a3f0002.6403f8"],["859f94df.ee3a1"]]},{"id":"7a5a5158.03c6a8","type":"function","z":"b3a949db.c3ae18","name":"Etat VMC non active","func":"var msg1 =  { payload:\"non active\"};\n//var msg2 = { payload:\"Humidité = \" + Math.trunc(context.global.Humidity) + \"%\"};\nvar msg2 = { payload:\"Humidité = \" + Math.trunc(context.global.Humidity) + \"% < seuil \" + Math.trunc(context.global.SeuilHumid)+ \"%\"};\n\nreturn [ msg1, msg2 ];","outputs":"2","noerr":0,"x":1655,"y":491,"wires":[["4a3f0002.6403f8"],["859f94df.ee3a1"]]},{"id":"859f94df.ee3a1","type":"ui_text","z":"b3a949db.c3ae18","group":"ddb91611.590b08","order":3,"width":0,"height":0,"name":"Raison VMC","label":"Raison","format":"{{msg.payload}}","layout":"row-spread","x":1796,"y":653,"wires":[]},{"id":"b19684de.5d3118","type":"function","z":"b3a949db.c3ae18","name":"Raison air pollué","func":"msg.payload = \"air pollué\"\nreturn msg;","outputs":1,"noerr":0,"x":1536,"y":648,"wires":[["859f94df.ee3a1"]]},{"id":"40dd5bc4.bc7b94","type":"function","z":"b3a949db.c3ae18","name":"Raison  air très pollué","func":"msg.payload = \"air très pollué\"\nreturn msg;","outputs":1,"noerr":0,"x":1548,"y":688,"wires":[["859f94df.ee3a1"]]},{"id":"a5db9776.0e8e4","type":"function","z":"b3a949db.c3ae18","name":"Raison T°Ext <global.SeuilTemp","func":"msg.payload = \"T° ext < T° seuil \" + Math.trunc(context.global.SeuilTemp) +\"°\";\nreturn msg;","outputs":1,"noerr":0,"x":1579,"y":728,"wires":[["859f94df.ee3a1"]]},{"id":"435d0806.7fb56","type":"function","z":"b3a949db.c3ae18","name":"context.global.SeuilHumid","func":"context.global.SeuilHumid = msg.payload;\nmsg.payload = context.global.SeuilHumid || 30;\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":451,"y":1002,"wires":[["47dd74.c2d3ea8c"]]},{"id":"58eed084.af1378","type":"debug","z":"b3a949db.c3ae18","name":"","active":true,"console":"false","complete":"false","x":663,"y":938,"wires":[]},{"id":"8d96182.c1f22e8","type":"debug","z":"b3a949db.c3ae18","name":"","active":true,"console":"false","complete":"false","x":551,"y":125,"wires":[]},{"id":"6d9c89c9.1396f8","type":"function","z":"b3a949db.c3ae18","name":"context.global.Humidity","func":"context.global.Humidity = msg.payload;\nmsg.payload = context.global.Humidity;\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":301,"y":254,"wires":[[]]},{"id":"a25ab7bd.0d122","type":"debug","z":"b3a949db.c3ae18","name":"","active":true,"console":"false","complete":"false","x":550,"y":166,"wires":[]},{"id":"5c5135c.1e0b44c","type":"comment","z":"b3a949db.c3ae18","name":"Sélection seuil humidité","info":"","x":180,"y":954,"wires":[]},{"id":"85774a17.d0bc28","type":"inject","z":"b3a949db.c3ae18","name":"Test T° Ext <5","topic":"","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"x":496,"y":331,"wires":[["315e9636.3cae5a"]]},{"id":"f3dbbe6c.ff78d","type":"inject","z":"b3a949db.c3ae18","name":"Test Q air =4 (correct)","topic":"","payload":"4","payloadType":"num","repeat":"","crontab":"","once":false,"x":603,"y":422,"wires":[["eec78af6.b30f48","83fd3d06.b43c68"]]},{"id":"784a5290.b75784","type":"inject","z":"b3a949db.c3ae18","name":"Test Q air =5 (pollué)","topic":"","payload":"5","payloadType":"num","repeat":"","crontab":"","once":false,"x":620,"y":464,"wires":[["eec78af6.b30f48","83fd3d06.b43c68"]]},{"id":"3cdea142.631f26","type":"inject","z":"b3a949db.c3ae18","name":"Test Q air =8 (très pollué)","topic":"","payload":"8","payloadType":"num","repeat":"","crontab":"","once":false,"x":667,"y":500,"wires":[["eec78af6.b30f48","83fd3d06.b43c68"]]},{"id":"fe5ed7f5.77765","type":"ui_template","z":"b3a949db.c3ae18","group":"ddb91611.590b08","name":"","order":1,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:0px; text-align: left; margin:2px; border:2px solid white;\">\n<span style=\"width:33%;padding-top:5px;padding-left:5px;\">{{\"Hum: \" + msg.h1 +\"%\"}}</span>\n<span style=\"width:33%;padding-top:5px;padding-left:5px;\">{{\"T° Ext: \" + msg.t1 + \"°c\"}}</span>\n<span style=\"width:33%;padding-top:5px;padding-left:5px;\">{{\"Q air: \" + msg.a1 }}</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"x":562,"y":38,"wires":[[]]},{"id":"1f4302e1.9fff85","type":"function","z":"b3a949db.c3ae18","name":"context.global.SeuilTemp","func":"context.global.SeuilTemp = msg.payload;\nmsg.payload = context.global.SeuilTemp || 5;\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":459,"y":762,"wires":[["799eb02d.605568"]]},{"id":"e6c7e72d.58c408","type":"debug","z":"b3a949db.c3ae18","name":"","active":true,"console":"false","complete":"false","x":636,"y":668,"wires":[]},{"id":"799eb02d.605568","type":"ui_text","z":"b3a949db.c3ae18","group":"ddb91611.590b08","order":4,"width":0,"height":0,"name":"Seuil T° lancement VMC","label":"Seuil T° lancement VMC : ","format":"{{msg.payload}}°","layout":"row-center","x":728,"y":791,"wires":[]},{"id":"eb7a87aa.76926","type":"debug","z":"b3a949db.c3ae18","name":"","active":true,"console":"false","complete":"false","x":905,"y":121,"wires":[]},{"id":"8722c627.393098","type":"debug","z":"b3a949db.c3ae18","name":"","active":true,"console":"false","complete":"false","x":912,"y":170,"wires":[]},{"id":"b7b2b684.a0ced8","type":"comment","z":"b3a949db.c3ae18","name":"Sélection seuil température","info":"","x":209.99998474121094,"y":684,"wires":[]},{"id":"be7f444.585e438","type":"ui_template","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","name":"Template Video Foscam","order":6,"width":0,"height":0,"format":"<!DOCTYPE html>\n<style>\niframe{ width:400px; height: 225px; overflow-x: hidden; overflow-y: scroll }\n</style>\n<iframe name=\"Frame3\" src=\"http://192.168.1.100:80/videostream.cgi?user=visitor&amp;pwd=bipbip14&amp;resolution=8&amp;rate=0\" frameborder=\"2\" allowfullscreen>\n</iframe>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":548,"y":1076,"wires":[[]]},{"id":"970aeb40.3a54a","type":"ui_chart","z":"2f03aa46.79fcbe","name":"Chart-Humidité","group":"d578210b.b94fe","order":15,"width":0,"height":0,"label":"Humidité","chartType":"line","legend":"true","xformat":"HH","interpolate":"linear","nodata":"Humidité","ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"x":573,"y":694,"wires":[[],[]]},{"id":"943f90d4.39cdb","type":"function","z":"b3a949db.c3ae18","name":"populate-Template","func":"msg = {};\nmsg.t1 =  Math.trunc(context.global.TempExt);\nmsg.h1 =  Math.trunc(context.global.Humidity);\nmsg.a1 =  context.global.Qair;\n    node.status({text:msg.t1});\nreturn msg;","outputs":"1","noerr":0,"x":294,"y":37,"wires":[["fe5ed7f5.77765"]]},{"id":"9c5f885c.d69cd8","type":"function","z":"b3a949db.c3ae18","name":"context.global.TempExt","func":"msg.payload = context.global.TempExt;\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":287,"y":423,"wires":[[]]},{"id":"5c95d526.54641c","type":"comment","z":"b3a949db.c3ae18","name":"Qualité de l'air","info":"","x":240.99998474121094,"y":515,"wires":[]},{"id":"51c8d8de.5324a8","type":"file in","z":"b3a949db.c3ae18","name":"sortie.xml","filename":"/var/www/html/qair/qair.txt","format":"utf8","sendError":true,"x":219,"y":554,"wires":[["83fd3d06.b43c68"]]},{"id":"83fd3d06.b43c68","type":"function","z":"b3a949db.c3ae18","name":"context.global.Qair","func":"context.global.Qair = msg.payload;\nmsg.payload = context.global.Qair;\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":955,"y":554,"wires":[[]]},{"id":"ce86bbc4.0cca9","type":"function","z":"b3a949db.c3ae18","name":"global.TempExt","func":"msg.payload = context.global.TempExt;\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":533,"y":280.20001220703125,"wires":[["315e9636.3cae5a"]]},{"id":"ca62cd99.af0c38","type":"function","z":"b3a949db.c3ae18","name":"global.Qair","func":"msg.payload = context.global.Qair;\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":943.2000122070312,"y":305.20001220703125,"wires":[["eec78af6.b30f48"]]},{"id":"1bbab123.5b8a5f","type":"ui_template","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","name":"TPL-Cam","order":7,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<span style=\"width:40%;padding-top:5px;padding-left:5px;\">{{\"Caméra\"}}\n\n</span>\n<span style=\"width:60%; padding-top:5px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/left-blue.png\" ng-click=\"send({payload: 'left' })\" height=\"24px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/up-blue.png\" ng-click=\"send({payload: 'up' })\" height=\"24px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/down-blue.png\" ng-click=\"send({payload: 'down' })\" height=\"24px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/right-blue.png\" ng-click=\"send({payload: 'right' })\" height=\"24px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/P.png\" ng-click=\"send({payload: 'patrol' })\" height=\"24px\"/>\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":540,"y":936,"wires":[["8eff05b6.837e28","350b754.df62f8a","be7f444.585e438"]]},{"id":"8eff05b6.837e28","type":"debug","z":"2f03aa46.79fcbe","name":"","active":true,"console":"false","complete":"false","x":763,"y":887,"wires":[]},{"id":"350b754.df62f8a","type":"switch","z":"2f03aa46.79fcbe","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"left","vt":"str"},{"t":"eq","v":"up","vt":"str"},{"t":"eq","v":"down","vt":"str"},{"t":"eq","v":"right","vt":"str"},{"t":"eq","v":"patrol","vt":"str"}],"checkall":"true","outputs":5,"x":740,"y":966,"wires":[["9c5b9c90.186498"],["5c208160.dc9c88"],["16af137a.bc0a45"],["e9fd8396.714f28"],["92c2b211.cb4b1"]]},{"id":"9c5b9c90.186498","type":"http request","z":"2f03aa46.79fcbe","name":"cam left","method":"POST","ret":"txt","url":"http://192.168.1.100/decoder_control.cgi?&amp;user=admin&amp;pwd=huup6380!&amp;command=6&amp;onestep=5","tls":"","x":980,"y":944,"wires":[["c0b2c39b.9fcf68"]]},{"id":"c0b2c39b.9fcf68","type":"debug","z":"2f03aa46.79fcbe","name":"","active":true,"console":"false","complete":"false","x":1194,"y":1005,"wires":[]},{"id":"5c208160.dc9c88","type":"http request","z":"2f03aa46.79fcbe","name":"cam up","method":"POST","ret":"txt","url":"http://192.168.1.100/decoder_control.cgi?&amp;user=admin&amp;pwd=huup6380!&amp;command=0&amp;onestep=5","tls":"","x":976,"y":984,"wires":[["c0b2c39b.9fcf68"]]},{"id":"16af137a.bc0a45","type":"http request","z":"2f03aa46.79fcbe","name":"cam down","method":"POST","ret":"txt","url":"http://192.168.1.100/decoder_control.cgi?&amp;user=admin&amp;pwd=huup6380!&amp;command=2&amp;onestep=5","tls":"","x":974,"y":1030,"wires":[["c0b2c39b.9fcf68"]]},{"id":"e9fd8396.714f28","type":"http request","z":"2f03aa46.79fcbe","name":"cam right","method":"POST","ret":"txt","url":"http://192.168.1.100/decoder_control.cgi?&amp;user=admin&amp;pwd=huup6380!&amp;command=4&amp;onestep=5","tls":"","x":973,"y":1074,"wires":[["c0b2c39b.9fcf68"]]},{"id":"92c2b211.cb4b1","type":"http request","z":"2f03aa46.79fcbe","name":"cam patrol","method":"POST","ret":"txt","url":"http://192.168.1.100/decoder_control.cgi?&amp;user=admin&amp;pwd=huup6380!&amp;command=28","tls":"","x":983,"y":1127,"wires":[["c0b2c39b.9fcf68"]]},{"id":"2e949bf.fe92464","type":"debug","z":"2f03aa46.79fcbe","name":"","active":false,"console":"false","complete":"false","x":561,"y":275,"wires":[]},{"id":"6876e26d.9cecfc","type":"inject","z":"13503b77.86f9b5","name":"","topic":"","payload":"","payloadType":"date","repeat":"604800","crontab":"","once":false,"x":104,"y":91,"wires":[["c333ba31.f832e"]]},{"id":"c333ba31.f832e","type":"exec","z":"13503b77.86f9b5","command":"npm outdated  -json  --prefix /home/pi/.node-red","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":387,"y":90.5,"wires":[["66977402.3aa124"],[],[]]},{"id":"b0c552f8.0a172","type":"e-mail","z":"13503b77.86f9b5","server":"smtp.gmail.com","port":"465","secure":true,"name":"coyotte14@gmail.com","dname":"NPM Maj","x":881,"y":53,"wires":[]},{"id":"87033ee0.35a638","type":"debug","z":"13503b77.86f9b5","name":"","active":true,"console":"false","complete":"false","x":886,"y":107,"wires":[]},{"id":"66977402.3aa124","type":"function","z":"13503b77.86f9b5","name":"Mailformat","func":"var m=\"<table style='font-family:arial; font-size:14px'><tr><td style='color:blue'><b>Node</b></td><td style='color:blue'><b>Current</b></td><td style='color:blue'><b>Wanted</b></td><td style='color:blue'><b>Latest</b></td></tr>\";\nmsg.payload=JSON.parse(msg.payload);\n \nfor (var key in msg.payload)\n{\n  m+=\"<tr><td style='color:green'>\";\n  m+=key;\n  m+=\"</td><td>\";\n  var mm=msg.payload[key];\n  m+=mm.current;\n  m+=\"</td><td>\";\n  m+=mm.wanted;\n  m+=\"</td><td>\";\n  m+=mm.latest;\n  m+=\"</td></tr>\";\n}\nm+=\"</table>\";\nmsg.payload=m;\nreturn msg;","outputs":1,"noerr":0,"x":704,"y":77,"wires":[["b0c552f8.0a172","87033ee0.35a638"]]},{"id":"bcf362ea.ed0ef","type":"comment","z":"13503b77.86f9b5","name":"Vérification MAJ modules npm","info":"","x":151,"y":31,"wires":[]},{"id":"b1bff0d8.d7aab8","type":"comment","z":"af7c18b0.5a85a","name":"Volets Véranda","info":"","x":719,"y":722,"wires":[]},{"id":"992f33dd.cf4d","type":"ui_template","z":"af7c18b0.5a85a","group":"8610111b.4a2c18","name":"TPL-/Volet/veranda/est1","order":1,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet pan fixe est\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":750,"y":759,"wires":[["32dd4b51.96076c","3bcf3174.90fe26"]]},{"id":"3bcf3174.90fe26","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/veranda/est1","topic":"/Volet/veranda/est1","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1038,"y":778,"wires":[]},{"id":"32dd4b51.96076c","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1018,"y":743,"wires":[]},{"id":"62a6c8d1.8ee0a","type":"ui_template","z":"af7c18b0.5a85a","group":"8610111b.4a2c18","name":"TPL-/Volet/veranda/est2","order":2,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet pan mobile est\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":750,"y":876,"wires":[["9119c398.96418","c9c95a0c.59d1b8"]]},{"id":"c9c95a0c.59d1b8","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/veranda/est2","topic":"/Volet/veranda/est2","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1039,"y":901,"wires":[]},{"id":"9119c398.96418","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1019,"y":860,"wires":[]},{"id":"bd325167.82b93","type":"ui_template","z":"af7c18b0.5a85a","group":"8610111b.4a2c18","name":"TPL-/Volet/veranda/sud1","order":3,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet pan mobile sud\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":752,"y":987,"wires":[["6bf9480e.964558","6061cb90.ad008c"]]},{"id":"6061cb90.ad008c","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/veranda/sud1","topic":"/Volet/veranda/sud1","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1049,"y":1008,"wires":[]},{"id":"6bf9480e.964558","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1019,"y":972,"wires":[]},{"id":"b15d0294.bf6fa8","type":"ui_template","z":"af7c18b0.5a85a","group":"8610111b.4a2c18","name":"TPL-/Volet/veranda/sud2","order":4,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet pan fixe sud\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":755,"y":1088,"wires":[["63d8858a.0b7734","60c299a4.dcd258"]]},{"id":"60c299a4.dcd258","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/veranda/sud2","topic":"/Volet/veranda/sud2","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1054,"y":1112,"wires":[]},{"id":"63d8858a.0b7734","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1025,"y":1076,"wires":[]},{"id":"2e099edd.2348ba","type":"ui_template","z":"af7c18b0.5a85a","group":"f9259a3c.bfe4c8","name":"TPL-/Volet/cuisine/est","order":2,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet est\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":742,"y":182,"wires":[["d5b01a4d.57bf9","9276e0e1.4ab9d"]]},{"id":"9276e0e1.4ab9d","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/cuisine/est","topic":"/Volet/cuisine/est","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1034,"y":201,"wires":[]},{"id":"d5b01a4d.57bf9","type":"debug","z":"af7c18b0.5a85a","name":"","active":true,"console":"false","complete":"false","x":1013,"y":158,"wires":[]},{"id":"b1868892.1798d8","type":"ui_template","z":"af7c18b0.5a85a","group":"f9259a3c.bfe4c8","name":"TPL-/Volet/cuisine/nord","order":1,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet nord\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":754,"y":78,"wires":[["c1845971.bebc48","3caa5825.6dd638"]]},{"id":"3caa5825.6dd638","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/cuisine/nord","topic":"/Volet/cuisine/nord","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1034,"y":100,"wires":[]},{"id":"c1845971.bebc48","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1013,"y":58,"wires":[]},{"id":"65d50e25.85403","type":"ui_template","z":"af7c18b0.5a85a","group":"f9259a3c.bfe4c8","name":"TPL-/Volet/cuisine/sud","order":3,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet baie vitrée sud\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":742,"y":283,"wires":[["62b7a204.0b3964","db1a7fa7.11e708"]]},{"id":"db1a7fa7.11e708","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/cuisine/sud","topic":"/Volet/cuisine/sud","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1033,"y":305,"wires":[]},{"id":"62b7a204.0b3964","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1012,"y":268,"wires":[]},{"id":"d9381841.fa27d","type":"comment","z":"af7c18b0.5a85a","name":"Volets cuisine","info":"","x":712,"y":37,"wires":[]},{"id":"6b185372.4106e4","type":"ui_template","z":"af7c18b0.5a85a","group":"784a0014.4f7bc","name":"TPL-générale","order":2,"width":0,"height":0,"format":"<script>\nfunction restore_icon() {\n        $(this).attr('src',$(this).attr('src').replace(\"_b.png\",\".png\"));\n    };\n \n$('.lightup').on('mousedown', function() {\n    $(this).attr('src',$(this).attr('src').replace(\".png\",\"_b.png\"));  \n    setTimeout(restore_icon.bind(this),500);\n    navigator.vibrate(100);\n    });\n</script>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":102,"y":37,"wires":[[]]},{"id":"af4b7c51.e75d28","type":"ui_template","z":"af7c18b0.5a85a","group":"6f9109ca.fe882","name":"TPL-/Volet/chambreParents/nord","order":1,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet nord\"}}\n</span>\n\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":787,"y":1221,"wires":[["a0738b4f.ae1a18","890de410.b45438"]]},{"id":"890de410.b45438","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/chambreParents/nord","topic":"/Volet/chambreParents/nord","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1074,"y":1243,"wires":[]},{"id":"a0738b4f.ae1a18","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1028,"y":1198,"wires":[]},{"id":"50020238.67bdc4","type":"comment","z":"af7c18b0.5a85a","name":"Volets chambre parents","info":"","x":749,"y":1185,"wires":[]},{"id":"650a099a.66b4c8","type":"ui_template","z":"af7c18b0.5a85a","group":"784a0014.4f7bc","name":"TPL-/Volet/salledebain/nord","order":1,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet nord\"}}\n</span>\n\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":763,"y":1357,"wires":[["9f5463ce.ad001","30dff66e.72ad9a"]]},{"id":"30dff66e.72ad9a","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/salledebain/nord","topic":"/Volet/salledebain/nord","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1052,"y":1377,"wires":[]},{"id":"9f5463ce.ad001","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1011,"y":1342,"wires":[]},{"id":"858b6956.3f8278","type":"comment","z":"af7c18b0.5a85a","name":"Volets salle de bain","info":"","x":732,"y":1322,"wires":[]},{"id":"845542.66556ac","type":"ui_template","z":"af7c18b0.5a85a","group":"ed7c6733.090e","name":"/Volet/chambreSarah/nord","order":1,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet nord\"}}\n</span>\n\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":762,"y":1464,"wires":[["b294462a.4c1f5","d18ae8eb.c74fe"]]},{"id":"d18ae8eb.c74fe","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/chambreSarah/nord","topic":"/Volet/chambreSarah/nord","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1060,"y":1488,"wires":[]},{"id":"b294462a.4c1f5","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1013,"y":1450,"wires":[]},{"id":"4db8b621.2f2b5","type":"comment","z":"af7c18b0.5a85a","name":"Volets chambre Sarah","info":"","x":742,"y":1429,"wires":[]},{"id":"af78d99b.dbddc","type":"ui_template","z":"af7c18b0.5a85a","group":"ed7c6733.090e","name":"/Volet/chambreSarah/est1","order":2,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet est 1\"}}\n</span>\n\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":751,"y":1575,"wires":[["12ce6761.e1f8b1","7486dec7.cfb2d8"]]},{"id":"7486dec7.cfb2d8","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/chambreSarah/est1","topic":"/Volet/chambreSarah/est1","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1051,"y":1600,"wires":[]},{"id":"12ce6761.e1f8b1","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1011,"y":1565,"wires":[]},{"id":"3be13f16.837d08","type":"ui_template","z":"af7c18b0.5a85a","group":"ed7c6733.090e","name":"/Volet/chambreSarah/est2","order":3,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet est 2\"}}\n</span>\n\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":752,"y":1685,"wires":[["39e35674.1c53ca","6385fa4.5284d04"]]},{"id":"6385fa4.5284d04","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/chambreSarah/est2","topic":"/Volet/chambreSarah/est2","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1050,"y":1707,"wires":[]},{"id":"39e35674.1c53ca","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1010,"y":1671,"wires":[]},{"id":"3eaba0f.daa56e","type":"ui_template","z":"af7c18b0.5a85a","group":"8a0cb6e5.d3a96","name":"/Volet/chambreAnais/sud","order":1,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n\n<img class=\"lightup\" src=\"http://domobox//icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet sud\"}}\n</span>\n\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox//icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox//icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox//icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":752,"y":1816,"wires":[["a933b72b.bc1a48","a1d7808c.1d12e8"]]},{"id":"a1d7808c.1d12e8","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/chambreAnais/sud","topic":"/Volet/chambreAnais/sud","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1048,"y":1837,"wires":[]},{"id":"a933b72b.bc1a48","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1009,"y":1801,"wires":[]},{"id":"4c439bbe.69c7b4","type":"comment","z":"af7c18b0.5a85a","name":"Volets chambre Anaïs","info":"","x":740,"y":1780,"wires":[]},{"id":"1b5df6d7.245f69","type":"comment","z":"af7c18b0.5a85a","name":"Volets commande générale","info":"","x":138,"y":1120,"wires":[]},{"id":"f1bdff55.1e9ff","type":"ui_template","z":"af7c18b0.5a85a","group":"f7b9bc37.821d08","name":"/Volet/All","order":1,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Tous les volets\"}}\n</span>\n\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":95,"y":1161,"wires":[["4ac6912d.638738"]]},{"id":"c7b332a2.8d8ed8","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":511,"y":101,"wires":[["3caa5825.6dd638"]]},{"id":"4ac6912d.638738","type":"function","z":"af7c18b0.5a85a","name":"Répéteur","func":"for (i = 0; i < 3; i++) \n{\n    node.send(msg);\n}","outputs":1,"noerr":0,"x":261,"y":1157,"wires":[["c7b332a2.8d8ed8","d302d532.f95118","19bb9441.990c5c","9d71a38d.8488d8","a418a5da.dc9838","cc9ae406.5d5a38","191f556d.2f01cb","4ab2a65b.077c98","fcaefb03.1a5f78","8e019154.e36928","f8f0aac.bc0bd58","174bfb0b.caeadd","b8092858.391718","1d510a79.7f924e","8daa1819.f885e","1d8ab36e.3de725","4f013b65.69a164"]]},{"id":"d302d532.f95118","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":193,"y":1232,"wires":[]},{"id":"19bb9441.990c5c","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":510,"y":217,"wires":[["9276e0e1.4ab9d"]]},{"id":"9d71a38d.8488d8","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":510,"y":317,"wires":[["db1a7fa7.11e708"]]},{"id":"a418a5da.dc9838","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":525,"y":782,"wires":[["3bcf3174.90fe26"]]},{"id":"cc9ae406.5d5a38","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":524,"y":899,"wires":[["c9c95a0c.59d1b8"]]},{"id":"191f556d.2f01cb","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":522,"y":1013,"wires":[["6061cb90.ad008c"]]},{"id":"4ab2a65b.077c98","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":522,"y":1120,"wires":[["60c299a4.dcd258"]]},{"id":"fcaefb03.1a5f78","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":523,"y":1249,"wires":[["890de410.b45438"]]},{"id":"8e019154.e36928","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":510,"y":1381,"wires":[["30dff66e.72ad9a"]]},{"id":"f8f0aac.bc0bd58","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":509,"y":1495,"wires":[["d18ae8eb.c74fe"]]},{"id":"174bfb0b.caeadd","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":509,"y":1604,"wires":[["7486dec7.cfb2d8"]]},{"id":"b8092858.391718","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":510,"y":1714,"wires":[["6385fa4.5284d04"]]},{"id":"1d510a79.7f924e","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":507,"y":1840,"wires":[["a1d7808c.1d12e8"]]},{"id":"7b4320e2.6033c8","type":"comment","z":"af7c18b0.5a85a","name":"Volets commande rez-de-chaussée","info":"","x":158,"y":301,"wires":[]},{"id":"262b2365.24fe14","type":"ui_template","z":"af7c18b0.5a85a","group":"f7b9bc37.821d08","name":"/Volet/rez-de-chaussée","order":1,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n\n<img class=\"lightup\" src=\"http://domobox//icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volets rez-de chaussée\"}}\n</span>\n\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox//icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox//icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox//icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":144,"y":697,"wires":[["79757b7f.6d5464"]]},{"id":"d8081cec.d6f7f8","type":"comment","z":"af7c18b0.5a85a","name":"Volets commande étage","info":"","x":132,"y":1442,"wires":[]},{"id":"400cd938.eed128","type":"ui_template","z":"af7c18b0.5a85a","group":"f7b9bc37.821d08","name":"/Volet/étage","order":1,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n\n<img class=\"lightup\" src=\"http://domobox//icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volets étage\"}}\n</span>\n\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox//icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox//icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox//icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":95,"y":1478,"wires":[["93028871.9bf86"]]},{"id":"79757b7f.6d5464","type":"function","z":"af7c18b0.5a85a","name":"Répéteur","func":"for (i = 0; i < 3; i++) \n{\n    node.send(msg);\n}","outputs":1,"noerr":0,"x":232,"y":761,"wires":[["c7b332a2.8d8ed8","19bb9441.990c5c","9d71a38d.8488d8","a418a5da.dc9838","cc9ae406.5d5a38","191f556d.2f01cb","4ab2a65b.077c98","de9f0b02.3db218","8daa1819.f885e","1d8ab36e.3de725","4f013b65.69a164"]]},{"id":"93028871.9bf86","type":"function","z":"af7c18b0.5a85a","name":"Répéteur","func":"for (i = 0; i < 3; i++) \n{\n    node.send(msg);\n}","outputs":1,"noerr":0,"x":177,"y":1551,"wires":[["fcaefb03.1a5f78","8e019154.e36928","f8f0aac.bc0bd58","174bfb0b.caeadd","b8092858.391718","1d510a79.7f924e","d8a3d896.1febd8"]]},{"id":"d8a3d896.1febd8","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":190,"y":1615,"wires":[]},{"id":"de9f0b02.3db218","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":238,"y":825,"wires":[]},{"id":"4168427e.6cb504","type":"inject","z":"fa457347.ecb0c","name":"Every 5mn","topic":"","payload":"","payloadType":"date","repeat":"900","crontab":"","once":true,"x":111,"y":69,"wires":[["d442d4b0.21297"]]},{"id":"b2e2fdb5.5113e","type":"function","z":"fa457347.ecb0c","name":"Set DarkSky global var","func":"try {\nvar weathertest=msg.payload.currently;\nglobal.set(\"DarkSky\",msg.payload);\nnode.send (msg);\n}\ncatch(e) {}","outputs":1,"noerr":0,"x":601,"y":70,"wires":[["da10366e.6da6"]]},{"id":"d442d4b0.21297","type":"http request","z":"fa457347.ecb0c","name":"Darksky Json Get","method":"GET","ret":"obj","url":"https://api.darksky.net/forecast/f3ab6a06fb2ea83c99cc578d102848ac/49.213999,-0.400256?units=si&lang=fr","tls":"","x":313,"y":70,"wires":[["b2e2fdb5.5113e"]]},{"id":"da10366e.6da6","type":"debug","z":"fa457347.ecb0c","name":"","active":true,"console":"false","complete":"false","x":816,"y":71,"wires":[]},{"id":"2e80f5db.d727f2","type":"inject","z":"fa457347.ecb0c","name":"Every 5mn","topic":"","payload":"","payloadType":"date","repeat":"900","crontab":"","once":true,"x":106,"y":530,"wires":[["b9218ea7.2db72","39d9aad8.dedaee","3756a5fa.2ea4ca","ae421476.ac15f8","7943f64a.5f78b8","85e792a2.d83d18","724db770.1ce018","18234db.ba47832","a46a3287.4f7638"]]},{"id":"b9218ea7.2db72","type":"function","z":"fa457347.ecb0c","name":"Get DarkSky global var","func":"try {\nmsg.payload=global.get(\"DarkSky\").currently.icon;\nnode.send(msg);\n}\ncatch(e) {}","outputs":1,"noerr":0,"x":383,"y":397,"wires":[["8474c2e0.826ca8"]]},{"id":"96f51eab.ab458","type":"ui_template","z":"fa457347.ecb0c","group":"d2b19f67.825c","name":"TPL","order":9,"width":0,"height":0,"format":"<style>\n  .filled { \n      height: 100% !important;\n \n      padding: 0 !important;\n      margin: 0 !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n   \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n  \n   .bigfont {\n  font-size: 18px;\n}\n \n   .smallfont {\n  font-size: 12px;\n}\n   \n</style>\n \n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n \nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n \n$('.touched').on('mousedown', function() {\n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n     \n    setTimeout(restore_bg.bind(this,x),200);\n    navigator.vibrate(80);\n    });\n     \n</script>","storeOutMessages":true,"fwdInMessages":true,"x":608,"y":345,"wires":[[]]},{"id":"39d9aad8.dedaee","type":"function","z":"fa457347.ecb0c","name":"Get DarkSky global var J+1","func":"try {\nmsg.payload=global.get(\"DarkSky\").daily.data[2].icon;\nnode.send(msg);\n}\ncatch(e) {}","outputs":1,"noerr":0,"x":390,"y":443,"wires":[["bfaa8a82.47ff68"]]},{"id":"39da1ced.04d9d4","type":"debug","z":"fa457347.ecb0c","name":"","active":false,"console":"false","complete":"false","x":764,"y":397,"wires":[]},{"id":"8474c2e0.826ca8","type":"ui_template","z":"fa457347.ecb0c","group":"d2b19f67.825c","name":"Day","order":3,"width":"1","height":"1","format":"<script src=\"/myjs/skycons.js\"></script>\n \n<canvas id=\"icon1\"  width=\"50\" height=\"50\"></canvas>\n \n<script>\nvar skycons = new Skycons({\"monochrome\": false, \n                \"colors\": { \n                      \"main\": \"#779966\", \n                      \"moon\":\"#666666\",\n                      \"fog\": \"#555522\",\n                      \"fogbank\": \"#884488\",\n                      \"cloud\": \"#999999\",\n                      \"snow\": \"#aaaaaa\",\n                      \"leaf\":\"#00ff00\",\n                      \"rain\": \"#0000ff\",\n                      \"sun\": \"#ff3300\"\n                    } });\nskycons.add(\"icon1\", Skycons.PARTLY_CLOUDY_DAY);\nskycons.play();\n \n    (function(scope) {\n        scope.$watch('msg.payload', function(data) {\n           if (data==\"clear-day\") skycons.set(\"icon1\", Skycons.CLEAR_DAY);\n           if (data==\"clear-night\") skycons.set(\"icon1\", Skycons.CLEAR_NIGHT);\n           if (data==\"partly-cloudy-day\") skycons.set(\"icon1\", Skycons.PARTLY_CLOUDY_DAY);\n           if (data==\"partly-cloudy-night\") skycons.set(\"icon1\", Skycons.PARTLY_CLOUDY_NIGHT);\n           if (data==\"cloudy\") skycons.set(\"icon1\", Skycons.CLOUDY);\n           if (data==\"rain\") skycons.set(\"icon1\", Skycons.RAIN);\n           if (data==\"sleet\") skycons.set(\"icon1\", Skycons.SLEET);\n           if (data==\"snow\") skycons.set(\"icon1\", Skycons.SNOW);\n           if (data==\"wind\") skycons.set(\"icon1\", Skycons.WIND);\n           if (data==\"fog\") skycons.set(\"icon1\", Skycons.FOG);\n        });\n    })(scope);\n \n</script>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":602,"y":397,"wires":[["39da1ced.04d9d4"]]},{"id":"bfaa8a82.47ff68","type":"ui_template","z":"fa457347.ecb0c","group":"d2b19f67.825c","name":"Day+1","order":4,"width":"1","height":"1","format":"<canvas id=\"icon2\"  width=\"50\" height=\"50\"></canvas>\n \n<script>\nvar skycons = new Skycons({\"monochrome\": false, \n                \"colors\": { \n                      \"main\": \"#779966\", \n                      \"moon\":\"#666666\",\n                      \"fog\": \"#555522\",\n                      \"fogbank\": \"#884488\",\n                      \"cloud\": \"#999999\",\n                      \"snow\": \"#aaaaaa\",\n                      \"leaf\":\"#00ff00\",\n                      \"rain\": \"#0000ff\",\n                      \"sun\": \"#ff3300\"\n                    } });\nskycons.add(\"icon2\", Skycons.PARTLY_CLOUDY_DAY);\nskycons.play();\n \n    (function(scope) {\n        scope.$watch('msg.payload', function(data) {\n           if (data==\"clear-day\") skycons.set(\"icon2\", Skycons.CLEAR_DAY);\n           if (data==\"clear-night\") skycons.set(\"icon2\", Skycons.CLEAR_NIGHT);\n           if (data==\"partly-cloudy-day\") skycons.set(\"icon2\", Skycons.PARTLY_CLOUDY_DAY);\n           if (data==\"partly-cloudy-night\") skycons.set(\"icon2\", Skycons.PARTLY_CLOUDY_NIGHT);\n           if (data==\"cloudy\") skycons.set(\"icon2\", Skycons.CLOUDY);\n           if (data==\"rain\") skycons.set(\"icon2\", Skycons.RAIN);\n           if (data==\"sleet\") skycons.set(\"icon2\", Skycons.SLEET);\n           if (data==\"snow\") skycons.set(\"icon2\", Skycons.SNOW);\n           if (data==\"wind\") skycons.set(\"icon2\", Skycons.WIND);\n           if (data==\"fog\") skycons.set(\"icon2\", Skycons.FOG);\n        });\n    })(scope);\n \n</script>","storeOutMessages":true,"fwdInMessages":true,"x":601,"y":443,"wires":[["354efe07.f015d2"]]},{"id":"cb43963a.f2b67","type":"ui_template","z":"fa457347.ecb0c","group":"d2b19f67.825c","name":"Day+2","order":5,"width":"1","height":"1","format":"<canvas id=\"icon3\"  width=\"50\" height=\"50\"></canvas>\n \n<script>\nvar skycons = new Skycons({\"monochrome\": false, \n                \"colors\": { \n                      \"main\": \"#779966\", \n                      \"moon\":\"#666666\",\n                      \"fog\": \"#555522\",\n                      \"fogbank\": \"#884488\",\n                      \"cloud\": \"#999999\",\n                      \"snow\": \"#aaaaaa\",\n                      \"leaf\":\"#00ff00\",\n                      \"rain\": \"#0000ff\",\n                      \"sun\": \"#ff3300\"\n                    } });\nskycons.add(\"icon3\", Skycons.PARTLY_CLOUDY_DAY);\nskycons.play();\n \n    (function(scope) {\n        scope.$watch('msg.payload', function(data) {\n           if (data==\"clear-day\") skycons.set(\"icon3\", Skycons.CLEAR_DAY);\n           if (data==\"clear-night\") skycons.set(\"icon3\", Skycons.CLEAR_NIGHT);\n           if (data==\"partly-cloudy-day\") skycons.set(\"icon3\", Skycons.PARTLY_CLOUDY_DAY);\n           if (data==\"partly-cloudy-night\") skycons.set(\"icon3\", Skycons.PARTLY_CLOUDY_NIGHT);\n           if (data==\"cloudy\") skycons.set(\"icon3\", Skycons.CLOUDY);\n           if (data==\"rain\") skycons.set(\"icon3\", Skycons.RAIN);\n           if (data==\"sleet\") skycons.set(\"icon3\", Skycons.SLEET);\n           if (data==\"snow\") skycons.set(\"icon3\", Skycons.SNOW);\n           if (data==\"wind\") skycons.set(\"icon3\", Skycons.WIND);\n           if (data==\"fog\") skycons.set(\"icon3\", Skycons.FOG);\n        });\n    })(scope);\n \n</script>","storeOutMessages":true,"fwdInMessages":true,"x":599,"y":494,"wires":[["e01f5db4.ed5a38"]]},{"id":"2e1371d6.ae77fe","type":"ui_template","z":"fa457347.ecb0c","group":"d2b19f67.825c","name":"Day+3","order":6,"width":"1","height":"1","format":"<canvas id=\"icon4\"  width=\"50\" height=\"50\"></canvas>\n \n<script>\nvar skycons = new Skycons({\"monochrome\": false, \n                \"colors\": { \n                      \"main\": \"#779966\", \n                      \"moon\":\"#666666\",\n                      \"fog\": \"#555522\",\n                      \"fogbank\": \"#884488\",\n                      \"cloud\": \"#999999\",\n                      \"snow\": \"#aaaaaa\",\n                      \"leaf\":\"#00ff00\",\n                      \"rain\": \"#0000ff\",\n                      \"sun\": \"#ff3300\"\n                    } });\nskycons.add(\"icon4\", Skycons.PARTLY_CLOUDY_DAY);\nskycons.play();\n \n    (function(scope) {\n        scope.$watch('msg.payload', function(data) {\n           if (data==\"clear-day\") skycons.set(\"icon4\", Skycons.CLEAR_DAY);\n           if (data==\"clear-night\") skycons.set(\"icon4\", Skycons.CLEAR_NIGHT);\n           if (data==\"partly-cloudy-day\") skycons.set(\"icon4\", Skycons.PARTLY_CLOUDY_DAY);\n           if (data==\"partly-cloudy-night\") skycons.set(\"icon4\", Skycons.PARTLY_CLOUDY_NIGHT);\n           if (data==\"cloudy\") skycons.set(\"icon4\", Skycons.CLOUDY);\n           if (data==\"rain\") skycons.set(\"icon4\", Skycons.RAIN);\n           if (data==\"sleet\") skycons.set(\"icon4\", Skycons.SLEET);\n           if (data==\"snow\") skycons.set(\"icon4\", Skycons.SNOW);\n           if (data==\"wind\") skycons.set(\"icon4\", Skycons.WIND);\n           if (data==\"fog\") skycons.set(\"icon4\", Skycons.FOG);\n        });\n    })(scope);\n \n</script>","storeOutMessages":true,"fwdInMessages":true,"x":600,"y":543,"wires":[["a647c4f7.21e35"]]},{"id":"4351dc0a.98b66c","type":"ui_template","z":"fa457347.ecb0c","group":"d2b19f67.825c","name":"Day+4","order":7,"width":"1","height":"1","format":"<canvas id=\"icon5\"  width=\"50\" height=\"50\"></canvas>\n \n<script>\nvar skycons = new Skycons({\"monochrome\": false, \n                \"colors\": { \n                      \"main\": \"#779966\", \n                      \"moon\":\"#666666\",\n                      \"fog\": \"#555522\",\n                      \"fogbank\": \"#884488\",\n                      \"cloud\": \"#999999\",\n                      \"snow\": \"#aaaaaa\",\n                      \"leaf\":\"#00ff00\",\n                      \"rain\": \"#0000ff\",\n                      \"sun\": \"#ff3300\"\n                    } });\nskycons.add(\"icon5\", Skycons.PARTLY_CLOUDY_DAY);\nskycons.play();\n \n    (function(scope) {\n        scope.$watch('msg.payload', function(data) {\n           if (data==\"clear-day\") skycons.set(\"icon5\", Skycons.CLEAR_DAY);\n           if (data==\"clear-night\") skycons.set(\"icon5\", Skycons.CLEAR_NIGHT);\n           if (data==\"partly-cloudy-day\") skycons.set(\"icon5\", Skycons.PARTLY_CLOUDY_DAY);\n           if (data==\"partly-cloudy-night\") skycons.set(\"icon5\", Skycons.PARTLY_CLOUDY_NIGHT);\n           if (data==\"cloudy\") skycons.set(\"icon5\", Skycons.CLOUDY);\n           if (data==\"rain\") skycons.set(\"icon5\", Skycons.RAIN);\n           if (data==\"sleet\") skycons.set(\"icon5\", Skycons.SLEET);\n           if (data==\"snow\") skycons.set(\"icon5\", Skycons.SNOW);\n           if (data==\"wind\") skycons.set(\"icon5\", Skycons.WIND);\n           if (data==\"fog\") skycons.set(\"icon5\", Skycons.FOG);\n        });\n    })(scope);\n \n</script>","storeOutMessages":true,"fwdInMessages":true,"x":600,"y":596,"wires":[["21cce6e8.65196a"]]},{"id":"806c4bf1.f69aa","type":"ui_template","z":"fa457347.ecb0c","group":"d2b19f67.825c","name":"Day+5","order":8,"width":"1","height":"1","format":"<canvas id=\"icon6\"  width=\"50\" height=\"50\"></canvas>\n \n<script>\nvar skycons = new Skycons({\"monochrome\": false, \n                \"colors\": { \n                      \"main\": \"#779966\", \n                      \"moon\":\"#666666\",\n                      \"fog\": \"#555522\",\n                      \"fogbank\": \"#884488\",\n                      \"cloud\": \"#999999\",\n                      \"snow\": \"#aaaaaa\",\n                      \"leaf\":\"#00ff00\",\n                      \"rain\": \"#0000ff\",\n                      \"sun\": \"#ff3300\"\n                    } });\nskycons.add(\"icon6\", Skycons.PARTLY_CLOUDY_DAY);\nskycons.play();\n \n    (function(scope) {\n        scope.$watch('msg.payload', function(data) {\n           if (data==\"clear-day\") skycons.set(\"icon6\", Skycons.CLEAR_DAY);\n           if (data==\"clear-night\") skycons.set(\"icon6\", Skycons.CLEAR_NIGHT);\n           if (data==\"partly-cloudy-day\") skycons.set(\"icon6\", Skycons.PARTLY_CLOUDY_DAY);\n           if (data==\"partly-cloudy-night\") skycons.set(\"icon6\", Skycons.PARTLY_CLOUDY_NIGHT);\n           if (data==\"cloudy\") skycons.set(\"icon6\", Skycons.CLOUDY);\n           if (data==\"rain\") skycons.set(\"icon6\", Skycons.RAIN);\n           if (data==\"sleet\") skycons.set(\"icon6\", Skycons.SLEET);\n           if (data==\"snow\") skycons.set(\"icon6\", Skycons.SNOW);\n           if (data==\"wind\") skycons.set(\"icon6\", Skycons.WIND);\n           if (data==\"fog\") skycons.set(\"icon6\", Skycons.FOG);\n        });\n    })(scope);\n \n</script>","storeOutMessages":true,"fwdInMessages":true,"x":598,"y":646,"wires":[["2226ccc.609c734"]]},{"id":"3756a5fa.2ea4ca","type":"function","z":"fa457347.ecb0c","name":"Get DarkSky global var J+2","func":"try {\nmsg.payload=global.get(\"DarkSky\").daily.data[3].icon;\nnode.send(msg);\n}\ncatch(e) {}","outputs":1,"noerr":0,"x":386,"y":493,"wires":[["cb43963a.f2b67"]]},{"id":"ae421476.ac15f8","type":"function","z":"fa457347.ecb0c","name":"Get DarkSky global var J+3","func":"try {\nmsg.payload=global.get(\"DarkSky\").daily.data[4].icon;\nnode.send(msg);\n}\ncatch(e) {}","outputs":1,"noerr":0,"x":387,"y":543,"wires":[["2e1371d6.ae77fe"]]},{"id":"7943f64a.5f78b8","type":"function","z":"fa457347.ecb0c","name":"Get DarkSky global var J+4","func":"try {\nmsg.payload=global.get(\"DarkSky\").daily.data[5].icon;\nnode.send(msg);\n}\ncatch(e) {}","outputs":1,"noerr":0,"x":390,"y":595,"wires":[["4351dc0a.98b66c"]]},{"id":"85e792a2.d83d18","type":"function","z":"fa457347.ecb0c","name":"Get DarkSky global var J+5","func":"try {\nmsg.payload=global.get(\"DarkSky\").daily.data[6].icon;\nnode.send(msg);\n}\ncatch(e) {}","outputs":1,"noerr":0,"x":390,"y":646,"wires":[["806c4bf1.f69aa"]]},{"id":"354efe07.f015d2","type":"debug","z":"fa457347.ecb0c","name":"","active":false,"console":"false","complete":"false","x":766,"y":443,"wires":[]},{"id":"e01f5db4.ed5a38","type":"debug","z":"fa457347.ecb0c","name":"","active":false,"console":"false","complete":"false","x":765,"y":494,"wires":[]},{"id":"a647c4f7.21e35","type":"debug","z":"fa457347.ecb0c","name":"","active":false,"console":"false","complete":"false","x":767,"y":543,"wires":[]},{"id":"21cce6e8.65196a","type":"debug","z":"fa457347.ecb0c","name":"","active":false,"console":"false","complete":"false","x":766,"y":595,"wires":[]},{"id":"2226ccc.609c734","type":"debug","z":"fa457347.ecb0c","name":"","active":false,"console":"false","complete":"false","x":769,"y":646,"wires":[]},{"id":"724db770.1ce018","type":"function","z":"fa457347.ecb0c","name":"Day-week","func":"(function() {\n    //var days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];\n    //var days = ['Dimanche','Lundi','Mardi','Mercredi','jeudi','Vendredi','Samedi'];\n    //var days = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];\n    var days = ['Dim','Lun','Mar','Mer','Jeu','Ven','Sam'];\n\n    var months = ['January','February','March','April','May','June','July','August','September','October','November','December'];\n\n    Date.prototype.getMonthName = function() {\n        return months[ this.getMonth() ];\n    };\n    Date.prototype.getDayName = function() {\n        return days[ this.getDay() ];\n    };\n    \n    Date.prototype.addDays = function(days) {\n        this.setDate(this.getDate() + parseInt(days));\n    return this;\n    };\n})();\n\nmsg = {};\nvar now = new Date();\nmsg.d0 = now.getDayName();\nmsg.d1 = new Date().addDays(1).getDayName(); //+1 days\nmsg.d2 = new Date().addDays(2).getDayName(); //+2 days\nmsg.d3 = new Date().addDays(3).getDayName(); //+3 days\nmsg.d4 = new Date().addDays(4).getDayName(); //+4 days\nmsg.d5 = new Date().addDays(5).getDayName(); //+5 days\n\nmsg.payload=msg.d0;\nvar month = now.getMonthName();\n        node.status({text:msg.payload});\n        \nreturn msg;","outputs":1,"noerr":0,"x":345,"y":160,"wires":[["4fbc7c12.74861c","56eaedc8.7d16a4"]]},{"id":"4fbc7c12.74861c","type":"ui_template","z":"fa457347.ecb0c","group":"d2b19f67.825c","name":"Day-Week","order":1,"width":"6","height":"1","format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:0px; text-align: left; margin:2px; border:2px solid white;\">\n<span style=\"width:17%;padding-top:5px;padding-left:5px;\">{{msg.d0}}</span>\n<span style=\"width:16%;padding-top:5px;padding-left:5px;\">{{msg.d1}}</span>\n<span style=\"width:16%;padding-top:5px;padding-left:5px;\">{{msg.d2}}</span>\n<span style=\"width:16%;padding-top:5px;padding-left:5px;\">{{msg.d3}}</span>\n<span style=\"width:16%;padding-top:5px;padding-left:5px;\">{{msg.d4}}</span>\n<span style=\"width:16%;padding-top:5px;padding-left:5px;\">{{msg.d5}}</span>\n</div>","storeOutMessages":true,"fwdInMessages":true,"x":628,"y":140,"wires":[[]]},{"id":"56eaedc8.7d16a4","type":"debug","z":"fa457347.ecb0c","name":"","active":false,"console":"false","complete":"true","x":604,"y":190,"wires":[]},{"id":"18234db.ba47832","type":"function","z":"fa457347.ecb0c","name":"T° Min/Max","func":"try {\n    msg.tmin1=Math.round(global.get(\"DarkSky\").daily.data[1].temperatureMin);\n    msg.tmin2=Math.round(global.get(\"DarkSky\").daily.data[2].temperatureMin);\n    msg.tmin3=Math.round(global.get(\"DarkSky\").daily.data[3].temperatureMin);\n    msg.tmin4=Math.round(global.get(\"DarkSky\").daily.data[4].temperatureMin);\n    msg.tmin5=Math.round(global.get(\"DarkSky\").daily.data[5].temperatureMin);\n    msg.tmin6=Math.round(global.get(\"DarkSky\").daily.data[6].temperatureMin);\n    \n    msg.tmax1=Math.round(global.get(\"DarkSky\").daily.data[1].temperatureMax);\n    msg.tmax2=Math.round(global.get(\"DarkSky\").daily.data[2].temperatureMax);\n    msg.tmax3=Math.round(global.get(\"DarkSky\").daily.data[3].temperatureMax);\n    msg.tmax4=Math.round(global.get(\"DarkSky\").daily.data[4].temperatureMax);\n    msg.tmax5=Math.round(global.get(\"DarkSky\").daily.data[5].temperatureMax);\n    msg.tmax6=Math.round(global.get(\"DarkSky\").daily.data[6].temperatureMax);\n    \n    node.send (msg);\n}\ncatch(e) {}\n//return msg;","outputs":1,"noerr":0,"x":355,"y":258,"wires":[["c8ca374a.1941d","36dacd60.c997da"]]},{"id":"c8ca374a.1941d","type":"ui_template","z":"fa457347.ecb0c","group":"d2b19f67.825c","name":"T° Min/Max","order":2,"width":"6","height":"1","format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:0px; text-align: left; margin:2px; border:2px solid white;\">\n<span style=\"width:17%;padding-top:5px;padding-left:5px;\">{{msg.tmin1 + \"°/\" + msg.tmax1 + \"°\"}}</span>\n<span style=\"width:16%;padding-top:5px;padding-left:5px;\">{{msg.tmin2 + \"°/\" + msg.tmax2 + \"°\"}}</span>\n<span style=\"width:16%;padding-top:5px;padding-left:5px;\">{{msg.tmin3 + \"°/\" + msg.tmax3 + \"°\"}}</span>\n<span style=\"width:16%;padding-top:5px;padding-left:5px;\">{{msg.tmin4 + \"°/\" + msg.tmax4 + \"°\"}}</span>\n<span style=\"width:16%;padding-top:5px;padding-left:5px;\">{{msg.tmin5 + \"°/\" + msg.tmax5 + \"°\"}}</span>\n<span style=\"width:16%;padding-top:5px;padding-left:5px;\">{{msg.tmin6 + \"°/\" + msg.tmax6 + \"°\"}}</span>\n</div>","storeOutMessages":true,"fwdInMessages":true,"x":633,"y":239,"wires":[[]]},{"id":"36dacd60.c997da","type":"debug","z":"fa457347.ecb0c","name":"","active":false,"console":"false","complete":"true","x":610,"y":282,"wires":[]},{"id":"35bab04f.00d598","type":"ui_template","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","name":"TPL-/Volet/veranda/est1","order":10,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Pan fixe est\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":825,"y":1257,"wires":[["cf0aa8c6.6280e8"]]},{"id":"cf0aa8c6.6280e8","type":"mqtt out","z":"2f03aa46.79fcbe","name":"/Volet/veranda/est1","topic":"/Volet/veranda/est1","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1103,"y":1276,"wires":[]},{"id":"b589638b.960ba8","type":"ui_template","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","name":"TPL-/Volet/veranda/est2","order":11,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\" Pan mobile est\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"x":823,"y":1374,"wires":[["86198692.28cf58"]]},{"id":"86198692.28cf58","type":"mqtt out","z":"2f03aa46.79fcbe","name":"/Volet/veranda/est2","topic":"/Volet/veranda/est2","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1106,"y":1399,"wires":[]},{"id":"1307f378.ac27e5","type":"ui_template","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","name":"TPL-/Volet/veranda/sud1","order":12,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Pan mobile sud\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"x":823,"y":1485,"wires":[["551f910b.8e039"]]},{"id":"551f910b.8e039","type":"mqtt out","z":"2f03aa46.79fcbe","name":"/Volet/veranda/sud1","topic":"/Volet/veranda/sud1","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1112,"y":1506,"wires":[]},{"id":"37df165c.f835fa","type":"ui_template","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","name":"TPL-/Volet/veranda/sud2","order":13,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Pan fixe sud\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"x":826,"y":1586,"wires":[["6a468d6f.6aaadc"]]},{"id":"6a468d6f.6aaadc","type":"mqtt out","z":"2f03aa46.79fcbe","name":"/Volet/veranda/sud2","topic":"/Volet/veranda/sud2","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1114,"y":1610,"wires":[]},{"id":"7fb04835.0040e8","type":"delay","z":"2f03aa46.79fcbe","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":585,"y":1280,"wires":[["cf0aa8c6.6280e8"]]},{"id":"5efaff53.9319","type":"delay","z":"2f03aa46.79fcbe","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":584,"y":1397,"wires":[["86198692.28cf58"]]},{"id":"2ba2e7f.4c46e98","type":"delay","z":"2f03aa46.79fcbe","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":582,"y":1511,"wires":[["551f910b.8e039"]]},{"id":"ee3b77d2.4eece8","type":"delay","z":"2f03aa46.79fcbe","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":582,"y":1618,"wires":[["6a468d6f.6aaadc"]]},{"id":"2ccf912e.1c357e","type":"comment","z":"2f03aa46.79fcbe","name":"Volets véranda","info":"","x":107,"y":1121,"wires":[]},{"id":"95ead9f3.34da9","type":"ui_template","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","name":"/Volet/Véranda","order":9,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Tous\"}}\n</span>\n\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"x":94,"y":1336,"wires":[["1ba5c0cf.d5f717"]]},{"id":"1ba5c0cf.d5f717","type":"function","z":"2f03aa46.79fcbe","name":"Répéteur","func":"for (i = 0; i < 1; i++) \n{\n    node.send(msg);\n}\n","outputs":1,"noerr":0,"x":311,"y":1337,"wires":[["7fb04835.0040e8","5efaff53.9319","2ba2e7f.4c46e98","ee3b77d2.4eece8","8f9dd792.3a559"]]},{"id":"8f9dd792.3a559","type":"debug","z":"2f03aa46.79fcbe","name":"","active":false,"console":"false","complete":"false","x":317,"y":1401,"wires":[]},{"id":"adf5e3e.0a92ea","type":"ui_template","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","name":"TPL-générale","order":16,"width":"1","height":"1","format":"<script>\nfunction restore_icon() {\n        $(this).attr('src',$(this).attr('src').replace(\"_b.png\",\".png\"));\n    };\n \n$('.lightup').on('mousedown', function() {\n    $(this).attr('src',$(this).attr('src').replace(\".png\",\"_b.png\"));  \n    setTimeout(restore_icon.bind(this),500);\n    navigator.vibrate(100);\n    });\n</script>","storeOutMessages":true,"fwdInMessages":true,"x":99,"y":1512,"wires":[[]]},{"id":"c0fa7b0a.3b7fd8","type":"comment","z":"2f03aa46.79fcbe","name":"Véranda : Caméra","info":"","x":95,"y":896,"wires":[]},{"id":"a46a3287.4f7638","type":"function","z":"fa457347.ecb0c","name":"Get DarkSky global var J Moon","func":"try {\nmsg.payload=global.get(\"DarkSky\").daily.data[0].moonPhase;\nnode.send(msg);\n}\ncatch(e) {}","outputs":1,"noerr":0,"x":403,"y":833,"wires":[["6639c173.0e9358"]]},{"id":"6639c173.0e9358","type":"debug","z":"fa457347.ecb0c","name":"","active":true,"console":"false","complete":"payload","x":677,"y":835,"wires":[]},{"id":"84c2d8a1.5c9a08","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-Veranda/RFX/Temperature","topic":"/T-Veranda/RFX/Temperature","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":586,"y":203,"wires":[]},{"id":"699e21d0.3faa38","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-Veranda/RFX/Humidity","topic":"/T-Veranda/RFX/Humidity","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":567,"y":314,"wires":[]},{"id":"376afdc1.ee7b12","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/Exterieur/RFX/Temperature","topic":"/Exterieur/RFX/Temperature","qos":"2","retain":"true","broker":"912de5b9.a94dc8","x":576,"y":1091,"wires":[]},{"id":"d6b675a9.f4f7d8","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/Exterieur/RFX/Humidity","topic":"/Exterieur/RFX/Humidity","qos":"2","retain":"true","broker":"912de5b9.a94dc8","x":565,"y":1261,"wires":[]},{"id":"11590cc.2bdc7f3","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-Salon/RFX/Temperature","topic":"/T-Salon/RFX/Temperature","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":579,"y":648,"wires":[]},{"id":"589e0ff1.7748f8","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-Salon/RFX/Humidity","topic":"/T-Salon/RFX/Humidity","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":559,"y":746,"wires":[]},{"id":"b51195a9.881f1","type":"comment","z":"3b02cdcb.5a6722","name":"Motion","info":"Caméra configurée pour faire du ftp\nvers Jeedom /home/poirier/motion\n\nSoft mqtt-camera-ftpd envoi message MQTT \nNotifying MQTT camera/poirier/motion with active\nNotifying MQTT camera/poirier/image with image\n","x":84,"y":1751,"wires":[]},{"id":"54cd1a12.d606d4","type":"debug","z":"3b02cdcb.5a6722","name":"","active":true,"console":"false","complete":"false","x":633,"y":1787,"wires":[]},{"id":"f54015da.2d125","type":"mqtt in","z":"3b02cdcb.5a6722","name":"camera/veranda/motion","topic":"camera/veranda/motion","qos":"2","broker":"912de5b9.a94dc8","x":146,"y":1788,"wires":[["7918bce.eb3ca44"]]},{"id":"a9522117.5436","type":"mqtt in","z":"3b02cdcb.5a6722","name":"camera/veranda/image","topic":"camera/veranda/image","qos":"2","broker":"912de5b9.a94dc8","x":135,"y":1930,"wires":[["73a019e3.5cb2b8"]]},{"id":"969db8e0.40558","type":"debug","z":"3b02cdcb.5a6722","name":"","active":true,"console":"false","complete":"true","x":794,"y":1895,"wires":[]},{"id":"73a019e3.5cb2b8","type":"switch","z":"3b02cdcb.5a6722","name":"motionState","property":"motionState","propertyType":"global","rules":[{"t":"eq","v":"active","vt":"str"},{"t":"eq","v":"inactive","vt":"str"}],"checkall":"true","outputs":2,"x":357,"y":1931,"wires":[["92e8b5b6.ab199"],[]]},{"id":"cb6a51b9.70ef1","type":"debug","z":"3b02cdcb.5a6722","name":"","active":true,"console":"false","complete":"true","x":780,"y":2019,"wires":[]},{"id":"7918bce.eb3ca44","type":"function","z":"3b02cdcb.5a6722","name":"Global var motionState","func":"context.global.motionState=msg.payload;\nmsg.payload = context.global.motionState;\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":415,"y":1788,"wires":[["54cd1a12.d606d4"]]},{"id":"92e8b5b6.ab199","type":"function","z":"3b02cdcb.5a6722","name":"Global var motionImage","func":"context.global.motionImageOld=context.global.motionImage;\ncontext.global.motionImage=msg.payload;\nmsg.payload = context.global.motionImageOld;\ncontext.global.motionState=\"inactive\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":579,"y":1896,"wires":[["969db8e0.40558"]]},{"id":"a262345f.66a2f8","type":"function","z":"3b02cdcb.5a6722","name":"motionImage","func":"msg.payload = context.global.motionImageOld;\ncontext.global.motionState=\"active\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":534,"y":1963,"wires":[["cb6a51b9.70ef1"]]},{"id":"f6c75dbf.a6506","type":"mqtt out","z":"3b02cdcb.5a6722","name":"camera/veranda/image","topic":"camera/veranda/image","qos":"","retain":"","broker":"912de5b9.a94dc8","x":844,"y":1961,"wires":[]},{"id":"45e30d9d.777a54","type":"ui_template","z":"b3a949db.c3ae18","group":"ddb91611.590b08","name":"controllerSeuilHumid","order":7,"width":"6","height":"4","format":"<script>\n    var value=0;\n\n    (function(scope){\n        scope.$watch('msg', function(msg) {\n               if (typeof(msg.payload) != \"undefined\") { ssp.value=msg.payload; ssp.grow(); }\n        });\n  \n})(scope);\n\nthis.scope.action = function() {\n    return value;\n}\n    \n    var ssp = new RGraph.SemiCircularProgress({\n        id: 'SeuilHumid',\n        min: 0,\n        max: 100,\n        value: 50,\n        options: {\n            title: 'Humidité',\n            unitsPost: '%',            \n            gutterTop: 2,\n            gutterLeft: 20,\n            gutterRight: 5,\n            gutterBottom: 70,\n            labelsCenterSize: 40,\n            labelsCenterValign: 'center',\n            labelsMinSize: 10,\n            labelsMinOffsetAngle:-0.1,\n            labelsMinOffsetx:0,\n            labelsMinOffsety:0,\n            labelsMaxSize: 10,\n            labelsMaxOffsetAngle:0.1,\n            labelsMaxOffsetx:0,\n            labelsMaxOffsety:0,\n            adjustable: true,\n            textAccessiblePointerevents: false,\n            colors: ['Gradient(#224499:white)'],\n            anglesStart: RGraph.PI - 0.5,\n            anglesEnd: RGraph.TWOPI + 0.5\n        }\n    }).grow();\n  \nssp.canvas.onmouseup = function (e)\n{\n    var obj   = e.target.__object__;\n    value=obj.value;\n}  \n </script>\n\n<canvas ng-mouseup=\"send({payload:action()})\" class=\"knob\" id=\"SeuilHumid\" width=\"300\" height=\"200\">\n    [No canvas support]\n</canvas>","storeOutMessages":true,"fwdInMessages":false,"x":182,"y":1003,"wires":[["6fe8ba7c.74a644","435d0806.7fb56","58eed084.af1378"]]},{"id":"6fe8ba7c.74a644","type":"function","z":"b3a949db.c3ae18","name":"pass thru","func":"node.status({fill:\"blue\",shape:\"dot\",text:msg.payload});\n\nreturn msg;","outputs":1,"noerr":0,"x":178,"y":1064,"wires":[["45e30d9d.777a54"]]},{"id":"47dd74.c2d3ea8c","type":"ui_text","z":"b3a949db.c3ae18","group":"ddb91611.590b08","order":6,"width":0,"height":0,"name":"Seuil humidité lancement VMC","label":"Seuil humidité lancement VMC : ","format":"{{msg.payload}}%","layout":"row-center","x":748,"y":1042,"wires":[]},{"id":"52e4b07c.4a2108","type":"ui_template","z":"b3a949db.c3ae18","group":"ddb91611.590b08","name":"controllerSeuilTemp","order":5,"width":"6","height":"4","format":"<script src=\"/myjs/RGraph/RGraph.common.core.js\"></script>\n<script src=\"/myjs/RGraph/RGraph.common.dynamic.js\"></script>\n<script src=\"/myjs/RGraph/RGraph.semicircularprogress.js\"></script>\n\n<script>\n    var value=1;\n\n    (function(scope){\n        scope.$watch('msg', function(msg) {\n               if (typeof(msg.payload) != \"undefined\") { ssp.value=msg.payload; ssp.grow(); }\n        });\n  \n})(scope);\n\nthis.scope.action = function() {\n    return value;\n}\n    \n    var ssp = new RGraph.SemiCircularProgress({\n        id: 'SeuilTemp',\n        min: -5,\n        max: 15,\n        value: 5,\n        options: {\n            title: 'Température',\n            unitsPost: '°C',            \n            gutterTop: 2,\n            gutterLeft: 20,\n            gutterRight: 5,\n            gutterBottom: 70,\n            labelsCenterSize: 40,\n            labelsCenterValign: 'center',\n            labelsMinSize: 10,\n            labelsMinOffsetAngle:-0.1,\n            labelsMinOffsetx:0,\n            labelsMinOffsety:0,\n            labelsMaxSize: 10,\n            labelsMaxOffsetAngle:0.1,\n            labelsMaxOffsetx:0,\n            labelsMaxOffsety:0,\n            adjustable: true,\n            textAccessiblePointerevents: false,\n            colors: ['Gradient(orange:red)'],\n            anglesStart: RGraph.PI - 0.5,\n            anglesEnd: RGraph.TWOPI + 0.5\n        }\n    }).grow();\n  \nssp.canvas.onmouseup = function (e)\n{\n    var obj   = e.target.__object__;\n    value=obj.value;\n}  \n </script>\n\n<canvas ng-mouseup=\"send({payload:action()})\" class=\"knob\" id=\"SeuilTemp\" width=\"300\" height=\"200\">\n    [No canvas support]\n</canvas>","storeOutMessages":true,"fwdInMessages":false,"x":195.99998474121094,"y":761,"wires":[["99819ccb.a46a7","1f4302e1.9fff85","e6c7e72d.58c408"]]},{"id":"99819ccb.a46a7","type":"function","z":"b3a949db.c3ae18","name":"pass thru","func":"node.status({fill:\"blue\",shape:\"dot\",text:msg.payload});\n\nreturn msg;","outputs":1,"noerr":0,"x":189.99998474121094,"y":820,"wires":[["52e4b07c.4a2108"]]},{"id":"ec38d5ce.bd1248","type":"owntracks","z":"1b2a31e6.3fb326","x":530,"y":89,"wires":[["a3d1d410.90fea"]]},{"id":"25fa3c98.e471c4","type":"json","z":"1b2a31e6.3fb326","name":"","x":342,"y":88,"wires":[["ec38d5ce.bd1248"]]},{"id":"a3d1d410.90fea","type":"debug","z":"1b2a31e6.3fb326","name":"","active":true,"console":"false","complete":"false","x":747.5,"y":89,"wires":[]},{"id":"47f3dec9.b3aa","type":"comment","z":"1b2a31e6.3fb326","name":"Message MQTT envoyé si géolocalisation dans la zone Home Work near ou Out Géofence","info":"","x":352,"y":517,"wires":[]},{"id":"aa5e11c6.cd8078","type":"comment","z":"1b2a31e6.3fb326","name":"Coordonnées géolocalisation","info":"","x":560,"y":180,"wires":[]},{"id":"c5e779de.3951a","type":"comment","z":"1b2a31e6.3fb326","name":"Message owntracks","info":"","x":541.5,"y":42,"wires":[]},{"id":"c5ed2f6e.1b97d","type":"rfx-sensor","z":"3b02cdcb.5a6722","name":"TH13/TH9/Any","port":"25338ec8.545a42","topicSource":"all","topic":"TH13/0x1E01","x":116,"y":73,"wires":[["a3654213.2d68","32b20c0a.623e9c"]]},{"id":"e566c42.db934b8","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"false","x":334,"y":180,"wires":[]},{"id":"8f98d99f.13bb78","type":"json","z":"f85d9fd7.e9798","name":"","x":670.5,"y":452,"wires":[["d16f7730.a1f518"]]},{"id":"61f62dbe.1dadd4","type":"json","z":"2f03aa46.79fcbe","name":"","x":746.5,"y":493,"wires":[["c803a781.ed8ec8"]]},{"id":"717369d.f0fb518","type":"ui_template","z":"2f03aa46.79fcbe","group":"d578210b.b94fe","name":"/Volet/Véranda MY","order":8,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Véranda MY\"}}\n</span>\n\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-my.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":114,"y":1217,"wires":[["8245528c.8c28c8","1ba5c0cf.d5f717"]]},{"id":"8245528c.8c28c8","type":"delay","z":"2f03aa46.79fcbe","name":"Delay MY","pauseType":"delay","timeout":"17","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":304,"y":1220,"wires":[["306b79cd.054546","6a95cec7.dc075"]]},{"id":"306b79cd.054546","type":"debug","z":"2f03aa46.79fcbe","name":"","active":true,"console":"false","complete":"false","x":478,"y":1159,"wires":[]},{"id":"6a95cec7.dc075","type":"function","z":"2f03aa46.79fcbe","name":"Volet-stop","func":"msg.payload = \"stop\"\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":474,"y":1218,"wires":[["1ba5c0cf.d5f717"]]},{"id":"1d6dc48f.c05663","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"false","x":328,"y":626,"wires":[]},{"id":"92ccb7a0.acf4d8","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"false","x":318,"y":1082,"wires":[]},{"id":"4903fbc9.1c74e4","type":"mqtt in","z":"3b02cdcb.5a6722","name":"Temperature DHT Sous-sol","topic":"/DHT-Sous-sol/DHT/Temperature","qos":"2","broker":"912de5b9.a94dc8","x":149,"y":4499,"wires":[["652d58c4.343d08"]]},{"id":"652d58c4.343d08","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":30,"width":"","height":"","name":"Température sous-sol","label":"Température sous-sol","format":"{{msg.payload}}","layout":"","x":461,"y":4498,"wires":[]},{"id":"7f357e9b.9bc8c","type":"comment","z":"3b02cdcb.5a6722","name":"Sous-sol","info":"\n","x":81,"y":4462,"wires":[]},{"id":"bb4fca8a.73281","type":"mqtt in","z":"3b02cdcb.5a6722","name":"Humidité DHT Sous-sol","topic":"/DHT-Sous-sol/DHT/Humidity","qos":"2","broker":"912de5b9.a94dc8","x":138,"y":4576,"wires":[["68443b80.efb794"]]},{"id":"68443b80.efb794","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":31,"width":"","height":"","name":"Humidité sous-sol","label":"Humidité sous-sol","format":"{{msg.payload}}","layout":"","x":450,"y":4575,"wires":[]},{"id":"78df05c5.14df6c","type":"mqtt out","z":"7d43a2e7.8d0b94","name":"","topic":"/P-Garage2/gpio/12","qos":"0","retain":"","broker":"912de5b9.a94dc8","x":1095,"y":515,"wires":[]},{"id":"50b51a33.561c54","type":"function","z":"7d43a2e7.8d0b94","name":"Relais down","func":"if (msg.payload == \"1\") {\n    msg.payload = \"0\";\n    } \n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":874,"y":515,"wires":[["78df05c5.14df6c","f8303b16.50769"]]},{"id":"f8303b16.50769","type":"debug","z":"7d43a2e7.8d0b94","name":"","active":true,"console":"false","complete":"false","x":1096,"y":448,"wires":[]},{"id":"c1710842.bc9ed8","type":"comment","z":"7d43a2e7.8d0b94","name":"Fonctionnement type bouton poussoir","info":"","x":667,"y":463,"wires":[]},{"id":"bc1e8273.2c1eb8","type":"delay","z":"7d43a2e7.8d0b94","name":"500ms","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":715.5,"y":515,"wires":[["50b51a33.561c54"]]},{"id":"5a19e1d7.10d03","type":"switch","z":"7d43a2e7.8d0b94","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"eq","v":"1","vt":"str"}],"checkall":"true","outputs":2,"x":567.5,"y":508,"wires":[[],["bc1e8273.2c1eb8"]]},{"id":"a81b633d.22724","type":"comment","z":"7d43a2e7.8d0b94","name":"Ouverture","info":"","x":71,"y":896,"wires":[]},{"id":"70c7b9fe.3c552","type":"comment","z":"7d43a2e7.8d0b94","name":"Test led","info":"","x":57,"y":966,"wires":[]},{"id":"28be6a46.2b5cf6","type":"mqtt in","z":"7d43a2e7.8d0b94","name":"Door contact","topic":"/P-Garage2/Door_2/Door","qos":"2","broker":"912de5b9.a94dc8","x":351,"y":767,"wires":[["b8e3a3e2.513c3"]]},{"id":"b8e3a3e2.513c3","type":"function","z":"7d43a2e7.8d0b94","name":"Ouvert-Fermé","func":"if (msg.payload == 1) {\n    msg.payload=\"ouvert\";\n    } \nelse {\n    msg.payload=\"fermé\";\n    }\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":551.5,"y":768.06005859375,"wires":[["acc70167.8b554"]]},{"id":"acc70167.8b554","type":"ui_text","z":"7d43a2e7.8d0b94","group":"97b5768b.b778f","order":2,"width":"4","height":"1","name":"","label":"Petite porte","format":"{{msg.payload}}","layout":"","x":743,"y":768,"wires":[]},{"id":"6b01d173.25c5f8","type":"comment","z":"7d43a2e7.8d0b94","name":"gpio1 : Petite porte switch","info":"","x":122,"y":768,"wires":[]},{"id":"6a6d2fe7.504a","type":"ui_switch","z":"7d43a2e7.8d0b94","name":"","label":"Activer","group":"97b5768b.b778f","order":0,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":326,"y":1110,"wires":[[]]},{"id":"b739860c.6f0578","type":"ui_switch","z":"7d43a2e7.8d0b94","name":"","label":"Géolocaliser","group":"97b5768b.b778f","order":0,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":338,"y":1164,"wires":[[]]},{"id":"4a7d5bdd.cbd83c","type":"mqtt in","z":"1b2a31e6.3fb326","name":"","topic":"owntracks/CP/CP/#","qos":"2","broker":"912de5b9.a94dc8","x":144,"y":1505,"wires":[["b40eef61.2ac2f8"]]},{"id":"f527313f.a0d4a","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":627,"y":133,"wires":[]},{"id":"a5f83dcd.85bdb8","type":"function","z":"8fda587a.42f658","name":"VR Cuisine est","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"05050201 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":364,"y":156,"wires":[["f527313f.a0d4a","678cfc90.6c16ec"]]},{"id":"53e50f00.ff78e","type":"bigtimer","z":"8fda587a.42f658","outtopic":"","outpayload1":"up","outpayload2":"down","name":"Volets up & down week hivers","lat":"49.213999","lon":"-0.400256","starttime":"5003","endtime":"5004","startoff":"-15","endoff":"+20","offs":0,"outtext1":"up","outtext2":"down","timeout":1440,"sun":false,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":false,"jan":true,"feb":true,"mar":true,"apr":true,"may":false,"jun":false,"jul":false,"aug":false,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"suspend":false,"random":false,"repeat":false,"atstart":false,"odd":false,"even":false,"x":370,"y":1740,"wires":[["449bbc05.ce67fc","ca588388.8527b8","dabf30c8.a229e8"],[],[]]},{"id":"449bbc05.ce67fc","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"payload","x":1258,"y":2374,"wires":[]},{"id":"72a7c8f0.f4f15","type":"inject","z":"8fda587a.42f658","name":"Up","topic":"on","payload":"on","payloadType":"str","repeat":"","crontab":"","once":false,"x":114,"y":1833.5,"wires":[["53e50f00.ff78e","c87a33e.bc518d","1cdeabfa.289104","328da521.eb86c2"]]},{"id":"1492e704.f7e9c1","type":"inject","z":"8fda587a.42f658","name":"Down","topic":"off","payload":"off","payloadType":"str","repeat":"","crontab":"","once":false,"x":112,"y":1874.5,"wires":[["53e50f00.ff78e","c87a33e.bc518d","1cdeabfa.289104","328da521.eb86c2"]]},{"id":"17a31845.9dc358","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/cuisine/est","topic":"/Volet/cuisine/est","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1081,"y":1700,"wires":[]},{"id":"822c14a8.e00a78","type":"comment","z":"8fda587a.42f658","name":"/Volet/cuisine/est","info":"","x":90,"y":120,"wires":[]},{"id":"49c039d4.af073","type":"inject","z":"8fda587a.42f658","name":"Auto","topic":"","payload":"auto","payloadType":"str","repeat":"","crontab":"","once":false,"x":111,"y":1911.5,"wires":[["53e50f00.ff78e","c87a33e.bc518d","1cdeabfa.289104","328da521.eb86c2"]]},{"id":"fae3b14d.a2a23","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/cuisine/est","qos":"2","broker":"912de5b9.a94dc8","x":87,"y":156,"wires":[["a5f83dcd.85bdb8"]]},{"id":"dabf30c8.a229e8","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"topic","x":1246,"y":2318,"wires":[]},{"id":"87cc1e0d.1e7e58","type":"bigtimer","z":"8fda587a.42f658","outtopic":"","outpayload1":"up","outpayload2":"","name":"Volets up only week hivers","lat":"49.213999","lon":"-0.400256","starttime":"5003","endtime":"5004","startoff":"-15","endoff":"+30","offs":0,"outtext1":"up","outtext2":"","timeout":1440,"sun":false,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":false,"jan":true,"feb":true,"mar":true,"apr":true,"may":false,"jun":false,"jul":false,"aug":false,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"suspend":false,"random":false,"repeat":false,"atstart":false,"x":378,"y":2443,"wires":[["449bbc05.ce67fc","23a361ad.087cde","6c797fa2.3557f"],[],[]]},{"id":"5813f2f7.5772ec","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":628,"y":38,"wires":[]},{"id":"d8dc2e26.083d98","type":"function","z":"8fda587a.42f658","name":"VR Cuisine nord","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"05050101 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":366,"y":57,"wires":[["5813f2f7.5772ec","16310976.8b3a9f"]]},{"id":"fe2b48ae.138ee8","type":"comment","z":"8fda587a.42f658","name":"/Volet/cuisine/nord","info":"","x":105,"y":23,"wires":[]},{"id":"105f4c13.9a9f24","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/cuisine/nord","qos":"2","broker":"912de5b9.a94dc8","x":105,"y":57,"wires":[["d8dc2e26.083d98"]]},{"id":"77403d76.c6c84c","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/cuisine/nord","topic":"/Volet/cuisine/nord","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1085,"y":1643,"wires":[]},{"id":"2b184db0.ee2952","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":625,"y":229,"wires":[]},{"id":"800dbcda.006498","type":"function","z":"8fda587a.42f658","name":"VR Cuisine sud","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"05050301 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":364,"y":249,"wires":[["2b184db0.ee2952","865dea6a.93f24"]]},{"id":"7d390248.4901cc","type":"comment","z":"8fda587a.42f658","name":"/Volet/cuisine/sud (baie vitrée)","info":"","x":127,"y":213,"wires":[]},{"id":"695d9226.f8d4b4","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/cuisine/sud","qos":"2","broker":"912de5b9.a94dc8","x":87,"y":248,"wires":[["800dbcda.006498"]]},{"id":"175287ab.e095f8","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/cuisine/sud","topic":"/Volet/cuisine/sud","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1036,"y":2516,"wires":[]},{"id":"ca5f8c51.237f4","type":"bigtimer","z":"8fda587a.42f658","outtopic":"","outpayload1":"","outpayload2":"down","name":"Volets down only été","lat":"49.213999","lon":"-0.400256","starttime":"5003","endtime":"5004","startoff":"-15","endoff":"+30","offs":0,"outtext1":"","outtext2":"down","timeout":1440,"sun":true,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":true,"jan":false,"feb":false,"mar":false,"apr":false,"may":true,"jun":true,"jul":true,"aug":true,"sep":false,"oct":false,"nov":false,"dec":false,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"suspend":false,"random":false,"repeat":false,"atstart":false,"x":327,"y":2868,"wires":[["449bbc05.ce67fc","dabf30c8.a229e8","598a6d26.8af18c"],[],[]]},{"id":"6721b90f.601ba8","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/veranda/sud2","topic":"/Volet/veranda/sud2","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1083,"y":1852.5,"wires":[]},{"id":"c4109334.0ed128","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/veranda/est1","topic":"/Volet/veranda/est1","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1072,"y":1903.5,"wires":[]},{"id":"e2581ea3.687ae","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/salledebain/nord","topic":"/Volet/salledebain/nord","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1091,"y":1956.5,"wires":[]},{"id":"9585eb48.359ce","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/veranda/sud1","topic":"/Volet/veranda/sud1","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1044,"y":2570,"wires":[]},{"id":"81b9543a.d494d","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/veranda/est2","topic":"/Volet/veranda/est2","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1031,"y":2617,"wires":[]},{"id":"3f32dc3e.173c1c","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/chambreParents/nord","topic":"/Volet/chambreParents/nord","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1094,"y":2765,"wires":[]},{"id":"204d4dd1.e4385a","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/chambreSarah/nord","topic":"/Volet/chambreSarah/nord","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1091,"y":2816,"wires":[]},{"id":"82ff054d.338c68","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/chambreSarah/est1","topic":"/Volet/chambreSarah/est1","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1081,"y":2867,"wires":[]},{"id":"7bdc6fe6.b10e5","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/chambreSarah/est2","topic":"/Volet/chambreSarah/est2","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1075,"y":2923,"wires":[]},{"id":"61a4ccc9.bec24c","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/chambreAnais/sud","topic":"/Volet/chambreAnais/sud","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1078,"y":2980,"wires":[]},{"id":"f08496ab.904d9","type":"inject","z":"8fda587a.42f658","name":"Up","topic":"on","payload":"on","payloadType":"str","repeat":"","crontab":"","once":false,"x":92,"y":2866,"wires":[["ca5f8c51.237f4","321f72d4.d733a6"]]},{"id":"aa77888.69cf478","type":"inject","z":"8fda587a.42f658","name":"Down","topic":"off","payload":"off","payloadType":"str","repeat":"","crontab":"","once":false,"x":91,"y":2907,"wires":[["ca5f8c51.237f4","321f72d4.d733a6"]]},{"id":"af538020.6750e","type":"inject","z":"8fda587a.42f658","name":"Up","topic":"on","payload":"on","payloadType":"str","repeat":"","crontab":"","once":false,"x":110,"y":2534,"wires":[["87cc1e0d.1e7e58","c39abfa.dd5e7c","18a897a2.deb208","594d55bc.734604"]]},{"id":"930c62.1b0b3ba","type":"inject","z":"8fda587a.42f658","name":"Down","topic":"off","payload":"off","payloadType":"str","repeat":"","crontab":"","once":false,"x":107,"y":2574,"wires":[["87cc1e0d.1e7e58","c39abfa.dd5e7c","18a897a2.deb208","594d55bc.734604"]]},{"id":"42389eb4.edd71","type":"inject","z":"8fda587a.42f658","name":"Auto","topic":"","payload":"auto","payloadType":"str","repeat":"","crontab":"","once":false,"x":104,"y":2616,"wires":[["87cc1e0d.1e7e58","c39abfa.dd5e7c","18a897a2.deb208","594d55bc.734604"]]},{"id":"92ada079.81ef18","type":"inject","z":"8fda587a.42f658","name":"Auto","topic":"","payload":"auto","payloadType":"str","repeat":"","crontab":"","once":false,"x":86,"y":2951,"wires":[["ca5f8c51.237f4","321f72d4.d733a6"]]},{"id":"b6e5b798.5d4aa8","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":630,"y":700,"wires":[]},{"id":"5fff454c.5b9a04","type":"function","z":"8fda587a.42f658","name":"/Volet/veranda/est1","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"05050401 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":373,"y":719,"wires":[["b6e5b798.5d4aa8","65dc3199.a12298"]]},{"id":"dfde7ba5.d78328","type":"comment","z":"8fda587a.42f658","name":"/Volet/veranda/est1 (pan fixe)","info":"","x":131,"y":683,"wires":[]},{"id":"9b4b329f.11ca6","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/veranda/est1","qos":"2","broker":"912de5b9.a94dc8","x":101,"y":718,"wires":[["5fff454c.5b9a04"]]},{"id":"a76b7ae1.4c7c7","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":633,"y":795,"wires":[]},{"id":"5c11c6d3.780b","type":"function","z":"8fda587a.42f658","name":"/Volet/veranda/est2","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"05050501 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":373,"y":816,"wires":[["a76b7ae1.4c7c7","93b30bd7.673c7"]]},{"id":"447faf2a.dbbe8","type":"comment","z":"8fda587a.42f658","name":"/Volet/veranda/est2 (pan mobile)","info":"","x":141,"y":781,"wires":[]},{"id":"7275dc61.a12964","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/veranda/est2","qos":"2","broker":"912de5b9.a94dc8","x":101,"y":815,"wires":[["5c11c6d3.780b"]]},{"id":"d04dcf94.595748","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":630,"y":889,"wires":[]},{"id":"ccd6b991.e30f58","type":"function","z":"8fda587a.42f658","name":"/Volet/veranda/sud1","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"05050601 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":383,"y":905,"wires":[["d04dcf94.595748","5a88cceb.84c364"]]},{"id":"b42973f0.c19238","type":"comment","z":"8fda587a.42f658","name":"/Volet/veranda/sud1 (pan mobile)","info":"","x":141,"y":869,"wires":[]},{"id":"adafa892.723de","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/veranda/sud1","qos":"2","broker":"912de5b9.a94dc8","x":101,"y":904,"wires":[["ccd6b991.e30f58"]]},{"id":"21bf519a.c1341e","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":630,"y":978,"wires":[]},{"id":"2cb651e3.ce8766","type":"function","z":"8fda587a.42f658","name":"/Volet/veranda/sud2","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"05050701 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":383,"y":996,"wires":[["21bf519a.c1341e","93c04ad7.f395c"]]},{"id":"553d5788.3afb18","type":"comment","z":"8fda587a.42f658","name":"/Volet/veranda/sud2 (pan fixe)","info":"","x":131,"y":960,"wires":[]},{"id":"58ef6371.95561c","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/veranda/sud2","qos":"2","broker":"912de5b9.a94dc8","x":101,"y":995,"wires":[["2cb651e3.ce8766"]]},{"id":"d211f125.984f08","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":630,"y":1080,"wires":[]},{"id":"4112a903.9bb29","type":"function","z":"8fda587a.42f658","name":"/Volet/chambreParents/nord","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"06060101 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":403,"y":1098,"wires":[["d211f125.984f08","aa30c62d.e6f5c8"]]},{"id":"6171cec6.7e2e48","type":"comment","z":"8fda587a.42f658","name":"/Volet/chambreParents/nord","info":"","x":131,"y":1062,"wires":[]},{"id":"a280fea4.32a59","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/chambreParents/nord","qos":"2","broker":"912de5b9.a94dc8","x":131,"y":1097,"wires":[["4112a903.9bb29"]]},{"id":"1e7c6ed2.35f751","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":630,"y":1170,"wires":[]},{"id":"7066fcc3.a42364","type":"function","z":"8fda587a.42f658","name":"/Volet/salledebain/nord","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"06060201 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":393,"y":1188,"wires":[["1e7c6ed2.35f751","821f1f67.3d8bc"]]},{"id":"cb6406bf.6f081","type":"comment","z":"8fda587a.42f658","name":"/Volet/salledebain/nord","info":"","x":111,"y":1152,"wires":[]},{"id":"fbd8789c.adbd18","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/salledebain/nord","qos":"2","broker":"912de5b9.a94dc8","x":111,"y":1187,"wires":[["7066fcc3.a42364"]]},{"id":"cfd00277.b231c8","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":630,"y":1264,"wires":[]},{"id":"23479a57.27fb96","type":"function","z":"8fda587a.42f658","name":"/Volet/chambreSarah/nord","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"06060301 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":403,"y":1282,"wires":[["cfd00277.b231c8","f119a5a9.3c5898"]]},{"id":"8de35564.8d186","type":"comment","z":"8fda587a.42f658","name":"/Volet/chambreSarah/nord","info":"","x":121,"y":1246,"wires":[]},{"id":"81c4602c.a2a128","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/chambreSarah/nord","qos":"2","broker":"912de5b9.a94dc8","x":121,"y":1281,"wires":[["23479a57.27fb96"]]},{"id":"449ba28d.b9e704","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":630,"y":1362,"wires":[]},{"id":"b4df478b.95d3c8","type":"function","z":"8fda587a.42f658","name":"/Volet/chambreSarah/est1","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"06060401 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":393,"y":1380,"wires":[["449ba28d.b9e704","9860282e.cddf3"]]},{"id":"b1f6847d.6d60b","type":"comment","z":"8fda587a.42f658","name":"/Volet/chambreSarah/est1","info":"","x":121,"y":1344,"wires":[]},{"id":"c17f0612.5f79e","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/chambreSarah/est1","qos":"2","broker":"912de5b9.a94dc8","x":121,"y":1379,"wires":[["b4df478b.95d3c8"]]},{"id":"59a796a4.5bae48","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":630,"y":1453,"wires":[]},{"id":"9fdbbb15.90e1e8","type":"function","z":"8fda587a.42f658","name":"/Volet/chambreSarah/est2","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"06060501 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":393,"y":1471,"wires":[["59a796a4.5bae48","741d06a9.3d5eb"]]},{"id":"31eced8b.9b3b02","type":"comment","z":"8fda587a.42f658","name":"/Volet/chambreSarah/est2","info":"","x":121,"y":1435,"wires":[]},{"id":"2455cea0.8faa92","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/chambreSarah/est2","qos":"2","broker":"912de5b9.a94dc8","x":121,"y":1470,"wires":[["9fdbbb15.90e1e8"]]},{"id":"68e692ad.58605c","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":630,"y":1542,"wires":[]},{"id":"b6f1c5ef.0800d8","type":"function","z":"8fda587a.42f658","name":"/Volet/chambreAnais/sud","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"06060601 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":393,"y":1560,"wires":[["68e692ad.58605c","aee21777.054a28"]]},{"id":"261ca710.64843","type":"comment","z":"8fda587a.42f658","name":"/Volet/chambreAnais/sud","info":"","x":121,"y":1524,"wires":[]},{"id":"88a37383.7a10c8","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/chambreAnais/sud","qos":"2","broker":"912de5b9.a94dc8","x":121,"y":1559,"wires":[["b6f1c5ef.0800d8"]]},{"id":"e9d04429.b33498","type":"comment","z":"8fda587a.42f658","name":"Automatisme : volets ouverts et fermés matin et soir","info":"","x":218,"y":1685.5,"wires":[]},{"id":"a2f50f06.18bf9","type":"comment","z":"8fda587a.42f658","name":"Automatisme : volets ouverts le  matin","info":"","x":186,"y":2372,"wires":[]},{"id":"eaec8812.efbe48","type":"comment","z":"8fda587a.42f658","name":"Automatisme : volets fermés le soir","info":"","x":168,"y":2792,"wires":[]},{"id":"ca588388.8527b8","type":"function","z":"8fda587a.42f658","name":"Répéteur","func":"for (i = 0; i < 2; i++) \n{\n    node.send(msg);\n}","outputs":1,"noerr":0,"x":707,"y":1823.5,"wires":[["eac12a35.9d6078","e51231b1.c0c3b","1dc817cb.af55e8","9d910e8d.574dd8","daa954fe.f44f38"]]},{"id":"eac12a35.9d6078","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":877,"y":1643,"wires":[["77403d76.c6c84c"]]},{"id":"e51231b1.c0c3b","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":875,"y":1701,"wires":[["17a31845.9dc358"]]},{"id":"1dc817cb.af55e8","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":871,"y":1851.5,"wires":[["6721b90f.601ba8"]]},{"id":"9d910e8d.574dd8","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":872,"y":1904.5,"wires":[["c4109334.0ed128"]]},{"id":"daa954fe.f44f38","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":872,"y":1957.5,"wires":[["e2581ea3.687ae"]]},{"id":"7eb50e59.963b5","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":851,"y":2517,"wires":[["175287ab.e095f8"]]},{"id":"23a361ad.087cde","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":852,"y":2569,"wires":[["9585eb48.359ce"]]},{"id":"b5b0692c.05541","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":851,"y":2618,"wires":[["81b9543a.d494d"]]},{"id":"56ab7802.65f3c","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":851,"y":2765,"wires":[["3f32dc3e.173c1c"]]},{"id":"1877346e.367b0c","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":848,"y":2815,"wires":[["204d4dd1.e4385a"]]},{"id":"c65554b8.c3234","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":848,"y":2867,"wires":[["82ff054d.338c68"]]},{"id":"e441cdf9.73fab","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":849,"y":2922,"wires":[["7bdc6fe6.b10e5"]]},{"id":"f7fa20ce.9f00e","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":853,"y":2979,"wires":[["61a4ccc9.bec24c"]]},{"id":"16310976.8b3a9f","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   05050101 /Volet/cuisine/nord","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":685,"y":83,"wires":[]},{"id":"678cfc90.6c16ec","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   05050201 /Volet/cuisine/est","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":676,"y":176,"wires":[]},{"id":"865dea6a.93f24","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   05050301 /Volet/cuisine/sud","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":675,"y":274,"wires":[]},{"id":"65dc3199.a12298","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   05050401 /Volet/veranda/est1","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":690,"y":743,"wires":[]},{"id":"93b30bd7.673c7","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   05050501 /Volet/veranda/est2","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":690,"y":838,"wires":[]},{"id":"5a88cceb.84c364","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   05050601 /Volet/veranda/sud1","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":688,"y":932,"wires":[]},{"id":"93c04ad7.f395c","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   05050701 /Volet/veranda/sud2","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":685,"y":1022,"wires":[]},{"id":"aa30c62d.e6f5c8","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   06060101 /Volet/chambreParents/nord","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":719,"y":1122,"wires":[]},{"id":"821f1f67.3d8bc","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   06060201 /Volet/salledebain/nord","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":697,"y":1211,"wires":[]},{"id":"f119a5a9.3c5898","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   06060301 /Volet/chambreSarah/nord","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":709,"y":1307,"wires":[]},{"id":"9860282e.cddf3","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   06060401 /Volet/chambreSarah/est1","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":707,"y":1402,"wires":[]},{"id":"741d06a9.3d5eb","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   06060501 /Volet/chambreSarah/est2","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":709,"y":1494,"wires":[]},{"id":"aee21777.054a28","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   06060601 /Volet/chambreAnais/sud","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":710,"y":1589,"wires":[]},{"id":"c80a2f1a.bfd538","type":"http request","z":"8fda587a.42f658","name":"HTTP Week-end","method":"GET","ret":"txt","url":"http://domobox:81/weekend/now","tls":"","x":298,"y":3630,"wires":[["cdf5acc3.648be"]]},{"id":"cdf5acc3.648be","type":"switch","z":"8fda587a.42f658","name":"Week-end","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"True","vt":"str"},{"t":"eq","v":"False","vt":"str"}],"checkall":"true","outputs":2,"x":517.5,"y":3630,"wires":[["7f483d0d.b63ccc"],["52eca58b.97de14"]]},{"id":"7f483d0d.b63ccc","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"payload","x":700,"y":3584,"wires":[]},{"id":"52eca58b.97de14","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"payload","x":693,"y":3657,"wires":[]},{"id":"a670f4d8.136b3","type":"inject","z":"8fda587a.42f658","name":"","topic":"","payload":"8","payloadType":"str","repeat":"","crontab":"","once":false,"x":96,"y":3631,"wires":[["c80a2f1a.bfd538","4097fc4a.ea2884"]]},{"id":"4097fc4a.ea2884","type":"http request","z":"8fda587a.42f658","name":"HTTP sunrise","method":"GET","ret":"txt","url":"http://domobox:81/sun/saint-contest/sunrise/now","tls":"","x":288,"y":3752,"wires":[["c941f5f2.648ad8"]]},{"id":"2df0c477.ef0904","type":"switch","z":"8fda587a.42f658","name":"Sunrise avant 7H","property":"payload","propertyType":"msg","rules":[{"t":"lt","v":"7","vt":"str"},{"t":"gte","v":"7","vt":"str"}],"checkall":"true","outputs":2,"x":715,"y":3753,"wires":[["10f93200.27da2e"],["a84934c9.53242"]]},{"id":"10f93200.27da2e","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"payload","x":918,"y":3731,"wires":[]},{"id":"a84934c9.53242","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"payload","x":911,"y":3788,"wires":[]},{"id":"95a07b7d.bf2e1","type":"debug","z":"8fda587a.42f658","name":"","active":false,"console":"false","complete":"payload","x":695,"y":3805,"wires":[]},{"id":"c941f5f2.648ad8","type":"function","z":"8fda587a.42f658","name":"HeureSunrise","func":"//msg.payload = msg.payload.substring( 0 , 1 );\n\n//var numval = msg.payload.value || -1;\nvar heuresunrise = parseFloat(msg.payload.substring( 0 , 1 )) || -1;\n//msg.payload = numval.toFixed(2);\nmsg.payload=heuresunrise;\nreturn msg;\n\n//heure = parseint (msg.payload);\n//heure= msg.payload.value.toFixed(2);\n//heure = parseFloat(msg.payload.toFixed(1));\n//return heure;","outputs":1,"noerr":0,"x":484.5,"y":3753,"wires":[["95a07b7d.bf2e1","2df0c477.ef0904"]]},{"id":"f45d8780.24b8b","type":"comment","z":"8fda587a.42f658","name":"Week-end","info":"","x":685,"y":3544,"wires":[]},{"id":"40a52f7f.1163c8","type":"comment","z":"8fda587a.42f658","name":"Semaine","info":"","x":686,"y":3698,"wires":[]},{"id":"c39abfa.dd5e7c","type":"bigtimer","z":"8fda587a.42f658","outtopic":"","outpayload1":"up","outpayload2":"","name":"Volets up only week-end hivers","lat":"49.213999","lon":"-0.400256","starttime":"5003","endtime":"5004","startoff":"-15","endoff":"+30","offs":0,"outtext1":"up","outtext2":"","timeout":1440,"sun":true,"mon":false,"tue":false,"wed":false,"thu":false,"fri":false,"sat":true,"jan":true,"feb":true,"mar":true,"apr":true,"may":false,"jun":false,"jul":false,"aug":false,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"suspend":false,"random":false,"repeat":false,"atstart":false,"x":382,"y":2518,"wires":[["6c797fa2.3557f"],[],[]]},{"id":"c87a33e.bc518d","type":"bigtimer","z":"8fda587a.42f658","outtopic":"","outpayload1":"up","outpayload2":"down","name":"Volets up & down week-end hivers","lat":"49.213999","lon":"-0.400256","starttime":"5003","endtime":"5004","startoff":"-15","endoff":"+20","offs":0,"outtext1":"up","outtext2":"down","timeout":1440,"sun":true,"mon":false,"tue":false,"wed":false,"thu":true,"fri":false,"sat":true,"jan":true,"feb":true,"mar":true,"apr":true,"may":false,"jun":false,"jul":false,"aug":false,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"suspend":false,"random":false,"repeat":false,"atstart":false,"odd":false,"even":false,"x":374,"y":1812.5,"wires":[["ca588388.8527b8"],[],[]]},{"id":"1cdeabfa.289104","type":"bigtimer","z":"8fda587a.42f658","outtopic":"","outpayload1":"up","outpayload2":"down","name":"Volets up & down week été","lat":"49.213999","lon":"-0.400256","starttime":"480","endtime":"5004","startoff":"0","endoff":"+40","offs":0,"outtext1":"up","outtext2":"down","timeout":1440,"sun":false,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":false,"jan":false,"feb":false,"mar":false,"apr":false,"may":true,"jun":true,"jul":true,"aug":true,"sep":false,"oct":false,"nov":false,"dec":false,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"suspend":false,"random":false,"repeat":false,"atstart":false,"odd":false,"even":false,"x":354,"y":1883.5,"wires":[["ca588388.8527b8"],[],[]]},{"id":"328da521.eb86c2","type":"bigtimer","z":"8fda587a.42f658","outtopic":"","outpayload1":"up","outpayload2":"down","name":"Volets up & down week-end été","lat":"49.213999","lon":"-0.400256","starttime":"525","endtime":"5004","startoff":"-15","endoff":"+40","offs":0,"outtext1":"up","outtext2":"down","timeout":1440,"sun":true,"mon":false,"tue":false,"wed":false,"thu":true,"fri":false,"sat":true,"jan":false,"feb":false,"mar":false,"apr":false,"may":true,"jun":true,"jul":true,"aug":true,"sep":false,"oct":false,"nov":false,"dec":false,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"suspend":false,"random":false,"repeat":false,"atstart":false,"odd":false,"even":false,"x":365,"y":1956.5,"wires":[["ca588388.8527b8"],[],[]]},{"id":"18a897a2.deb208","type":"bigtimer","z":"8fda587a.42f658","outtopic":"","outpayload1":"up","outpayload2":"","name":"Volets up only week été","lat":"49.213999","lon":"-0.400256","starttime":"480","endtime":"5004","startoff":"0","endoff":"+30","offs":0,"outtext1":"up","outtext2":"","timeout":1440,"sun":false,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":false,"jan":false,"feb":false,"mar":false,"apr":false,"may":true,"jun":true,"jul":true,"aug":true,"sep":false,"oct":false,"nov":false,"dec":false,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"suspend":false,"random":false,"repeat":false,"atstart":false,"odd":false,"even":false,"x":360,"y":2601,"wires":[["6c797fa2.3557f"],[],[]]},{"id":"594d55bc.734604","type":"bigtimer","z":"8fda587a.42f658","outtopic":"","outpayload1":"up","outpayload2":"","name":"Volets up only week-end été","lat":"49.213999","lon":"-0.400256","starttime":"480","endtime":"5004","startoff":"0","endoff":"+30","offs":0,"outtext1":"up","outtext2":"","timeout":1440,"sun":true,"mon":false,"tue":false,"wed":false,"thu":false,"fri":false,"sat":true,"jan":false,"feb":false,"mar":false,"apr":false,"may":true,"jun":true,"jul":true,"aug":true,"sep":false,"oct":false,"nov":false,"dec":false,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"suspend":false,"random":false,"repeat":false,"atstart":false,"x":364,"y":2679,"wires":[["6c797fa2.3557f"],[],[]]},{"id":"6c797fa2.3557f","type":"function","z":"8fda587a.42f658","name":"Répéteur","func":"for (i = 0; i < 2; i++) \n{\n    node.send(msg);\n}","outputs":1,"noerr":0,"x":641,"y":2562,"wires":[["7eb50e59.963b5","23a361ad.087cde","b5b0692c.05541"]]},{"id":"321f72d4.d733a6","type":"bigtimer","z":"8fda587a.42f658","outtopic":"","outpayload1":"","outpayload2":"down","name":"Volets down only hivers","lat":"49.213999","lon":"-0.400256","starttime":"5003","endtime":"5004","startoff":"-15","endoff":"+15","offs":0,"outtext1":"","outtext2":"down","timeout":1440,"sun":true,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":true,"jan":true,"feb":true,"mar":true,"apr":true,"may":false,"jun":false,"jul":false,"aug":false,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"suspend":false,"random":false,"repeat":false,"atstart":false,"odd":false,"even":false,"x":333,"y":2948,"wires":[["598a6d26.8af18c","ad8f6f80.4274e","9b4a0753.62c8d"],[],[]]},{"id":"598a6d26.8af18c","type":"function","z":"8fda587a.42f658","name":"Répéteur","func":"for (i = 0; i < 2; i++) \n{\n    node.send(msg);\n}","outputs":1,"noerr":0,"x":604,"y":2897,"wires":[["56ab7802.65f3c","1877346e.367b0c","c65554b8.c3234","e441cdf9.73fab","f7fa20ce.9f00e","5d1effcd.ea0e4","96fca2fa.60c2f","ecc7a609.332b8"]]},{"id":"a541c294.e0e0b","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":630,"y":340,"wires":[]},{"id":"a0bcf24a.404b4","type":"function","z":"8fda587a.42f658","name":"VR Salon sud","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"05050801 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":369,"y":360,"wires":[["a541c294.e0e0b","23a86971.5c4eae"]]},{"id":"b089a340.9931d8","type":"comment","z":"8fda587a.42f658","name":"/Volet/salon/sud","info":"","x":92,"y":324,"wires":[]},{"id":"6933fa1c.103f14","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/salon/sud","qos":"2","broker":"912de5b9.a94dc8","x":92,"y":359,"wires":[["a0bcf24a.404b4"]]},{"id":"23a86971.5c4eae","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   05050801 /Volet/salon/sud","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":680,"y":385,"wires":[]},{"id":"cc970a85.f088e8","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":630,"y":440,"wires":[]},{"id":"b7e4107e.9a1c38","type":"function","z":"8fda587a.42f658","name":"VR Salon ouest","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"05050901 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":369,"y":460,"wires":[["cc970a85.f088e8","f1712e05.a2158"]]},{"id":"39429034.2bde48","type":"comment","z":"8fda587a.42f658","name":"/Volet/salon/ouest","info":"","x":102,"y":424,"wires":[]},{"id":"c1e881c4.3a0118","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/salon/ouest","qos":"2","broker":"912de5b9.a94dc8","x":102,"y":459,"wires":[["b7e4107e.9a1c38"]]},{"id":"f1712e05.a2158","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   05050901 /Volet/salon/ouest","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":680,"y":485,"wires":[]},{"id":"9f6b1880.45cc38","type":"debug","z":"8fda587a.42f658","name":"","active":true,"console":"false","complete":"false","x":630,"y":540,"wires":[]},{"id":"26a38590.0bcea2","type":"function","z":"8fda587a.42f658","name":"VR Bureau ouest","func":"//msg.payload = \"down\"\n//msg.payload = \"up\"\n//msg.payload = \"stop\"\nmsg.volet = msg.payload;\nmsg.topic=\"05050A01 \";\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":379,"y":560,"wires":[["9f6b1880.45cc38","1d8bb81b.0e35d8"]]},{"id":"c8973aac.ec5c8","type":"comment","z":"8fda587a.42f658","name":"/Volet/bureau/ouest","info":"","x":102,"y":524,"wires":[]},{"id":"6a47429e.671ccc","type":"mqtt in","z":"8fda587a.42f658","name":"","topic":"/Volet/bureau/ouest","qos":"2","broker":"912de5b9.a94dc8","x":102,"y":559,"wires":[["26a38590.0bcea2"]]},{"id":"1d8bb81b.0e35d8","type":"rfx-somfy-out","z":"8fda587a.42f658","name":"   05050A01 /Volet/bureau/ouest","port":"58dfcdf2.321c14","topicSource":"msg","topic":"","x":690,"y":585,"wires":[]},{"id":"71b178f8.c50a8","type":"comment","z":"8fda587a.42f658","name":"Automatisme : volets salon My 8s sur down hivers","info":"","x":330,"y":3186,"wires":[]},{"id":"b5315600.63973","type":"comment","z":"8fda587a.42f658","name":"Automatisme : volets salon Up &  down été","info":"","x":358,"y":3229,"wires":[]},{"id":"c35b6149.3e0df8","type":"file in","z":"8bfe8608.a30018","name":"flows_vps.json","filename":"/home/pi/.node-red/flows_Domobox.json","format":"utf8","sendError":true,"x":307,"y":80,"wires":[["251be742.eb51c8"]]},{"id":"8634a88.6b056d8","type":"file","z":"8bfe8608.a30018","name":"","filename":"","appendNewline":false,"createDir":false,"overwriteFile":"true","x":656,"y":80,"wires":[]},{"id":"92e0d84a.ae02e","type":"inject","z":"8bfe8608.a30018","name":"","topic":"","payload":"restarted","payloadType":"str","repeat":"","crontab":"","once":true,"x":111,"y":103,"wires":[["c35b6149.3e0df8","66fe254b.0de084"]]},{"id":"251be742.eb51c8","type":"function","z":"8bfe8608.a30018","name":"","func":"msg.filename = \"/home/pi/backup-flow/backup_\"+(new Date().toLocaleString().replace(':', '_').replace(':', '_').replace(' ', '_').replace(/\\..+/, ''))+\"_flows_Domobox.json\";\nreturn msg;\n","outputs":1,"noerr":0,"x":517,"y":80,"wires":[["8634a88.6b056d8"]]},{"id":"66fe254b.0de084","type":"file in","z":"8bfe8608.a30018","name":"flows_vps_cred.json","filename":"/home/pi/.node-red/flows_Domobox_cred.json","format":"utf8","sendError":true,"x":325,"y":140,"wires":[["211b448f.c10664"]]},{"id":"e29afd58.0c525","type":"file","z":"8bfe8608.a30018","name":"","filename":"","appendNewline":false,"createDir":false,"overwriteFile":"true","x":656,"y":140,"wires":[]},{"id":"211b448f.c10664","type":"function","z":"8bfe8608.a30018","name":"","func":"msg.filename = \"/home/pi/backup-flow/backup_\"+(new Date().toLocaleString().replace(':', '_').replace(':', '_').replace(' ', '_').replace(/\\..+/, ''))+\"_flows_Domobox_cred.json\";\nreturn msg;\n","outputs":1,"noerr":0,"x":516,"y":140,"wires":[["e29afd58.0c525"]]},{"id":"69b858a8.d00fc","type":"ui_template","z":"af7c18b0.5a85a","group":"fe9def47.191638","name":"TPL-/Volet/salon/ouest","order":3,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet salon ouest\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":740,"y":420,"wires":[["9cec0273.f7f738","977e0c79.e9246"]]},{"id":"977e0c79.e9246","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/salon/ouest","topic":"/Volet/salon/ouest","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1033,"y":442,"wires":[]},{"id":"9cec0273.f7f738","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1012,"y":405,"wires":[]},{"id":"d7ca998f.6e4ff","type":"comment","z":"af7c18b0.5a85a","name":"Volets salon","info":"","x":710,"y":380,"wires":[]},{"id":"8daa1819.f885e","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":510,"y":460,"wires":[["977e0c79.e9246"]]},{"id":"42cde7b4.7e1168","type":"ui_template","z":"af7c18b0.5a85a","group":"fe9def47.191638","name":"TPL-/Volet/salon/sud","order":3,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet salon sud\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":740,"y":520,"wires":[["9a1208fa.2cafd","48c9a6fa.1d2e78"]]},{"id":"48c9a6fa.1d2e78","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/salon/sud","topic":"/Volet/salon/sud","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1023,"y":542,"wires":[]},{"id":"9a1208fa.2cafd","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1012,"y":505,"wires":[]},{"id":"1d8ab36e.3de725","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":510,"y":553,"wires":[["48c9a6fa.1d2e78"]]},{"id":"34a7974b.3a5fc","type":"comment","z":"af7c18b0.5a85a","name":"Volets bureau","info":"","x":709,"y":612,"wires":[]},{"id":"a37135af.a59ad8","type":"ui_template","z":"af7c18b0.5a85a","group":"d674d62a.75d3a8","name":"TPL-/Volet/bureau/ouest","order":3,"width":0,"height":0,"format":"<div layout=\"row\" layout-align=\"space-between\" style=\"padding:5px; text-align: left; margin:2px; border:2px solid white;\">\n<img class=\"lightup\" src=\"http://domobox/icones/volet-v2-1.png\" height=\"34px\"/>&nbsp;\n<span style=\"width:50%;padding-top:5px;padding-left:5px;\">{{\"Volet bureau ouest\"}}\n\n</span>\n<span style=\"width:50%; padding-top:2px;\">\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-down.png\" ng-click=\"send({payload: 'down' })\" height=\"34px\"/>&nbsp;\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-stop.png\" ng-click=\"send({payload: 'stop' })\" height=\"34px\"/>\n    <img class=\"lightup\" src=\"http://domobox/icones/volet-velux-up.png\" ng-click=\"send({payload: 'up' })\" height=\"34px\"/>&nbsp;\n</span>\n</div>","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":750,"y":648,"wires":[["6ae3eb95.9ec28c","a5c2e72b.36e2a8"]]},{"id":"a5c2e72b.36e2a8","type":"mqtt out","z":"af7c18b0.5a85a","name":"/Volet/bureau/ouest","topic":"/Volet/bureau/ouest","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1033,"y":670,"wires":[]},{"id":"6ae3eb95.9ec28c","type":"debug","z":"af7c18b0.5a85a","name":"","active":false,"console":"false","complete":"false","x":1012,"y":633,"wires":[]},{"id":"4f013b65.69a164","type":"delay","z":"af7c18b0.5a85a","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":516,"y":692,"wires":[["a5c2e72b.36e2a8"]]},{"id":"a415e96d.73f45","type":"function","z":"1b2a31e6.3fb326","name":"Home","func":"msg.payload = \"Maison\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":301,"y":662,"wires":[["b43098f1.6d9ce","60ceb56d.71256c"]]},{"id":"b43098f1.6d9ce","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/HP","topic":"presence/HP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":996,"y":719,"wires":[]},{"id":"6f2942c2.e165bc","type":"geofence","z":"1b2a31e6.3fb326","name":"Geofence Work","mode":"circle","inside":"true","rad":116.53399508589413,"points":[],"centre":{"latitude":49.179178630445506,"longitude":-0.392535924911499},"x":322,"y":805,"wires":[["99ea17c8.fb6d8"]]},{"id":"1a6323cb.6f6744","type":"geofence","z":"1b2a31e6.3fb326","name":"Geofence Home","mode":"circle","inside":"true","rad":27.672932984682546,"points":[],"centre":{"latitude":49.211506823339036,"longitude":-0.40698230266571045},"x":151,"y":1603,"wires":[["2f34f4fd.dc7a24"]]},{"id":"57317bf4.67c72c","type":"debug","z":"1b2a31e6.3fb326","name":"","active":false,"console":"false","complete":"false","x":968,"y":1158,"wires":[]},{"id":"d74a6c29.a4c048","type":"comment","z":"1b2a31e6.3fb326","name":"Message MQTT envoyé si géolocalisation dans la zone Home Work near ou Out Géofence","info":"","x":324,"y":1463,"wires":[]},{"id":"2f34f4fd.dc7a24","type":"function","z":"1b2a31e6.3fb326","name":"Home","func":"msg.payload = \"Maison\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":306,"y":1603,"wires":[["6e811130.0f3b7","14cc60ac.a134ef"]]},{"id":"6e811130.0f3b7","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/CP","topic":"presence/CP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1003,"y":1650,"wires":[]},{"id":"bf27f62f.8d6488","type":"function","z":"1b2a31e6.3fb326","name":"Work","func":"msg.payload = \"Travail\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":498,"y":1726,"wires":[["6526ed1f.49de04"]]},{"id":"3ae27742.37d53","type":"geofence","z":"1b2a31e6.3fb326","name":"Geofence Ecole","mode":"circle","inside":"true","rad":99.6431623281249,"points":[],"centre":{"latitude":49.214233175755275,"longitude":-0.3996062278747558},"x":335,"y":1726,"wires":[["bf27f62f.8d6488"]]},{"id":"b40eef61.2ac2f8","type":"function","z":"1b2a31e6.3fb326","name":"Lat-Long","func":"var loc=JSON.parse(msg.payload);\n\nif ( loc._type == \"location\" ) {\n    msg.location = {\n      lon: 0,\n      lat: 50\n    };\n\n    msg.location.lon=loc.lon;\n    msg.location.lat=loc.lat;\n    \n    return msg;\n}","outputs":1,"noerr":0,"x":319,"y":1505,"wires":[["1a6323cb.6f6744","e2c4ec34.8ef9b8","68332712.9c01","5416e1a7.c51e3","2678bf5f.4332b8"]]},{"id":"98e4a6ea.da546","type":"geofence","z":"1b2a31e6.3fb326","name":"Geofence out","mode":"circle","inside":"false","rad":1397.954970395107,"points":[],"centre":{"latitude":49.21138907525443,"longitude":-0.4066679472452961},"x":123,"y":804,"wires":[["6f2942c2.e165bc","a9acacc4.c28e28"]]},{"id":"92d29d22.cb5748","type":"function","z":"1b2a31e6.3fb326","name":"Detect Presence HP","func":"const triggers = 10;\nconst MAC = \"a0:10:81:41:7b:67\";\nvar count = context.count||0;\n\nif(msg.payload.indexOf(MAC)>0){\n    if(count < 1){\n        msg.payload = 1;\n        count = triggers;\n        context.count = count;\n        return msg;\n    }else count = triggers;\n    \n}else{\n    count -= 1;\n    if(count === 0){\n        msg.payload = 0;\n        context.count = count;\n        return msg;\n    }else if(count < 0){\n        count = 0; \n    }\n}\ncontext.count = count;\n","outputs":1,"noerr":0,"x":430,"y":1098,"wires":[["a38e2bd.fcfa058"]]},{"id":"271661a3.f7965e","type":"exec","z":"1b2a31e6.3fb326","command":"sudo arp-scan --interface=ens160 --localnet","addpay":false,"append":"","useSpawn":"","timer":"","oldrc":false,"name":"Arp-Scan","x":228,"y":1111.5,"wires":[["92d29d22.cb5748","a602f1ff.b9f338","5bf26704.3301b"],[],[]]},{"id":"423a938.c1fa46c","type":"inject","z":"1b2a31e6.3fb326","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"10","crontab":"","once":true,"x":83,"y":1112,"wires":[["271661a3.f7965e"]]},{"id":"c3762ad.97ab1d8","type":"debug","z":"1b2a31e6.3fb326","name":"","active":false,"console":"false","complete":"false","x":970,"y":1100,"wires":[]},{"id":"a602f1ff.b9f338","type":"debug","z":"1b2a31e6.3fb326","name":"","active":false,"console":"false","complete":"false","x":401,"y":1039,"wires":[]},{"id":"b19cc362.bf29a8","type":"comment","z":"1b2a31e6.3fb326","name":"Détection présence avec arp-scan du téléphone  sur réseau local en wifi. 0 : absent, 1 : présent","info":"","x":329,"y":997,"wires":[]},{"id":"a38e2bd.fcfa058","type":"switch","z":"1b2a31e6.3fb326","name":"Switch présent ?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","outputs":2,"x":656,"y":1098,"wires":[[],["a415e96d.73f45","c3762ad.97ab1d8"]]},{"id":"5bf26704.3301b","type":"function","z":"1b2a31e6.3fb326","name":"Detect Presence CP","func":"const triggers = 10;\nconst MAC = \"bc:6e:64:b0:11:a4\";\nvar count = context.count||0;\n\nif(msg.payload.indexOf(MAC)>0){\n    if(count < 1){\n        msg.payload = 1;\n        count = triggers;\n        context.count = count;\n        return msg;\n    }else count = triggers;\n    \n}else{\n    count -= 1;\n    if(count === 0){\n        msg.payload = 0;\n        context.count = count;\n        return msg;\n    }else if(count < 0){\n        count = 0; \n    }\n}\ncontext.count = count;\n","outputs":1,"noerr":0,"x":426,"y":1152,"wires":[["b3f83d51.5c4a28"]]},{"id":"b3f83d51.5c4a28","type":"switch","z":"1b2a31e6.3fb326","name":"Switch présent ?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","outputs":2,"x":651,"y":1153,"wires":[[],["2f34f4fd.dc7a24","57317bf4.67c72c"]]},{"id":"c18f6e12.9e4d6","type":"geofence","z":"1b2a31e6.3fb326","name":"Geofence near","mode":"polyline","inside":"true","rad":0,"points":[{"latitude":49.21388275327473,"longitude":-0.40434837341308594},{"latitude":49.21323796941996,"longitude":-0.40561437606811523},{"latitude":49.2122988126724,"longitude":-0.4058504104614257},{"latitude":49.211794183767346,"longitude":-0.4046487808227539},{"latitude":49.211275532024914,"longitude":-0.40524959564208984},{"latitude":49.21114937267021,"longitude":-0.40539979934692383},{"latitude":49.21070080346833,"longitude":-0.4058504104614257},{"latitude":49.21084098178113,"longitude":-0.4062795639038086},{"latitude":49.21093910636362,"longitude":-0.4065585136413574},{"latitude":49.211023212993574,"longitude":-0.4068160057067871},{"latitude":49.21123347894246,"longitude":-0.4072451591491699},{"latitude":49.211696060882055,"longitude":-0.40816783905029297},{"latitude":49.21333608924474,"longitude":-0.4079532623291015},{"latitude":49.214457444839155,"longitude":-0.40821075439453125},{"latitude":49.21552270909227,"longitude":-0.407867431640625},{"latitude":49.21613943053532,"longitude":-0.41172981262207026},{"latitude":49.213840702410145,"longitude":-0.41439056396484375},{"latitude":49.20638311678337,"longitude":-0.4119873046875},{"latitude":49.204925111448574,"longitude":-0.4081249237060547},{"latitude":49.204420407277674,"longitude":-0.4052925109863281},{"latitude":49.20453256420526,"longitude":-0.40340423583984375},{"latitude":49.20498118937177,"longitude":-0.40203094482421875},{"latitude":49.205934504336255,"longitude":-0.4001426696777344},{"latitude":49.20812145157189,"longitude":-0.3973960876464844},{"latitude":49.21081294615036,"longitude":-0.3999710083007812},{"latitude":49.21284548817323,"longitude":-0.40203094482421875}],"centre":{},"x":124,"y":726,"wires":[["b4a9b33.d35ced"]]},{"id":"b4a9b33.d35ced","type":"function","z":"1b2a31e6.3fb326","name":"Near","func":"msg.payload = \"Near\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":298,"y":726,"wires":[["b43098f1.6d9ce","60ceb56d.71256c"]]},{"id":"f66f91d3.8c6dc8","type":"inject","z":"a79eecc2.d7d75","name":"Every 30 minutes","topic":"","payload":"","payloadType":"none","repeat":"1800","crontab":"","once":true,"x":167,"y":42,"wires":[["13368808.1601f8"]]},{"id":"f3293eca.d7f81","type":"http request","z":"a79eecc2.d7d75","name":"Update DuckDNS","method":"GET","url":"https://www.duckdns.org/update?domains=http://domobox.duckdns.org&token=o.QrseFrZ72O1dja7tF8t04LuKUtDx6Sqn&ip=","tls":"","x":355,"y":274,"wires":[["164d9976.f6d8c7"]]},{"id":"164d9976.f6d8c7","type":"switch","z":"a79eecc2.d7d75","name":"Was update sucessful?","property":"payload","rules":[{"t":"eq","v":"OK"},{"t":"neq","v":"OK"}],"checkall":"true","outputs":2,"x":334,"y":329,"wires":[["39b4ca42.220f4e"],["b36f046d.47cef","cf1a2dde.acbf9"]]},{"id":"7aae0384.3ade9c","type":"delay","z":"a79eecc2.d7d75","name":"One notification/day","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","rateUnits":"day","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":340,"y":435,"wires":[["bcb3d74b.aa38e"]]},{"id":"bcb3d74b.aa38e","type":"pushbullet","z":"a79eecc2.d7d75","config":"ab14b9c2.70719","pushtype":"","title":"DuckDNS update failed","chan":"","name":"DuckDNS update failed","x":350,"y":486,"wires":[]},{"id":"292915b.2e5feea","type":"comment","z":"a79eecc2.d7d75","name":"No","info":"","x":88,"y":385,"wires":[]},{"id":"8ca6d9e5.369d3","type":"comment","z":"a79eecc2.d7d75","name":"Yes?","info":"","x":563,"y":322,"wires":[]},{"id":"b36f046d.47cef","type":"debug","z":"a79eecc2.d7d75","name":"","active":false,"console":false,"complete":false,"x":648,"y":377,"wires":[]},{"id":"39b4ca42.220f4e","type":"function","z":"a79eecc2.d7d75","name":"Reset fail counter","func":"context.duckdnsfails=0;\nreturn msg;\n","outputs":"0","x":733,"y":321,"wires":[]},{"id":"cf1a2dde.acbf9","type":"function","z":"a79eecc2.d7d75","name":"Increment fail counter, check if >5","func":"duckdnsfails = context.duckdnsfails || 0;\nduckdnsfails++;\ncontext.duckdnsfails = duckdnsfails;\n\n//Fsiled to update 5+ times?\nif(duckdnsfails <=6) {\n\treturn [msg,null];\n}\nelse {\n    //shout out last known IP\n    msg.payload=context.lastip;\n\treturn [null,msg];\n}","outputs":"2","x":301,"y":387,"wires":[[],["7aae0384.3ade9c"]]},{"id":"72baa903.71ffa8","type":"function","z":"a79eecc2.d7d75","name":"Has IP Changed?","func":"context.lastip = context.lastip || 'initial';\nvar currentip = msg.payload;\n\nif (context.lastip == 'initial') \n{\n    context.lastip = currentip;\n}\nelse if (context.lastip != currentip) \n{\n    msg.payload = currentip;\n    context.lastip = currentip;\n        \n    return msg;\n}\n    node.status({text:msg.payload});\n\n","outputs":"1","noerr":0,"x":345,"y":211.5,"wires":[["f3293eca.d7f81","fc8bb741.e8949"]]},{"id":"13368808.1601f8","type":"exec","z":"a79eecc2.d7d75","command":"wget -qO- http://ipv4bot.whatismyipaddress.com/ ; echo","addpay":false,"append":"","useSpawn":"","timer":"","oldrc":false,"name":"Check my IP - whatismyipaddress.com","x":284,"y":106.5,"wires":[["247960b6.787dd","d1c5b2e.9f684d"],[],[]]},{"id":"247960b6.787dd","type":"switch","z":"a79eecc2.d7d75","name":"Integrity check","property":"payload","rules":[{"t":"regex","v":"\\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b"},{"t":"else"}],"checkall":"true","outputs":2,"x":358,"y":160.5,"wires":[["72baa903.71ffa8","5b3677b7.205e8"],[]]},{"id":"d1c5b2e.9f684d","type":"debug","z":"a79eecc2.d7d75","name":"","active":true,"console":"false","complete":"false","x":658,"y":68,"wires":[]},{"id":"5b3677b7.205e8","type":"debug","z":"a79eecc2.d7d75","name":"","active":false,"console":"false","complete":"false","x":648,"y":122,"wires":[]},{"id":"44ba46cb.4c8d6","type":"switch","z":"d55b1279.073868","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"Connected","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":93,"y":309,"wires":[[],["ed92033f.e0117"]]},{"id":"2d3122c0.fba14e","type":"comment","z":"d55b1279.073868","name":"Connection Lost","info":"","x":179,"y":364,"wires":[]},{"id":"42b35ddc.c8b12c","type":"function","z":"1b2a31e6.3fb326","name":"Out","func":"msg.payload = \"Out\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":494,"y":1797,"wires":[["8578a85f.b2b838"]]},{"id":"f3ec3963.e8625","type":"function","z":"1b2a31e6.3fb326","name":"Near","func":"msg.payload = \"Near\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":301,"y":1659,"wires":[["6e811130.0f3b7","14cc60ac.a134ef"]]},{"id":"fc8bb741.e8949","type":"pushbullet","z":"a79eecc2.d7d75","config":"ab14b9c2.70719","pushtype":"","title":"DuckDNS update ","chan":"","name":"DuckDNS update","x":839,"y":209,"wires":[]},{"id":"9ab48410.bbb948","type":"comment","z":"a79eecc2.d7d75","name":"Notif new address","info":"","x":619,"y":211,"wires":[]},{"id":"c59dfe99.1655d","type":"comment","z":"a79eecc2.d7d75","name":"Notif DNS Update failed","info":"","x":105,"y":486,"wires":[]},{"id":"16533b13.2f186d","type":"function","z":"3b02cdcb.5a6722","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":453,"wires":[["9579a3d8.df4d"]]},{"id":"9579a3d8.df4d","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-Veranda/RFX/lastupdate","topic":"/T-Veranda/RFX/lastupdate","qos":"2","retain":"true","broker":"912de5b9.a94dc8","x":563,"y":453,"wires":[]},{"id":"e35cff7c.b3edc8","type":"comment","z":"3b02cdcb.5a6722","name":"Véranda","info":"\n","x":69,"y":251,"wires":[]},{"id":"baaa0b4e.9a005","type":"comment","z":"3b02cdcb.5a6722","name":"Salon","info":"\n","x":56,"y":686,"wires":[]},{"id":"96f37fe6.8dd0e8","type":"comment","z":"3b02cdcb.5a6722","name":"Extérieur","info":"\n","x":65,"y":1188,"wires":[]},{"id":"a245ad35.f95f9","type":"function","z":"3b02cdcb.5a6722","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":300,"y":884,"wires":[["2c187973.528036"]]},{"id":"2c187973.528036","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-Salon/RFX/lastupdate","topic":"/T-Salon/RFX/lastupdate","qos":"2","retain":"true","broker":"912de5b9.a94dc8","x":560,"y":885,"wires":[]},{"id":"c3a8fb20.9a94","type":"function","z":"3b02cdcb.5a6722","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":288,"y":1390,"wires":[["b3b5aaab.49c3f8"]]},{"id":"b3b5aaab.49c3f8","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/Exterieur/RFX/lastupdate","topic":"/Exterieur/RFX/lastupdate","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":563,"y":1389,"wires":[]},{"id":"e5c2d8c2.5be638","type":"comment","z":"1b2a31e6.3fb326","name":"Oui","info":"","x":821,"y":1080,"wires":[]},{"id":"5d2228c7.2f2228","type":"comment","z":"1b2a31e6.3fb326","name":"Oui","info":"","x":829,"y":1180,"wires":[]},{"id":"516b6b3.f699e94","type":"http in","z":"1e31eceb.bd3853","name":"Watchdog","url":"/myjs/","method":"get","upload":false,"swaggerDoc":"","x":114,"y":138,"wires":[["67b37ef3.eec07"]]},{"id":"67b37ef3.eec07","type":"template","z":"1e31eceb.bd3853","name":"Up.html page","field":"payload","fieldType":"msg","format":"html","syntax":"mustache","template":"<!DOCTYPE HTML>\n<html>\n <head>\n  <meta charset=\"utf-8\" />\n  <meta HTTP-EQUIV=\"CACHE-CONTROL\" CONTENT=\"NO-CACHE\" />\n </head>\n <body>\n Domobox UP\n </body>\n</html>","output":"str","x":431,"y":137,"wires":[["9ae0b09f.509488"]]},{"id":"9ae0b09f.509488","type":"http response","z":"1e31eceb.bd3853","name":"","statusCode":"","headers":{},"x":640,"y":136,"wires":[]},{"id":"9ce8279.e64ddd8","type":"http response","z":"1e31eceb.bd3853","name":"","x":489,"y":332,"wires":[]},{"id":"217eb197.28e30e","type":"http in","z":"1e31eceb.bd3853","name":"","url":"/myjs/","method":"get","upload":false,"swaggerDoc":"","x":113,"y":333.2333526611328,"wires":[["23ffc5cc.c87a22"]]},{"id":"23ffc5cc.c87a22","type":"template","z":"1e31eceb.bd3853","name":"Webpage Contents","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<!--\n#***************************************************************************\n# Copyright 2016 IBM\n#\n#   Building a Webpage with HTTP nodes in Node-RED\n#\n#   By JeanCarl Bisson (@dothewww)\n#   More info: https://ibm.biz/node-red-webpage/\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#***************************************************************************\n-->\n<html>\n  <head>\n    <title>Hello!</title>\n  </head>\n  <body>\n    <h1>Hello <span id=\"name\">{{payload.name}}</span>!</h1>\n    <p>This is my first webpage!</p>\n    <p><i>JeanCarl</i></p>\n    {{^payload.name}}\n    <script>\n      // Prompt visitor for their name.\n      var name = prompt('What is your name?');\n\n      // Populate HTML tag with ID name with visitor name.\n      document.getElementById('name').innerHTML = name;\n    </script>\n    {{/payload.name}}\n  </body>\n</html>\n","x":319,"y":331.76666259765625,"wires":[["9ce8279.e64ddd8"]]},{"id":"917e253c.30475","type":"comment","z":"1e31eceb.bd3853","name":"Status node-red : tester avec page HTML dynamique http://domobox:1880/myjs/","info":"","x":331,"y":83,"wires":[]},{"id":"a57b00c3.c5aea8","type":"comment","z":"1b2a31e6.3fb326","name":"Présence à la maison","info":"","x":117,"y":2080,"wires":[]},{"id":"40eb9b01.2d0e74","type":"mqtt in","z":"1b2a31e6.3fb326","name":"","topic":"presence/CP","qos":"0","broker":"912de5b9.a94dc8","x":95,"y":2240,"wires":[["22323431.8d01e4"]]},{"id":"54f2ee59.2b0748","type":"mqtt in","z":"1b2a31e6.3fb326","name":"","topic":"presence/HP","qos":"0","broker":"912de5b9.a94dc8","x":92,"y":2121,"wires":[["22323431.8d01e4"]]},{"id":"22323431.8d01e4","type":"function","z":"1b2a31e6.3fb326","name":"présent ?","func":"context.data = context.data || {};\nswitch (msg.topic)\n{\n    case \"presence/HP\" :\n      context.presenceHP = msg.payload;\n      node.status({text:msg.payload});\n      break;\n    case \"presence/CP\" :\n      context.presenceCP = msg.payload;\n      node.status({text:msg.payload});\n      break;\n}\n\nif (context.presenceHP != \"Maison\" && context.presenceCP != \"Maison\")\n{\n    presence=0;\n}\nelse\n{\n    presence=1;\n}\nmsg.payload = presence;\nnode.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":277,"y":2182,"wires":[["9c29598.2417a28","d59dc76b.7061a","1ae3e10f.bcddcf","a0cd14a3.d1f128"]]},{"id":"9c29598.2417a28","type":"debug","z":"1b2a31e6.3fb326","name":"","active":false,"console":"false","complete":"false","x":478,"y":2035,"wires":[]},{"id":"d59dc76b.7061a","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/maison","topic":"presence/maison","qos":"2","retain":"true","broker":"912de5b9.a94dc8","x":694,"y":2178,"wires":[]},{"id":"61d7b390.72ae44","type":"comment","z":"1b2a31e6.3fb326","name":"0 : Absent","info":"","x":849,"y":2151,"wires":[]},{"id":"34e4a92e.4c0436","type":"comment","z":"1b2a31e6.3fb326","name":"1 : Présent","info":"","x":848,"y":2207,"wires":[]},{"id":"68332712.9c01","type":"geofence","z":"1b2a31e6.3fb326","name":"Geofence near","mode":"polyline","inside":"true","rad":0,"points":[{"latitude":49.211822218841675,"longitude":-0.40203094482421875},{"latitude":49.211850253900046,"longitude":-0.4017305374145508},{"latitude":49.21173811357104,"longitude":-0.40181636810302734},{"latitude":49.21199042895362,"longitude":-0.4022026062011719},{"latitude":49.2122988126724,"longitude":-0.4022884368896484},{"latitude":49.212579159838256,"longitude":-0.4024171829223633},{"latitude":49.21319591800686,"longitude":-0.40340423583984375},{"latitude":49.21350429420556,"longitude":-0.40411233901977534},{"latitude":49.211275532024914,"longitude":-0.40524959564208984},{"latitude":49.21114937267021,"longitude":-0.40539979934692383},{"latitude":49.21070080346833,"longitude":-0.4058504104614257},{"latitude":49.21084098178113,"longitude":-0.4062795639038086},{"latitude":49.21093910636362,"longitude":-0.4065585136413574},{"latitude":49.211023212993574,"longitude":-0.4068160057067871},{"latitude":49.21123347894246,"longitude":-0.4072451591491699},{"latitude":49.211696060882055,"longitude":-0.40816783905029297},{"latitude":49.21333608924474,"longitude":-0.4079532623291015},{"latitude":49.214457444839155,"longitude":-0.40821075439453125},{"latitude":49.21552270909227,"longitude":-0.407867431640625},{"latitude":49.21613943053532,"longitude":-0.41172981262207026},{"latitude":49.213840702410145,"longitude":-0.41439056396484375},{"latitude":49.20638311678337,"longitude":-0.4119873046875},{"latitude":49.204925111448574,"longitude":-0.4081249237060547},{"latitude":49.204420407277674,"longitude":-0.4052925109863281},{"latitude":49.20453256420526,"longitude":-0.40340423583984375},{"latitude":49.20498118937177,"longitude":-0.40203094482421875},{"latitude":49.205934504336255,"longitude":-0.4001426696777344},{"latitude":49.20812145157189,"longitude":-0.3973960876464844},{"latitude":49.21081294615036,"longitude":-0.3999710083007812},{"latitude":49.21204649886376,"longitude":-0.4022026062011719}],"centre":{},"x":142,"y":1659,"wires":[["f3ec3963.e8625"]]},{"id":"5416e1a7.c51e3","type":"geofence","z":"1b2a31e6.3fb326","name":"Geofence out","mode":"polyline","inside":"false","rad":0,"points":[{"latitude":49.2024015390802,"longitude":-0.399627685546875},{"latitude":49.20457742622053,"longitude":-0.3864612558390945},{"latitude":49.21142972635457,"longitude":-0.3908729553222656},{"latitude":49.2127754019084,"longitude":-0.3989410400390625},{"latitude":49.21372856659632,"longitude":-0.40301799774169916},{"latitude":49.21815773782178,"longitude":-0.4065799713134765},{"latitude":49.21781014564613,"longitude":-0.4194202402140945},{"latitude":49.2015491026317,"longitude":-0.417360303690657}],"centre":{},"x":136,"y":1725,"wires":[["3ae27742.37d53","42b35ddc.c8b12c","bdf267b.22d5018"]]},{"id":"1ae3e10f.bcddcf","type":"function","z":"1b2a31e6.3fb326","name":"Index ES write","func":"d=new Date();\nmadate=d.toJSON()\nmyTemp = context.global.myTemperatureExt;\nmsg.payload = \"{\\\"date\\\":\\\"\" + madate + \"\\\", \\\"source\\\":\\\"presence\\\", \\\"maison\\\":\" + msg.payload + \"}\";\n\nreturn msg;","outputs":1,"noerr":0,"x":534,"y":2295,"wires":[["948b55fb.739968","28acd4a0.aae8bc"]]},{"id":"28acd4a0.aae8bc","type":"json","z":"1b2a31e6.3fb326","name":"","x":703,"y":2295,"wires":[["3c8d5abb.79e37e"]]},{"id":"948b55fb.739968","type":"debug","z":"1b2a31e6.3fb326","name":"","active":false,"console":"false","complete":"false","x":726,"y":2342,"wires":[]},{"id":"3c8d5abb.79e37e","type":"http request","z":"1b2a31e6.3fb326","name":"Save Data","method":"POST","ret":"obj","url":"http://graylog:9200/my_sonde/sonde/{{{msg.payload}}}","tls":"","x":861,"y":2295,"wires":[["aa4fb560.5e4cb"]]},{"id":"aa4fb560.5e4cb","type":"debug","z":"1b2a31e6.3fb326","name":"","active":false,"console":"false","complete":"false","x":1029,"y":2293.5,"wires":[]},{"id":"e08b21c7.bc376","type":"inject","z":"1b2a31e6.3fb326","name":"","topic":"Test ES Write","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":307,"y":2294,"wires":[["1ae3e10f.bcddcf"]]},{"id":"ac88406f.faa538","type":"inject","z":"3b02cdcb.5a6722","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":133,"y":1662,"wires":[["573f1754.ce78b8"]]},{"id":"1f719e03.42bbc2","type":"function","z":"1b2a31e6.3fb326","name":"Home Distance","func":"// latFrom et lonFrom : domicile\nvar latFrom = 49.21144409999999;\nvar lonFrom = -0.4065946000000622;\nvar latTo = msg.payload.lat;\nvar lonTo = msg.payload.lon;\n\nmsg.distance = \"http://domobox/geodistance/geodistance.php?latFrom=\"+latFrom+\"&lonFrom=\"+lonFrom+\"&latTo=\"+latTo+\"&lonTo=\"+lonTo;\nmsg.url = msg.distance;\n    node.status({text:msg.url});\nreturn msg;\n","outputs":"1","noerr":0,"x":313,"y":429,"wires":[["2780061e.74dc9a"]]},{"id":"99ea17c8.fb6d8","type":"function","z":"1b2a31e6.3fb326","name":"Work","func":"msg.payload = \"Travail\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":490,"y":806,"wires":[["348bdf52.0322e8"]]},{"id":"a9acacc4.c28e28","type":"function","z":"1b2a31e6.3fb326","name":"Out","func":"msg.payload = \"Out\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":490,"y":860,"wires":[["ee6f6868.402d38"]]},{"id":"348bdf52.0322e8","type":"delay","z":"1b2a31e6.3fb326","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":635,"y":806,"wires":[["ee6f6868.402d38"]]},{"id":"8578a85f.b2b838","type":"delay","z":"1b2a31e6.3fb326","name":"","pauseType":"delay","timeout":"50","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":770,"y":1797,"wires":[["14cc60ac.a134ef","6e811130.0f3b7"]]},{"id":"6526ed1f.49de04","type":"delay","z":"1b2a31e6.3fb326","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":649,"y":1725,"wires":[["8578a85f.b2b838"]]},{"id":"c9988e44.d18428","type":"debug","z":"1b2a31e6.3fb326","name":"","active":false,"console":"false","complete":"false","x":862,"y":343,"wires":[]},{"id":"2e0c730e.164304","type":"debug","z":"1b2a31e6.3fb326","name":"","active":false,"console":"false","complete":"false","x":326,"y":559,"wires":[]},{"id":"7c92a8c.c03ded8","type":"json","z":"1b2a31e6.3fb326","name":"","pretty":false,"x":147,"y":429,"wires":[["1f719e03.42bbc2"]]},{"id":"f48e692e.75cfa8","type":"http request","z":"1b2a31e6.3fb326","name":"","method":"GET","ret":"txt","url":"","tls":"","x":673,"y":429,"wires":[["c9988e44.d18428","9b55e5b.d779f18","f5bca420.4ebc98"]]},{"id":"2780061e.74dc9a","type":"change","z":"1b2a31e6.3fb326","name":"","rules":[{"t":"set","p":"query","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":501,"y":429,"wires":[["f48e692e.75cfa8"]]},{"id":"9b55e5b.d779f18","type":"mqtt out","z":"1b2a31e6.3fb326","name":"distance/HP","topic":"distance/HP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":856,"y":416,"wires":[]},{"id":"331bbaef.1b1036","type":"comment","z":"1b2a31e6.3fb326","name":"Message MQTT distance HP domicile","info":"","x":192,"y":391,"wires":[]},{"id":"dbe716b3.f326a","type":"function","z":"1b2a31e6.3fb326","name":"Home Distance","func":"// latFrom et lonFrom : domicile\nvar latFrom = 49.21144409999999;\nvar lonFrom = -0.4065946000000622;\nvar latTo = msg.payload.lat;\nvar lonTo = msg.payload.lon;\n\nmsg.distance = \"http://domobox/geodistance/geodistance.php?latFrom=\"+latFrom+\"&lonFrom=\"+lonFrom+\"&latTo=\"+latTo+\"&lonTo=\"+lonTo;\nmsg.url = msg.distance;\n    node.status({text:msg.url});\nreturn msg;\n","outputs":"1","noerr":0,"x":309,"y":1327,"wires":[["ea28b92e.980d98"]]},{"id":"9b9fc36e.b860f8","type":"debug","z":"1b2a31e6.3fb326","name":"","active":false,"console":"false","complete":"false","x":848,"y":1294,"wires":[]},{"id":"2678bf5f.4332b8","type":"json","z":"1b2a31e6.3fb326","name":"","pretty":false,"x":143,"y":1327,"wires":[["dbe716b3.f326a"]]},{"id":"4276c4eb.4b0d34","type":"http request","z":"1b2a31e6.3fb326","name":"","method":"GET","ret":"txt","url":"","tls":"","x":669,"y":1327,"wires":[["9b9fc36e.b860f8","1904c93d.64e7a7","f07e7623.9a6bc8"]]},{"id":"ea28b92e.980d98","type":"change","z":"1b2a31e6.3fb326","name":"","rules":[{"t":"set","p":"query","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":497,"y":1327,"wires":[["4276c4eb.4b0d34"]]},{"id":"1904c93d.64e7a7","type":"mqtt out","z":"1b2a31e6.3fb326","name":"distance/CP","topic":"distance/CP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":850,"y":1382,"wires":[]},{"id":"c785c0c4.c5563","type":"comment","z":"1b2a31e6.3fb326","name":"Message MQTT distance CP domicile","info":"","x":188,"y":1289,"wires":[]},{"id":"ee6f6868.402d38","type":"delay","z":"1b2a31e6.3fb326","name":"","pauseType":"delay","timeout":"50","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":790,"y":860,"wires":[["b43098f1.6d9ce","60ceb56d.71256c"]]},{"id":"8ee028bb.0903b8","type":"mqtt in","z":"1b2a31e6.3fb326","name":"owntracks/+/+/event","topic":"owntracks/+/+/event","qos":"2","broker":"912de5b9.a94dc8","x":128,"y":2745,"wires":[["929397f.b341768","d97f91c5.1076c8"]]},{"id":"929397f.b341768","type":"debug","z":"1b2a31e6.3fb326","name":"","active":true,"complete":false,"x":579.9999847412109,"y":2684.0000076293945,"wires":[]},{"id":"d1a43007.efb15","type":"mqtt in","z":"1b2a31e6.3fb326","name":"WayPoints Home Smartphone","topic":"owntracks/+/+/event","qos":"2","broker":"912de5b9.a94dc8","x":157,"y":2687.083251953125,"wires":[["929397f.b341768","d97f91c5.1076c8"]]},{"id":"d7221290.fe24f","type":"inject","z":"1b2a31e6.3fb326","name":"Test Domicile shared enter","topic":"","payload":"{\"_type\": \"transition\", \"tid\":\"HP\",\"lat\": \"49.213999\", \"lon\": \"-0.400256\", \"tst\": \"1505580540\", \"acc\": \"500.0\", \"batt\": \"48\", \"desc\": \"Domicile\", \"event\": \"enter\"}","payloadType":"str","repeat":"","crontab":"","once":false,"x":163,"y":2801,"wires":[["d97f91c5.1076c8"]]},{"id":"56a5209f.1ba648","type":"inject","z":"1b2a31e6.3fb326","name":"Test Private Waypoint Tour Eiffel","topic":"","payload":"{\"_type\": \"transition\", \"lat\": \"48.858844\", \"lon\": \"2.294351\", \"tst\": \"1391715492\", \"acc\": \"500.0\", \"batt\": \"48\", \"event\": \"enter\"}","payloadType":"str","repeat":"","crontab":"","once":false,"x":177,"y":2898,"wires":[["d97f91c5.1076c8"]]},{"id":"42ae5f4b.77cc5","type":"comment","z":"1b2a31e6.3fb326","name":"Message owntracks entrée et sortie de region domicile (waypoint)","info":"","x":255,"y":2598,"wires":[]},{"id":"39dc5c90.16ba9c","type":"switch","z":"1b2a31e6.3fb326","name":"Domicile ?","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"Domicile","vt":"str"}],"checkall":"true","outputs":1,"x":558,"y":2777,"wires":[["20a26304.dff9e4"]]},{"id":"20a26304.dff9e4","type":"switch","z":"1b2a31e6.3fb326","name":"enter/leave ?","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"enter","vt":"str"},{"t":"cont","v":"leave","vt":"str"}],"checkall":"true","outputs":2,"x":750,"y":2777,"wires":[["d7049dfb.b3c81","323c0640.47390a"],["f0908222.d5412","323c0640.47390a"]]},{"id":"e0816d32.e77e2","type":"comment","z":"1b2a31e6.3fb326","name":"Message owntracks connexion wifi en dehors du domicile : Out ---- au domicile : Maison","info":"","x":310,"y":3285,"wires":[]},{"id":"d97f91c5.1076c8","type":"function","z":"1b2a31e6.3fb326","name":"transition ?","func":"// The received message is stored in 'msg'\n// It will have at least a 'payload' property:\n//   console.log(msg.payload);\n// The 'context' object is available to store state\n// between invocations of the function\n//   context = {};\n\ndata = JSON.parse(msg.payload);\n\nif ( (data._type == \"transition\") && (data.event !== undefined ) ) {\n\t    \n    return msg;\n }","outputs":1,"noerr":0,"x":394,"y":2778,"wires":[["39dc5c90.16ba9c"]]},{"id":"c3d63867.9eafc","type":"inject","z":"1b2a31e6.3fb326","name":"Test Domicile shared leave","topic":"","payload":"{\"_type\": \"transition\" ,\"tid\":\"CP\", \"lat\": \"49.213999\", \"lon\": \"-0.400256\", \"tst\": \"1391715492\", \"acc\": \"500.0\", \"batt\": \"48\", \"desc\": \"Domicile\", \"event\": \"leave\"}","payloadType":"str","repeat":"","crontab":"","once":false,"x":161,"y":2847,"wires":[["d97f91c5.1076c8"]]},{"id":"323c0640.47390a","type":"debug","z":"1b2a31e6.3fb326","name":"","active":true,"complete":false,"x":650,"y":2877,"wires":[]},{"id":"d7049dfb.b3c81","type":"switch","z":"1b2a31e6.3fb326","name":"tid ?","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"CP","vt":"str"},{"t":"cont","v":"HP","vt":"str"},{"t":"cont","v":"AP","vt":"str"},{"t":"cont","v":"SP","vt":"str"}],"checkall":"true","outputs":4,"x":949,"y":2668,"wires":[["d59dd590.d1e67","b76961f9.f5fe98"],["1b1b736f.cf288d","7a4758b6.b8953"],["14ce65c2.f55c62","8815f058.f1ff2"],["2505dffa.a9197","bcd3023a.8b4a4"]]},{"id":"f0908222.d5412","type":"switch","z":"1b2a31e6.3fb326","name":"tid ?","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"CP","vt":"str"},{"t":"cont","v":"HP","vt":"str"},{"t":"cont","v":"AP","vt":"str"},{"t":"cont","v":"SP","vt":"str"}],"checkall":"true","outputs":4,"x":958,"y":3079,"wires":[["1ba3c2d5.c69015","b76961f9.f5fe98"],["a146829e.e03de","7a4758b6.b8953"],["6e999de8.6ce3dc","8815f058.f1ff2"],["285cfb50.dcf53c","bcd3023a.8b4a4"]]},{"id":"d59dd590.d1e67","type":"function","z":"1b2a31e6.3fb326","name":"Home","func":"msg.payload = \"Maison\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":1092,"y":2598,"wires":[["96ded761.8d12e8"]]},{"id":"1ba3c2d5.c69015","type":"function","z":"1b2a31e6.3fb326","name":"Out","func":"msg.payload = \"Out\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":1090,"y":3009,"wires":[["c0c2186f.164c48"]]},{"id":"96ded761.8d12e8","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/CP","topic":"presence/HP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1245,"y":2597,"wires":[]},{"id":"d4e74d64.543b9","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/HP","topic":"presence/HP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1242,"y":2645,"wires":[]},{"id":"a862a794.41cfa8","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/AP","topic":"presence/AP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1243,"y":2692,"wires":[]},{"id":"7cdc9738.00a668","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/SP","topic":"presence/SP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1246,"y":2740,"wires":[]},{"id":"1b1b736f.cf288d","type":"function","z":"1b2a31e6.3fb326","name":"Home","func":"msg.payload = \"Maison\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":1092,"y":2645,"wires":[["d4e74d64.543b9"]]},{"id":"14ce65c2.f55c62","type":"function","z":"1b2a31e6.3fb326","name":"Home","func":"msg.payload = \"Maison\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":1091,"y":2692,"wires":[["a862a794.41cfa8"]]},{"id":"2505dffa.a9197","type":"function","z":"1b2a31e6.3fb326","name":"Home","func":"msg.payload = \"Maison\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":1093,"y":2740,"wires":[["7cdc9738.00a668"]]},{"id":"a146829e.e03de","type":"function","z":"1b2a31e6.3fb326","name":"Out","func":"msg.payload = \"Out\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":1091,"y":3056,"wires":[["1d80df76.263131"]]},{"id":"6e999de8.6ce3dc","type":"function","z":"1b2a31e6.3fb326","name":"Out","func":"msg.payload = \"Out\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":1090,"y":3102,"wires":[["a3827716.1e1aa8"]]},{"id":"285cfb50.dcf53c","type":"function","z":"1b2a31e6.3fb326","name":"Out","func":"msg.payload = \"Out\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":1089,"y":3149,"wires":[["40c8f29f.583c5c"]]},{"id":"c0c2186f.164c48","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/CP","topic":"presence/HP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1246,"y":3009,"wires":[]},{"id":"1d80df76.263131","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/HP","topic":"presence/HP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1243,"y":3056,"wires":[]},{"id":"a3827716.1e1aa8","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/AP","topic":"presence/AP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1244,"y":3102,"wires":[]},{"id":"40c8f29f.583c5c","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/SP","topic":"presence/SP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1247,"y":3149,"wires":[]},{"id":"2403aa92.affd56","type":"comment","z":"1b2a31e6.3fb326","name":"enter","info":"","x":830,"y":2700,"wires":[]},{"id":"1a9e3b0a.20031d","type":"comment","z":"1b2a31e6.3fb326","name":"leave","info":"","x":870,"y":2900,"wires":[]},{"id":"ca12ba47.19a048","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/CP/lastupdate","topic":"presence/CP/lastupdate","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1284,"y":2801,"wires":[]},{"id":"b76961f9.f5fe98","type":"function","z":"1b2a31e6.3fb326","name":"Date tst","func":"data = JSON.parse(msg.payload);\nvar MaDate = new Date(parseInt(data.tst)*1000);\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\n\nreturn msg;","outputs":1,"noerr":0,"x":1099,"y":2801,"wires":[["ca12ba47.19a048"]]},{"id":"7a4758b6.b8953","type":"function","z":"1b2a31e6.3fb326","name":"Date tst","func":"data = JSON.parse(msg.payload);\nvar MaDate = new Date(parseInt(data.tst)*1000);\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\n\nreturn msg;","outputs":1,"noerr":0,"x":1099,"y":2847,"wires":[["46cc20bc.cf467"]]},{"id":"46cc20bc.cf467","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/HP/lastupdate","topic":"presence/HP/lastupdate","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1284,"y":2847,"wires":[]},{"id":"8815f058.f1ff2","type":"function","z":"1b2a31e6.3fb326","name":"Date tst","func":"data = JSON.parse(msg.payload);\nvar MaDate = new Date(parseInt(data.tst)*1000);\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\n\nreturn msg;","outputs":1,"noerr":0,"x":1099,"y":2896,"wires":[["8c5bea9c.edf17"]]},{"id":"8c5bea9c.edf17","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/AP/lastupdate","topic":"presence/AP/lastupdate","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1284,"y":2896,"wires":[]},{"id":"bcd3023a.8b4a4","type":"function","z":"1b2a31e6.3fb326","name":"Date tst","func":"data = JSON.parse(msg.payload);\nvar MaDate = new Date(parseInt(data.tst)*1000);\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\n\nreturn msg;","outputs":1,"noerr":0,"x":1100,"y":2941,"wires":[["65fdc786.74cd3"]]},{"id":"65fdc786.74cd3","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/SP/lastupdate","topic":"presence/SP/lastupdate","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1286,"y":2941,"wires":[]},{"id":"e19fa868.cf86e8","type":"mqtt in","z":"1b2a31e6.3fb326","name":"owntracks/+/+","topic":"owntracks/+/+","qos":"2","broker":"912de5b9.a94dc8","x":79,"y":3370,"wires":[["6a987748.f9b68","b15eede0.bb886","56901aee.eaf384"]]},{"id":"6a987748.f9b68","type":"function","z":"1b2a31e6.3fb326","name":"location wifi","func":"// The received message is stored in 'msg'\n// It will have at least a 'payload' property:\n//   console.log(msg.payload);\n// The 'context' object is available to store state\n// between invocations of the function\n//   context = {};\n\ndata = JSON.parse(msg.payload);\n\nif ( data._type == \"location\")  {\n    if (data.conn == \"w\") {\n        // connexion wifi\n        msg.payload = 1;\n        return msg;\n    }\n    else {\n        msg.payload = 0;\n        return msg;\n    }\n }","outputs":1,"noerr":0,"x":163,"y":3434,"wires":[["cd8e4f7.bdefeb"]]},{"id":"cd8e4f7.bdefeb","type":"switch","z":"1b2a31e6.3fb326","name":"Switch wifi?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","outputs":2,"x":270,"y":3376,"wires":[[],["5c2dfead.eff","cf759c3b.4994a"]]},{"id":"b7d28676.3c6d8","type":"comment","z":"1b2a31e6.3fb326","name":"Oui","info":"","x":310,"y":3420,"wires":[]},{"id":"e3567150.f0fc6","type":"debug","z":"1b2a31e6.3fb326","name":"","active":false,"console":"false","complete":"false","x":841,"y":3265,"wires":[]},{"id":"f45a3697.5d21e8","type":"switch","z":"1b2a31e6.3fb326","name":"Switch wifi local?","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"41:7b:67","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":745,"y":3362,"wires":[["e1a8992d.5089c","e3567150.f0fc6","73bfba96.9034bc"],["e1a8992d.5089c","4f001fc3.50f44"]]},{"id":"b222ec2.81b129","type":"comment","z":"1b2a31e6.3fb326","name":"Oui","info":"","x":803,"y":3322,"wires":[]},{"id":"73bfba96.9034bc","type":"function","z":"1b2a31e6.3fb326","name":"Home","func":"msg.payload = \"Maison\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":949,"y":3310,"wires":[["af80175d.1889c"]]},{"id":"af80175d.1889c","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/HP","topic":"presence/HP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1095,"y":3310,"wires":[]},{"id":"37dfcd09.1595da","type":"function","z":"1b2a31e6.3fb326","name":"Out","func":"msg.payload = \"Out\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":943,"y":3415,"wires":[["ca2eff87.bb9a58"]]},{"id":"ca2eff87.bb9a58","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/HP","topic":"presence/HP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1096,"y":3414,"wires":[]},{"id":"16991b2f.b30d25","type":"comment","z":"1b2a31e6.3fb326","name":"Non","info":"","x":800,"y":3407,"wires":[]},{"id":"e1a8992d.5089c","type":"function","z":"1b2a31e6.3fb326","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":945,"y":3361,"wires":[["89a5e86c.62d72"]]},{"id":"89a5e86c.62d72","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/HP/lastupdate","topic":"presence/HP/lastupdate","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1139,"y":3361,"wires":[]},{"id":"540ec140.c173b","type":"switch","z":"1b2a31e6.3fb326","name":"Switch wifi local?","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"b0:11:a4","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":772,"y":3672,"wires":[["4618a2f0.552d3c","76ab2654.adc1f8","280ad9ca.26f9ce"],["4618a2f0.552d3c","5941f8d6.7b0cb8"]]},{"id":"4f94ded7.f8976","type":"comment","z":"1b2a31e6.3fb326","name":"Oui","info":"","x":833,"y":3628,"wires":[]},{"id":"280ad9ca.26f9ce","type":"function","z":"1b2a31e6.3fb326","name":"Home","func":"msg.payload = \"Maison\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":969,"y":3624,"wires":[["7e4c7f38.151398"]]},{"id":"7e4c7f38.151398","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/CP","topic":"presence/CP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1115,"y":3624,"wires":[]},{"id":"787fd64e.0651f","type":"function","z":"1b2a31e6.3fb326","name":"Out","func":"msg.payload = \"Out\";\n    node.status({text:msg.payload});\nreturn msg;","outputs":"1","noerr":0,"x":974,"y":3725,"wires":[["61a6eeae.c205"]]},{"id":"61a6eeae.c205","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/CP","topic":"presence/CP","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1127,"y":3724,"wires":[]},{"id":"283535.472f02cc","type":"comment","z":"1b2a31e6.3fb326","name":"Non","info":"","x":851,"y":3712,"wires":[]},{"id":"4618a2f0.552d3c","type":"function","z":"1b2a31e6.3fb326","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":972,"y":3671,"wires":[["2d329530.211c22"]]},{"id":"2d329530.211c22","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/CP/lastupdate","topic":"presence/CP/lastupdate","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1166,"y":3671,"wires":[]},{"id":"5c2dfead.eff","type":"exec","z":"1b2a31e6.3fb326","command":"sudo arp-scan --retry 10 --quiet --interface=ens160 --localnet | grep  -s -i \"41:7b:67\"","addpay":false,"append":"","useSpawn":"","timer":"","oldrc":false,"name":"Check HP on Home wifi","x":502,"y":3375,"wires":[["f45a3697.5d21e8"],[],[]]},{"id":"f5bca420.4ebc98","type":"function","z":"1b2a31e6.3fb326","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":835,"y":485,"wires":[["248aeed.d27cd92"]]},{"id":"248aeed.d27cd92","type":"mqtt out","z":"1b2a31e6.3fb326","name":"distance/HP/lastupdate","topic":"distance/HP/lastupdate","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1042,"y":485,"wires":[]},{"id":"f07e7623.9a6bc8","type":"function","z":"1b2a31e6.3fb326","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":829,"y":1447,"wires":[["260a81d4.0a76be"]]},{"id":"260a81d4.0a76be","type":"mqtt out","z":"1b2a31e6.3fb326","name":"distance/CP/lastupdate","topic":"distance/CP/lastupdate","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1036,"y":1447,"wires":[]},{"id":"60ceb56d.71256c","type":"function","z":"1b2a31e6.3fb326","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":829,"y":637,"wires":[["13c2acb7.0089eb"]]},{"id":"13c2acb7.0089eb","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/HP/lastupdate","topic":"presence/HP/lastupdate","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1036,"y":637,"wires":[]},{"id":"14cc60ac.a134ef","type":"function","z":"1b2a31e6.3fb326","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":831,"y":1586,"wires":[["bb1af662.fbcbc"]]},{"id":"bb1af662.fbcbc","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/CP/lastupdate","topic":"presence/CP/lastupdate","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":1038,"y":1586,"wires":[]},{"id":"a0cd14a3.d1f128","type":"function","z":"1b2a31e6.3fb326","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":506,"y":2101,"wires":[["d38e9bd0.51a96"]]},{"id":"d38e9bd0.51a96","type":"mqtt out","z":"1b2a31e6.3fb326","name":"presence/maison/lastupdate","topic":"presence/maison/lastupdate","qos":"0","retain":"true","broker":"912de5b9.a94dc8","x":723,"y":2101,"wires":[]},{"id":"cf759c3b.4994a","type":"exec","z":"1b2a31e6.3fb326","command":"sudo arp-scan --retry 10 --quiet --interface=ens160 --localnet | grep  -s -i \"b0:11:a4\"","addpay":false,"append":"","useSpawn":"","timer":"","oldrc":false,"name":"Check CP on Home wifi","x":508,"y":3685,"wires":[["540ec140.c173b"],[],[]]},{"id":"76ab2654.adc1f8","type":"debug","z":"1b2a31e6.3fb326","name":"","active":false,"console":"false","complete":"false","x":908,"y":3578,"wires":[]},{"id":"2b8ddabf.d8c83e","type":"delay","z":"3b02cdcb.5a6722","name":"","pauseType":"rate","timeout":"1","timeoutUnits":"hours","rate":"1","nbRateUnits":"10","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":135,"y":1592,"wires":[["573f1754.ce78b8"]]},{"id":"c12c4ce3.f90148","type":"delay","z":"2f03aa46.79fcbe","name":"","pauseType":"rate","timeout":"1","timeoutUnits":"hours","rate":"1","nbRateUnits":"10","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":373,"y":492,"wires":[["526f14de.1295dc"]]},{"id":"47cf1a2a.6e70ac","type":"delay","z":"f85d9fd7.e9798","name":"","pauseType":"rate","timeout":"1","timeoutUnits":"hours","rate":"1","nbRateUnits":"10","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":313,"y":452,"wires":[["3b2ecad1.92b3e6"]]},{"id":"b15eede0.bb886","type":"function","z":"1b2a31e6.3fb326","name":"niveau batterie HP","func":"data = JSON.parse(msg.payload);\n\nif ( data._type == \"location\")  {\n    if ( data.tid == \"HP\")  {\n        // niveau batterie\n        msg.payload = parseInt(data.batt);\n            node.status({text:msg.payload});\n        return msg;\n    }\n }","outputs":1,"noerr":0,"x":135,"y":4015,"wires":[["42c196d6.d3cc3"]]},{"id":"56901aee.eaf384","type":"function","z":"1b2a31e6.3fb326","name":"niveau batterie CP","func":"data = JSON.parse(msg.payload);\n\nif ( data._type == \"location\")  {\n    if ( data.tid == \"CP\")  {\n        // niveau batterie\n        msg.payload = parseInt(data.batt);\n            node.status({text:msg.payload});\n        return msg;\n    }\n }","outputs":1,"noerr":0,"x":115,"y":4292,"wires":[["448ac964.32d6f8"]]},{"id":"5941f8d6.7b0cb8","type":"switch","z":"1b2a31e6.3fb326","name":"battCP > 10","property":"battCP","propertyType":"global","rules":[{"t":"gt","v":"10","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":784,"y":3805,"wires":[["787fd64e.0651f"],[]]},{"id":"42c196d6.d3cc3","type":"function","z":"1b2a31e6.3fb326","name":"Global var battHP","func":"context.global.battHP=msg.payload;\nmsg.payload = context.global.battHP;\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":344,"y":4014,"wires":[["f94811bc.6b2d48"]]},{"id":"448ac964.32d6f8","type":"function","z":"1b2a31e6.3fb326","name":"Global var battCP","func":"context.global.battCP=msg.payload;\nmsg.payload = context.global.battCP;\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":323,"y":4292,"wires":[["63415867.0f83e"]]},{"id":"4f001fc3.50f44","type":"switch","z":"1b2a31e6.3fb326","name":"battHP > 10","property":"battHP","propertyType":"global","rules":[{"t":"gt","v":"10","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":755,"y":3489,"wires":[["37dfcd09.1595da"],[]]},{"id":"7199f444.575be4","type":"comment","z":"1b2a31e6.3fb326","name":"Oui","info":"","x":879,"y":3456,"wires":[]},{"id":"6082d43b.a2bf1c","type":"comment","z":"1b2a31e6.3fb326","name":"Oui","info":"","x":914,"y":3776,"wires":[]},{"id":"89bff77d.b278a","type":"comment","z":"1b2a31e6.3fb326","name":"Alerte batterie HP","info":"","x":594,"y":3941,"wires":[]},{"id":"714e9018.2a184","type":"comment","z":"1b2a31e6.3fb326","name":"Notif batterie faible","info":"","x":1036,"y":3974,"wires":[]},{"id":"e7905b27.209378","type":"pushbullet","z":"1b2a31e6.3fb326","config":"ab14b9c2.70719","pushtype":"","title":"HP Batterie faible","chan":"","name":"HP Batterie faible","x":1037,"y":4019,"wires":[]},{"id":"4d95d97c.14f138","type":"delay","z":"1b2a31e6.3fb326","name":"One notification/day","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","rateUnits":"day","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":808,"y":4019,"wires":[["e7905b27.209378"]]},{"id":"f94811bc.6b2d48","type":"switch","z":"1b2a31e6.3fb326","name":"battHP > 15","property":"battHP","propertyType":"global","rules":[{"t":"gt","v":"15","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":582,"y":4014,"wires":[[],["4d95d97c.14f138","916879e1.2ec598"]]},{"id":"af0c34f2.b4fac","type":"comment","z":"1b2a31e6.3fb326","name":"Non","info":"","x":680,"y":4055,"wires":[]},{"id":"916879e1.2ec598","type":"debug","z":"1b2a31e6.3fb326","name":"","active":true,"console":"false","complete":"false","x":696,"y":4102,"wires":[]},{"id":"6537f517.5faf4c","type":"comment","z":"1b2a31e6.3fb326","name":"Alerte batterie CP","info":"","x":587,"y":4236,"wires":[]},{"id":"3bb68400.60d944","type":"comment","z":"1b2a31e6.3fb326","name":"Notif batterie faible","info":"","x":1030,"y":4252,"wires":[]},{"id":"615fc53d.c25204","type":"pushbullet","z":"1b2a31e6.3fb326","config":"ab14b9c2.70719","pushtype":"","title":"CP Batterie faible","chan":"","name":"CP Batterie faible","x":1031,"y":4297,"wires":[]},{"id":"24d05a75.f04da6","type":"delay","z":"1b2a31e6.3fb326","name":"One notification/day","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","rateUnits":"day","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":802,"y":4297,"wires":[["615fc53d.c25204"]]},{"id":"63415867.0f83e","type":"switch","z":"1b2a31e6.3fb326","name":"battCP > 15","property":"battCP","propertyType":"global","rules":[{"t":"gt","v":"15","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":576,"y":4292,"wires":[[],["24d05a75.f04da6","615df8dc.faf3e"]]},{"id":"19780dea.767fa2","type":"comment","z":"1b2a31e6.3fb326","name":"Non","info":"","x":674,"y":4333,"wires":[]},{"id":"615df8dc.faf3e","type":"debug","z":"1b2a31e6.3fb326","name":"","active":true,"console":"false","complete":"false","x":690,"y":4380,"wires":[]},{"id":"d1aae288.017ae8","type":"mqtt in","z":"3b02cdcb.5a6722","name":"Temperature DHT Billard","topic":"/DHT-Billard/DHT/Temperature","qos":"2","broker":"912de5b9.a94dc8","x":159,"y":4686,"wires":[["23efb3de.e5b32c","718e91.3501817"]]},{"id":"23efb3de.e5b32c","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":28,"width":"","height":"","name":"Température billard","label":"Température billard","format":"{{msg.payload}} °C","layout":"","x":461,"y":4685,"wires":[]},{"id":"98a45b5a.4aae7","type":"comment","z":"3b02cdcb.5a6722","name":"Billard","info":"\n","x":81,"y":4649,"wires":[]},{"id":"87dd659c.f8b768","type":"mqtt in","z":"3b02cdcb.5a6722","name":"Humidité DHT  Billard","topic":"/DHT-Billard/DHT/Humidity","qos":"2","broker":"912de5b9.a94dc8","x":136,"y":4763,"wires":[["718e91.3501817","39319508.dbe5fa"]]},{"id":"39319508.dbe5fa","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":29,"width":"","height":"","name":"Humidité billard","label":"Humidité billard","format":"{{msg.payload}} %","layout":"","x":450,"y":4762,"wires":[]},{"id":"f5e9181e.dcc578","type":"json","z":"3b02cdcb.5a6722","name":"","x":698,"y":4838,"wires":[[]]},{"id":"fc53abf1.60996","type":"http request","z":"3b02cdcb.5a6722","name":"Save Data","method":"POST","ret":"obj","url":"http://graylog:9200/my_sonde/sonde/{{{msg.payload}}}","tls":"","x":855,"y":4839,"wires":[["95d0c563.8bdc8"]]},{"id":"95d0c563.8bdc8","type":"debug","z":"3b02cdcb.5a6722","name":"","active":true,"console":"false","complete":"false","x":1023,"y":4838.5,"wires":[]},{"id":"4d82f5c6.005824","type":"delay","z":"3b02cdcb.5a6722","name":"","pauseType":"rate","timeout":"1","timeoutUnits":"hours","rate":"1","nbRateUnits":"10","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":535,"y":4840,"wires":[["fc53abf1.60996"]]},{"id":"718e91.3501817","type":"function","z":"3b02cdcb.5a6722","name":"T° + H° Billard ES write","func":"context.data=context.data || {};\nmsg.node = msg.topic.split('/')[3];\n\nswitch (msg.node) {\n    case \"Temperature\": \n      context.data.Temperature = msg.payload;\n      break;\n    case \"Humidity\":\n      context.data.Humidity = msg.payload;\n      break;\n}\n    \nif (context.data.Temperature != undefined  && context.data.Humidity != undefined) {\n        d=new Date();\n        madate=d.toJSON();\n        msg.payload = \"{\\\"date\\\":\\\"\" + madate + \"\\\", \\\"source\\\":\\\"T-Billard\\\", \\\"My-Temperature\\\":\" + context.data.Temperature + \", \\\"My-Humidity\\\":\" + context.data.Humidity + \"}\";\n    node.status({text:msg.payload});\n    //context.data=null;\n    return msg;\n}","outputs":1,"noerr":0,"x":322,"y":4842,"wires":[["4d82f5c6.005824","b179deeb.81d3e8"]]},{"id":"b179deeb.81d3e8","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"false","x":524,"y":4907,"wires":[]},{"id":"e06377ca.165398","type":"function","z":"4acfe546.fec69c","name":"qair ES write","func":"if ( parseInt(msg.payload) <= 4) {\n    msg.quality=\"Air correct\";\n}\nelse if ( parseInt(msg.payload) <= 7) {\n        msg.quality=\"Air pollué\";\n}\nelse {\n    msg.quality=\"Air très pollué\";\n}    \nd=new Date();\nmadate=d.toJSON()\nmyTemp = context.global.myTemperatureExt;\nmsg.payload = \"{\\\"date\\\":\\\"\" + madate + \"\\\", \\\"source\\\":\\\"air\\\", \\\"qualite-air\\\":\" + msg.payload + \", \\\"quality\\\":\\\"\" + msg.quality +\"\\\"}\";\n\nreturn msg;","outputs":1,"noerr":0,"x":272,"y":922,"wires":[["a7b45106.0c8618","90ce0350.ad52a8"]]},{"id":"90ce0350.ad52a8","type":"json","z":"4acfe546.fec69c","name":"","x":451,"y":922,"wires":[["5b172cdb.99cc34"]]},{"id":"a7b45106.0c8618","type":"debug","z":"4acfe546.fec69c","name":"","active":true,"console":"false","complete":"false","x":474,"y":969,"wires":[]},{"id":"5b172cdb.99cc34","type":"http request","z":"4acfe546.fec69c","name":"Save Data","method":"POST","ret":"obj","url":"http://graylog:9200/my_sonde/sonde/{{{msg.payload}}}","tls":"","x":609,"y":922,"wires":[["35f17204.06cbfe"]]},{"id":"35f17204.06cbfe","type":"debug","z":"4acfe546.fec69c","name":"","active":true,"console":"false","complete":"false","x":777,"y":920.5,"wires":[]},{"id":"bdf267b.22d5018","type":"debug","z":"1b2a31e6.3fb326","name":"","active":true,"console":"false","complete":"false","x":290,"y":1820,"wires":[]},{"id":"33f94080.63097","type":"delay","z":"8fda587a.42f658","name":"Delay MY 8s","pauseType":"delay","timeout":"8","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":876,"y":3446,"wires":[["5f3e38fa.ff1a7"]]},{"id":"5f3e38fa.ff1a7","type":"function","z":"8fda587a.42f658","name":"Volet-stop","func":"msg.payload = \"stop\"\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":1049,"y":3446,"wires":[["6b00f0da.cd72a"]]},{"id":"6b00f0da.cd72a","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/salon/ouest","topic":"/Volet/salon/ouest","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1073,"y":3372,"wires":[]},{"id":"85795e6d.617278","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":854,"y":3372,"wires":[["6b00f0da.cd72a","6daf4465.0b7ca4"]]},{"id":"ad8f6f80.4274e","type":"function","z":"8fda587a.42f658","name":"Répéteur","func":"for (i = 0; i < 1; i++) \n{\n    node.send(msg);\n}","outputs":1,"noerr":0,"x":676,"y":3371,"wires":[["85795e6d.617278"]]},{"id":"6daf4465.0b7ca4","type":"switch","z":"8fda587a.42f658","name":"My-Hivers","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"down","vt":"str"}],"checkall":"true","outputs":1,"x":674,"y":3445,"wires":[["33f94080.63097"]]},{"id":"dae9b50c.de9778","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/salon/ouest","topic":"/Volet/salon/ouest","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1068,"y":3313,"wires":[]},{"id":"ecc7a609.332b8","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":852,"y":3313,"wires":[["dae9b50c.de9778"]]},{"id":"ade7dc4a.1b1d58","type":"comment","z":"3b02cdcb.5a6722","name":"----------------------------------- DHT ----------------------------------------","info":"\n","x":268,"y":4410,"wires":[]},{"id":"e65ba211.c53d","type":"comment","z":"3b02cdcb.5a6722","name":"----------------------------------- RFX Bangood TH13 ----------------------------------------","info":"\n","x":285,"y":143,"wires":[]},{"id":"14f5788f.6c7fb7","type":"comment","z":"3b02cdcb.5a6722","name":"----------------------------------- RFX F007TH TH9 ----------------------------------------","info":"\n","x":289,"y":2112,"wires":[]},{"id":"853ddced.be9e78","type":"rfx-sensor","z":"3b02cdcb.5a6722","name":"Cuisine TH9/0xFF01","port":"25338ec8.545a42","topicSource":"single","topic":"TH9/0xFF01","x":128,"y":2280,"wires":[["a791d19c.3b3b58","2b64f93b.3d5f46","615d865b.bf7868","216df142.21925e","820a09fb.ff8698"]]},{"id":"a791d19c.3b3b58","type":"function","z":"3b02cdcb.5a6722","name":"T° cuisine","func":"msg.payload = msg.payload.temperature.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":327,"y":2229,"wires":[["76ccb9d0.dbfdc8","7638dfe2.4673"]]},{"id":"76ccb9d0.dbfdc8","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":10,"width":"0","height":"0","name":"Température cuisine","label":"Température cuisine","format":"{{msg.payload}}°C","layout":"","x":575,"y":2251,"wires":[]},{"id":"2b64f93b.3d5f46","type":"function","z":"3b02cdcb.5a6722","name":"H° cuisine","func":"msg.payload = msg.payload.humidity.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":329,"y":2347,"wires":[["7f6f53ac.ee2174","b9f00c33.f29d18","c7109111.977b08"]]},{"id":"7f6f53ac.ee2174","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":11,"width":"0","height":"0","name":"Humidité cuisine","label":"Humidité cuisine","format":"{{msg.payload}} %","layout":"","x":555,"y":2351,"wires":[]},{"id":"b9f00c33.f29d18","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":12,"width":"0","height":"0","name":"--","label":"","format":"","layout":"","x":527,"y":2393,"wires":[]},{"id":"7638dfe2.4673","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-Cuisine/RFX/Temperature","topic":"/T-Cuisine/RFX/Temperature","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":594,"y":2204,"wires":[]},{"id":"c7109111.977b08","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-Cuisine/RFX/Humidity","topic":"/T-Cuisine/RFX/Humidity","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":584,"y":2302,"wires":[]},{"id":"615d865b.bf7868","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"false","x":343,"y":2182,"wires":[]},{"id":"55445f06.b836d","type":"comment","z":"3b02cdcb.5a6722","name":"Cuisine","info":"\n","x":71,"y":2242,"wires":[]},{"id":"216df142.21925e","type":"function","z":"3b02cdcb.5a6722","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":315,"y":2440,"wires":[["4905a4cd.63b854"]]},{"id":"4905a4cd.63b854","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-Cuisine/RFX/lastupdate","topic":"/T-Cuisine/RFX/lastupdate","qos":"2","retain":"true","broker":"912de5b9.a94dc8","x":585,"y":2441,"wires":[]},{"id":"4ac0f903.0d227","type":"rfx-sensor","z":"3b02cdcb.5a6722","name":"BureauTH9/0x2702","port":"25338ec8.545a42","topicSource":"single","topic":"TH9/0x2702","x":125,"y":2643,"wires":[["182cd4fc.c6ffb3","bbca634e.258aa","a0b358f3.ad466","9c64a5a6.6327e8"]]},{"id":"182cd4fc.c6ffb3","type":"function","z":"3b02cdcb.5a6722","name":"T° bureau","func":"msg.payload = msg.payload.temperature.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":334,"y":2592,"wires":[["50f7100c.7afaa8","39c962de.271b46"]]},{"id":"50f7100c.7afaa8","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":13,"width":"0","height":"0","name":"Température bureau","label":"Température bureau","format":"{{msg.payload}}°C","layout":"","x":572,"y":2614,"wires":[]},{"id":"bbca634e.258aa","type":"function","z":"3b02cdcb.5a6722","name":"H° bureau","func":"msg.payload = msg.payload.humidity.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":336,"y":2710,"wires":[["7129a84e.1e19f8","f0b28057.efc188","6aa9cf1e.838818"]]},{"id":"7129a84e.1e19f8","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":14,"width":"0","height":"0","name":"Humidité bureau","label":"Humidité bureau","format":"{{msg.payload}} %","layout":"","x":552,"y":2714,"wires":[]},{"id":"f0b28057.efc188","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":15,"width":"0","height":"0","name":"--","label":"","format":"","layout":"","x":524,"y":2756,"wires":[]},{"id":"39c962de.271b46","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-Bureau/RFX/Temperature","topic":"/T-Bureau/RFX/Temperature","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":591,"y":2567,"wires":[]},{"id":"6aa9cf1e.838818","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-Bureau/RFX/Humidity","topic":"/T-Bureau/RFX/Humidity","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":581,"y":2665,"wires":[]},{"id":"a0b358f3.ad466","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"false","x":340,"y":2545,"wires":[]},{"id":"c829540c.fd47e","type":"comment","z":"3b02cdcb.5a6722","name":"Bureau","info":"\n","x":68,"y":2605,"wires":[]},{"id":"9c64a5a6.6327e8","type":"function","z":"3b02cdcb.5a6722","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":312,"y":2803,"wires":[["768178f2.e68dd8"]]},{"id":"768178f2.e68dd8","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-Couloir/RFX/lastupdate","topic":"/T-Couloir/RFX/lastupdate","qos":"2","retain":"true","broker":"912de5b9.a94dc8","x":572,"y":2804,"wires":[]},{"id":"2e78ab62.ffea34","type":"rfx-sensor","z":"3b02cdcb.5a6722","name":"Ch Parents TH9/0x8605","port":"25338ec8.545a42","topicSource":"single","topic":"TH9/0x8605","x":136,"y":3031,"wires":[["5e8906f.2873178","dcd179b1.84b5d","6e09b17e.9578a","d70fa655.f1c7f"]]},{"id":"5e8906f.2873178","type":"function","z":"3b02cdcb.5a6722","name":"T° Chambre Parents","func":"msg.payload = msg.payload.temperature.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":355,"y":2980,"wires":[["2a5cd5cd.1ef43a","ace29f3c.f4cf4"]]},{"id":"2a5cd5cd.1ef43a","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":16,"width":"0","height":"0","name":"Température Ch Parents","label":"Température Ch Parents","format":"{{msg.payload}}°C","layout":"","x":608,"y":3002,"wires":[]},{"id":"dcd179b1.84b5d","type":"function","z":"3b02cdcb.5a6722","name":"H° Chambre Parents","func":"msg.payload = msg.payload.humidity.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":357,"y":3098,"wires":[["ca216540.c2e2d8","16fb6850.5cd9","3a939814.6de4d"]]},{"id":"ca216540.c2e2d8","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":17,"width":"0","height":"0","name":"Humidité Ch Parents","label":"Humidité Ch Parents","format":"{{msg.payload}} %","layout":"","x":598,"y":3102,"wires":[]},{"id":"16fb6850.5cd9","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":18,"width":"0","height":"0","name":"--","label":"","format":"","layout":"","x":550,"y":3144,"wires":[]},{"id":"ace29f3c.f4cf4","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-chambreParents/RFX/Temperature","topic":"/T-chambreParents/RFX/Temperature","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":647,"y":2955,"wires":[]},{"id":"3a939814.6de4d","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-chambreParents/RFX/Humidity","topic":"/T-chambreParents/RFX/Humidity","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":637,"y":3053,"wires":[]},{"id":"6e09b17e.9578a","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"false","x":331,"y":2933,"wires":[]},{"id":"76372fe.ba3215","type":"comment","z":"3b02cdcb.5a6722","name":"Chambre Parents","info":"\n","x":99,"y":2993,"wires":[]},{"id":"d70fa655.f1c7f","type":"function","z":"3b02cdcb.5a6722","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":303,"y":3191,"wires":[["4d9d2fb0.6dafa8"]]},{"id":"4d9d2fb0.6dafa8","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-chambreParents/RFX/lastupdate","topic":"/T-chambreParents/RFX/lastupdate","qos":"2","retain":"true","broker":"912de5b9.a94dc8","x":628,"y":3192,"wires":[]},{"id":"23a6b346.eccf2c","type":"rfx-sensor","z":"3b02cdcb.5a6722","name":"Ch Anaïs TH9/0x7904","port":"25338ec8.545a42","topicSource":"single","topic":"TH9/0x7904","x":122,"y":3389,"wires":[["f58eecff.09e8f","7fb497f3.9ff2d","6fda6da0.6028b4","46456535.62e724"]]},{"id":"f58eecff.09e8f","type":"function","z":"3b02cdcb.5a6722","name":"T° Chambre Anaïs","func":"msg.payload = msg.payload.temperature.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":341,"y":3338,"wires":[["ef01f8f5.d81f","f2d6dfba.9675e8"]]},{"id":"ef01f8f5.d81f","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":19,"width":"0","height":"0","name":"Température Ch Anaïs","label":"Température Ch Anaïs","format":"{{msg.payload}}°C","layout":"","x":594,"y":3360,"wires":[]},{"id":"7fb497f3.9ff2d","type":"function","z":"3b02cdcb.5a6722","name":"H° Chambre Anaïs","func":"msg.payload = msg.payload.humidity.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":343,"y":3456,"wires":[["19ada30b.673c9d","8fa7d640.54953","458d28c9.fe4ea8"]]},{"id":"19ada30b.673c9d","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":20,"width":"0","height":"0","name":"Humidité Ch Anaïs","label":"Humidité Ch Anaïs","format":"{{msg.payload}} %","layout":"","x":584,"y":3460,"wires":[]},{"id":"8fa7d640.54953","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":21,"width":"0","height":"0","name":"--","label":"","format":"","layout":"","x":546,"y":3502,"wires":[]},{"id":"f2d6dfba.9675e8","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-chambreAnais/RFX/Temperature","topic":"/T-chambreAnais/RFX/Temperature","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":633,"y":3313,"wires":[]},{"id":"458d28c9.fe4ea8","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-chambreAnais/RFX/Humidity","topic":"/T-chambreAnais/RFX/Humidity","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":623,"y":3411,"wires":[]},{"id":"6fda6da0.6028b4","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"false","x":327,"y":3291,"wires":[]},{"id":"8337d454.9bb6f","type":"comment","z":"3b02cdcb.5a6722","name":"Chambre Anaïs","info":"\n","x":85,"y":3351,"wires":[]},{"id":"46456535.62e724","type":"function","z":"3b02cdcb.5a6722","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":299,"y":3549,"wires":[["182ed159.fcc7bf"]]},{"id":"182ed159.fcc7bf","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-chambreAnais/RFX/lastupdate","topic":"/T-chambreAnais/RFX/lastupdate","qos":"2","retain":"true","broker":"912de5b9.a94dc8","x":624,"y":3550,"wires":[]},{"id":"65a27bf9.867f2c","type":"rfx-sensor","z":"3b02cdcb.5a6722","name":"Ch Sarah TH9/0x6F03","port":"25338ec8.545a42","topicSource":"single","topic":"TH9/0x6F03","x":123,"y":3753,"wires":[["d1ec45ea.0aade","8698f3e3.2d29d","7f073446.773eec","1cc31f32.85fe59"]]},{"id":"d1ec45ea.0aade","type":"function","z":"3b02cdcb.5a6722","name":"T° Chambre Sarah","func":"msg.payload = msg.payload.temperature.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":342,"y":3702,"wires":[["6fa79ca6.234df4","3902336c.4f1f94"]]},{"id":"6fa79ca6.234df4","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":22,"width":"0","height":"0","name":"Température Ch Sarah","label":"Température Ch Sarah","format":"{{msg.payload}}°C","layout":"","x":605,"y":3724,"wires":[]},{"id":"8698f3e3.2d29d","type":"function","z":"3b02cdcb.5a6722","name":"H° Chambre Sarah","func":"msg.payload = msg.payload.humidity.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":344,"y":3820,"wires":[["e299e0a4.213a78","cb315918.d183a8","efe122a8.61d6a8"]]},{"id":"e299e0a4.213a78","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":23,"width":"0","height":"0","name":"Humidité Ch Sarah","label":"Humidité Ch Sarah","format":"{{msg.payload}} %","layout":"","x":585,"y":3824,"wires":[]},{"id":"cb315918.d183a8","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":24,"width":"0","height":"0","name":"--","label":"","format":"","layout":"","x":547,"y":3866,"wires":[]},{"id":"3902336c.4f1f94","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-chambreSarah/RFX/Temperature","topic":"/T-chambreSarah/RFX/Temperature","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":644,"y":3677,"wires":[]},{"id":"efe122a8.61d6a8","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-chambreSarah/RFX/Humidity","topic":"/T-chambreSarah/RFX/Humidity","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":624,"y":3775,"wires":[]},{"id":"7f073446.773eec","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"false","x":328,"y":3655,"wires":[]},{"id":"3d90cdef.2ca3a2","type":"comment","z":"3b02cdcb.5a6722","name":"Chambre Sarah","info":"\n","x":86,"y":3715,"wires":[]},{"id":"1cc31f32.85fe59","type":"function","z":"3b02cdcb.5a6722","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":300,"y":3913,"wires":[["d4d68154.848fa"]]},{"id":"d4d68154.848fa","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-chambreSarah/RFX/lastupdate","topic":"/T-chambreSarah/RFX/lastupdate","qos":"2","retain":"true","broker":"912de5b9.a94dc8","x":625,"y":3914,"wires":[]},{"id":"b1097d9d.4ca3e","type":"rfx-sensor","z":"3b02cdcb.5a6722","name":"Salle de bain TH9/0x3506","port":"25338ec8.545a42","topicSource":"single","topic":"TH9/0x3506","x":132,"y":4126,"wires":[["8435f7f1.7e616","83691f3f.8dbf48","2ea8e7c2.a351c8","15c4d694.0f5791"]]},{"id":"8435f7f1.7e616","type":"function","z":"3b02cdcb.5a6722","name":"T°Salle de bain","func":"msg.payload = msg.payload.temperature.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":331,"y":4075,"wires":[["fd7b0fdd.b96128","f53ffdb2.647d3"]]},{"id":"fd7b0fdd.b96128","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":25,"width":"0","height":"0","name":"Température Salle de bain","label":"Température Salle de bain","format":"{{msg.payload}}°C","layout":"","x":614,"y":4097,"wires":[]},{"id":"83691f3f.8dbf48","type":"function","z":"3b02cdcb.5a6722","name":"H° Salle de bain","func":"msg.payload = msg.payload.humidity.value\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":333,"y":4193,"wires":[["947d0c0f.5c9598","7015ceec.1acbc","95d37d7.d761d8"]]},{"id":"947d0c0f.5c9598","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":26,"width":"0","height":"0","name":"Humidité Salle de bain","label":"Humidité Salle de bain","format":"{{msg.payload}} %","layout":"","x":594,"y":4197,"wires":[]},{"id":"7015ceec.1acbc","type":"ui_text","z":"3b02cdcb.5a6722","group":"b7857374.8e887","order":27,"width":"0","height":"0","name":"--","label":"","format":"","layout":"","x":546,"y":4239,"wires":[]},{"id":"f53ffdb2.647d3","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-salledebain/RFX/Temperature","topic":"/T-salledebain/RFX/Temperature","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":633,"y":4050,"wires":[]},{"id":"95d37d7.d761d8","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-salledebain/RFX/Humidity","topic":"/T-salledebain/RFX/Humidity","qos":"2","retain":"","broker":"912de5b9.a94dc8","x":613,"y":4148,"wires":[]},{"id":"2ea8e7c2.a351c8","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"false","x":327,"y":4028,"wires":[]},{"id":"e3c40f06.0b16b","type":"comment","z":"3b02cdcb.5a6722","name":"Salle de bain","info":"\n","x":75,"y":4088,"wires":[]},{"id":"15c4d694.0f5791","type":"function","z":"3b02cdcb.5a6722","name":"Date","func":"MaDate = new Date();\ndateString = MaDate.toString();\ntimeString = dateString.substring( 16 , 21 );\ndayString = dateString.substring( 8 , 11 );\nmonthString = dateString.substring( 4 , 8 );\n//msg.payload = timeString\nmsg.payload = dayString + monthString + timeString\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":299,"y":4286,"wires":[["a912dfac.0dd2e8"]]},{"id":"a912dfac.0dd2e8","type":"mqtt out","z":"3b02cdcb.5a6722","name":"/T-salledebain/RFX/lastupdate","topic":"/T-salledebain/RFX/lastupdate","qos":"2","retain":"true","broker":"912de5b9.a94dc8","x":614,"y":4287,"wires":[]},{"id":"b8c242ea.cdcd8","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/bureau/ouest","topic":"/Volet/bureau/ouest","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1060,"y":3042,"wires":[]},{"id":"5d1effcd.ea0e4","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":852,"y":3041,"wires":[["b8c242ea.cdcd8"]]},{"id":"1bc79ddb.a27f2a","type":"delay","z":"8fda587a.42f658","name":"Delay MY 8s","pauseType":"delay","timeout":"8","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":869,"y":3244,"wires":[["865c15a9.b41a78"]]},{"id":"865c15a9.b41a78","type":"function","z":"8fda587a.42f658","name":"Volet-stop","func":"msg.payload = \"stop\"\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":1041,"y":3244,"wires":[["8f6dca2a.63afe8"]]},{"id":"8f6dca2a.63afe8","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/salon/sud","topic":"/Volet/salon/sud","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1051,"y":3171,"wires":[]},{"id":"535b39a9.e67228","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":852,"y":3170,"wires":[["8f6dca2a.63afe8","2e02fa29.9cc46e"]]},{"id":"9b4a0753.62c8d","type":"function","z":"8fda587a.42f658","name":"Répéteur","func":"for (i = 0; i < 1; i++) \n{\n    node.send(msg);\n}","outputs":1,"noerr":0,"x":671,"y":3171,"wires":[["535b39a9.e67228"]]},{"id":"2e02fa29.9cc46e","type":"switch","z":"8fda587a.42f658","name":"My-Hivers","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"down","vt":"str"}],"checkall":"true","outputs":1,"x":673,"y":3243,"wires":[["1bc79ddb.a27f2a"]]},{"id":"bb54c697.d57168","type":"mqtt out","z":"8fda587a.42f658","name":"/Volet/salon/sud","topic":"/Volet/salon/sud","qos":"","retain":"","broker":"912de5b9.a94dc8","x":1051,"y":3110,"wires":[]},{"id":"96fca2fa.60c2f","type":"delay","z":"8fda587a.42f658","name":"R 1-5","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":854,"y":3109,"wires":[["bb54c697.d57168"]]},{"id":"d9d3abb6.d5c6e8","type":"comment","z":"8fda587a.42f658","name":"Automatisme : week-end non utilisé","info":"","x":145,"y":3543,"wires":[]},{"id":"32b20c0a.623e9c","type":"debug","z":"3b02cdcb.5a6722","name":"","active":false,"console":"false","complete":"status","x":567,"y":97,"wires":[]},{"id":"5bab549d.3668ac","type":"function","z":"3b02cdcb.5a6722","name":"Batterie","func":"msg.payload = msg.status.battery\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":316,"y":516,"wires":[["2cde81c8.785c1e"]]},{"id":"cf620cd8.c04d98","type":"comment","z":"3b02cdcb.5a6722","name":"Notif batterie faible","info":"","x":1071,"y":484,"wires":[]},{"id":"a8e925a4.1126c8","type":"pushbullet","z":"3b02cdcb.5a6722","config":"ab14b9c2.70719","pushtype":"","title":"Sonde T° véranda Batterie faible","chan":"","name":"Sonde T° véranda Batterie faible","x":1088,"y":520,"wires":[]},{"id":"27dcda21.316bee","type":"delay","z":"3b02cdcb.5a6722","name":"One notification/day","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","rateUnits":"day","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":813,"y":522,"wires":[["a8e925a4.1126c8"]]},{"id":"2cde81c8.785c1e","type":"switch","z":"3b02cdcb.5a6722","name":"Batterie > 2","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"2","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":522,"y":516,"wires":[[],["27dcda21.316bee"]]},{"id":"1619e7cb.fefc","type":"comment","z":"3b02cdcb.5a6722","name":"Non","info":"","x":650,"y":541,"wires":[]},{"id":"747f8381.147224","type":"function","z":"3b02cdcb.5a6722","name":"Batterie","func":"msg.payload = msg.status.battery\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":306,"y":965,"wires":[["67bab2ff.a3bd1c"]]},{"id":"67bab2ff.a3bd1c","type":"switch","z":"3b02cdcb.5a6722","name":"Batterie > 2","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"2","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":512,"y":965,"wires":[[],["ac6a1ba.7b18e68"]]},{"id":"b19841de.bda66","type":"comment","z":"3b02cdcb.5a6722","name":"Non","info":"","x":639,"y":995,"wires":[]},{"id":"ac6a1ba.7b18e68","type":"delay","z":"3b02cdcb.5a6722","name":"One notification/day","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","rateUnits":"day","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":802,"y":971,"wires":[["7e96b783.d9c4"]]},{"id":"7e96b783.d9c4","type":"pushbullet","z":"3b02cdcb.5a6722","config":"ab14b9c2.70719","pushtype":"","title":"Sonde T° salon Batterie faible","chan":"","name":"Sonde T° salon Batterie faible","x":1062,"y":971,"wires":[]},{"id":"905e986f.f4eeb8","type":"comment","z":"3b02cdcb.5a6722","name":"Notif batterie faible","info":"","x":1066,"y":935,"wires":[]},{"id":"117936b0.9f9839","type":"function","z":"3b02cdcb.5a6722","name":"Batterie","func":"msg.payload = msg.status.battery\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":286,"y":1464,"wires":[["31dbcdd0.c60362"]]},{"id":"31dbcdd0.c60362","type":"switch","z":"3b02cdcb.5a6722","name":"Batterie > 2","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"2","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":492,"y":1464,"wires":[[],["62eb2d51.74a06c"]]},{"id":"8b3ec2bb.89b6e","type":"comment","z":"3b02cdcb.5a6722","name":"Non","info":"","x":619,"y":1494,"wires":[]},{"id":"62eb2d51.74a06c","type":"delay","z":"3b02cdcb.5a6722","name":"One notification/day","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","rateUnits":"day","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":782,"y":1470,"wires":[["3d6ecb6a.5d872c"]]},{"id":"3d6ecb6a.5d872c","type":"pushbullet","z":"3b02cdcb.5a6722","config":"ab14b9c2.70719","pushtype":"","title":"Sonde T° Ext Batterie faible","chan":"","name":"Sonde T° Ext Batterie faible","x":1032,"y":1470,"wires":[]},{"id":"b3b11978.a0ecc8","type":"comment","z":"3b02cdcb.5a6722","name":"Notif batterie faible","info":"","x":1046,"y":1434,"wires":[]},{"id":"820a09fb.ff8698","type":"function","z":"3b02cdcb.5a6722","name":"Batterie","func":"msg.payload = msg.status.battery\n    node.status({text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":571,"y":2499,"wires":[["ab14ea35.68d54"]]},{"id":"ab14ea35.68d54","type":"switch","z":"3b02cdcb.5a6722","name":"Batterie > 2","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"2","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":777,"y":2499,"wires":[[],["a205b2ab.b6be18"]]},{"id":"356f362a.332922","type":"comment","z":"3b02cdcb.5a6722","name":"Non","info":"","x":904,"y":2529,"wires":[]},{"id":"a205b2ab.b6be18","type":"delay","z":"3b02cdcb.5a6722","name":"One notification/day","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","rateUnits":"day","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1067,"y":2505,"wires":[["8e2736f8.121bc8"]]},{"id":"8e2736f8.121bc8","type":"pushbullet","z":"3b02cdcb.5a6722","config":"ab14b9c2.70719","pushtype":"","title":"Sonde T° cuisine Batterie faible","chan":"","name":"Sonde T° cuisine Batterie faible","x":1327,"y":2505,"wires":[]},{"id":"d209b9e7.c42a18","type":"comment","z":"3b02cdcb.5a6722","name":"Notif batterie faible","info":"","x":1331,"y":2469,"wires":[]}]